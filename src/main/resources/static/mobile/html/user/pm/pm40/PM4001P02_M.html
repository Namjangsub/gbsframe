<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/static/fontawesome/css/all.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5grid.css" />
    <link rel="stylesheet" href="/static/css/ax5/ax5mask.css" />
    <link rel="stylesheet" href="/static/css/ax5/ax5modal.css" />
    <link rel="stylesheet" href="/static/css/gnb.css" />
    <link rel="stylesheet" href="/static/css/main.css" />
    <link rel="stylesheet" href="/static/css/sub.css" />
    <link rel="stylesheet" href="/static/css/common.css" />
	<link rel="stylesheet" href="/static/css/mobile.css" />

    <script src="/static/js/jquery-latest.min.js"></script>
    <script src="/static/js/jquery.serializeObject.js"></script>
    <script src="/static/bootstrap/js/bootstrap.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
    <script src="/static/js/moment/moment-with-locales.js"></script>
    <script src="/static/js/ax5/ax5core.min.js"></script>
    <script src="/static/js/ax5/ax5grid.min.js"></script>
    <script src="/static/js/ax5/ax5mask.min.js"></script>
    <script src="/static/js/ax5/ax5modal.min.js"></script>
    <script src="/static/js/global.js"></script>
    <style>
        tr {
          height: 26px;
        }
		#main_area{
		    padding: 0px 0px;
		    overflow: auto;
	    }
    </style>
</head>

<body>
    <div id="head_area" class="off" >
        <div class="left_btn" onclick="history.back(-1)">
              <a class="back_btn"></a>
        </div>
        <h1 class="logo">
              <img src="/static/img/Logo_gunyangitt.gif" alt="건양ITT" />
        </h1>
    </div>



<div id="main_area">
    <div class="popup_area">
        <div class="tit_contents">
            <h4 class="tit">작업일보 고찰 등록-팀</h4>
        </div>
			<input type="file" id="notiFile" style="display:none" multiple="multiple" onchange="setNotiFile(this);"/>
	<form id="popForm" onSubmit="return false;">
			<input type="hidden" id="fileTrgtKey"  	name="fileTrgtKey">
			<input type="hidden" id="pgmId"     	name="pgmId" value="PM4001M01_M">
			 <input type="hidden"  id="ordrgId" name="ordrgId" >
			 <input type="hidden"  id="ordrgNm" name="ordrgNm" >
			<input type="hidden" id="deptId"     	name="deptId">
			<input type="hidden" id="deptCd"     	name="deptCd">
			<input type="hidden" id="ordCoCd"     	name="ordCoCd" msg="오더도는 salesCode용 회사코드">
			<input type="hidden" id="coCd" name="coCd" required msg="회사">
			<input type="hidden" id="writeYm"   name="writeYm"> 
			<input type="hidden" id="workNo"   name="workNo"> 
            <div class="form-group popup_table" style="width: 100%;">
                <table>

                    <colgroup>
                    <col width="28%">
                    <col width="72%">
                    </colgroup>

                    <tr>
                    <th id="workYm" colspan="1">
                    
                    </th>
                    <td id="create_td">
                    <div class="date_input">
                                <input id="cWorkYm" name="cWorkYm" class="input_calendar" autocomplete="off" onkeyup="dateMask(this);">
                     </div>
              		</td>      
                    
                    </tr>
                    <tr>
                        <th>잘된점</th>
                        <td>
                            <textarea rows="3" id="workGoodTxt" name="workGoodTxt" class="form-control"  msg="잘된점"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <th>아쉬운점</th>
                        <td>
                            <textarea rows="3" id="workBadTxt" name="workBadTxt" class="form-control"  msg="아쉬운점"></textarea>
                        </td>
                    </tr>
                     <tr>
                        <th>개선할점</th>
                        <td>
                            <textarea rows="3" id="workNeedTxt" name="workNeedTxt" class="form-control"  msg="개선할점"></textarea>
                        </td>
                    </tr> <tr>
                        <th>건의사항</th>
                        <td>
                            <textarea rows="3" id="workProposalTxt" name="workProposalTxt" class="form-control"  msg="건의사항"></textarea>
                        </td>
                    </tr> <tr>
                        <th>비고</th>
                        <td>
                            <textarea rows="3" id="workRmk" name="workRmk" class="form-control"  msg="비고"></textarea>
                        </td>
                    </tr>
                </table>
            </div>
           
        </form>
	
    </div>
    
    <div data-ax5grid="first-grid" data-ax5grid-config="{}" style="height: 700px; width: 100%; font-size:16px;"></div>
    <!-- table>
    <td colspan= 5>
	          공유대상자
	          <div class="popup_table" id="approval_trgt">
	              <table style="border: 0px;">
	                  <tr style="height:30px;">
	                    <td style="text-align: LEFT; border-right: 0px;;font-size:13px;font-weight:bold;">※ 공유 및 결재</td>
	                    <td colspan="3">
	                       <div class="add_btn_small pdl10" id="plus-minus">
	                         <a onclick="insertShareUserModal();" style="height: 30px; line-height: 28px;" authchk>+</a>
	                         <a onclick="deleteShareUser();" style="height: 30px; line-height: 28px;" authchk>-</a>
	                     </div>
	                    </td>
	                  </tr>
	                 <tr>
	                    <td colspan="4">
	                     <div>
	                   		<div class="ax5_grid" data-ax5grid="third-grid-modal" data-ax5grid-config="{}" style="height: 150px; width: 100%;" ></div>
	                  	 </div>
	                 	</td>
	              	 </tr>
	              </table>
	          </div>
          </td>
    </table> -->
    
    
    <!-- 하단 버튼 -->
    <div class ="mobile_mid_btn">
        <button type="button" style="height: 35px;  width: 90px;"id="actionBtn" authChk>등록</button>
        <button type="button" class="close_btn" style="height: 35px;  width: 90px;" onclick="window.history.back();">닫기</button>
    </div>
</div>



<script type="text/javascript">
	var actionType = null;
	var fileTrgtKey = null;
	var userName = [];
	var paramObj = null;
	var fileParam = null;
    var windowWidth = $(window).width();
    var windowHeight = $(window).height();

    // 카톡 정상알림 카운터 변수
    var kakaoCnt = 0;
    var kakaoErr = [];

	// 결재&공유 
	/* var gridViewPop = {
		      initView : function() {
		    	  
		    	  
		           this.target = new ax5.ui.grid();
		           this.target.setConfig({
		               showRowSelector: true,
		               multipleSelect: false,
		               sortable: false,
		                target: $('[data-ax5grid="third-grid-modal"]'),
		                header: {
		                   align: "center",
		                   selector: true
		                },
		                body: {
		                    onClick: function () {
		                        this.self.select(this.dindex);
		                    },
		                    onDBLClick: function () {
		                    },
		               mergeCells : ["gb"],
		                },
		            page : {
		               navigationItemCount : 10,
		               height : 30,
		               display : true,
		               firstIcon : '<i class="fa fa-step-backward" aria-hidden="true"></i>',
		               prevIcon : '<i class="fa fa-caret-left" aria-hidden="true"></i>',
		               nextIcon : '<i class="fa fa-caret-right" aria-hidden="true"></i>',
		               lastIcon : '<i class="fa fa-step-forward" aria-hidden="true"></i>',
		               onChange : function() {
		                  gridView2.setData(this.page.selectPage);
		               }
		            },
		             columns : [
		                   {key: "gb",               label: "구분",         align: "center",   width: 40},
		                    {key: "sanctnSn",          label: "순번",       align: "center",   width: 50},
		                    {key: "coCd",               label: "coCd",      align: "center",   width: 50, hidden: true},
		                       {key: "wbsPlancoCdNm",      label: "회사명",      align: "center",   width: 130, hidden: true},
		                       //{key: "wbsSharngUserId",   label: "ID",         align: "center",   width: 130, hidden: false},
		                       {key: "usrNm",            label: "ID",         align: "center",   width: 130, hidden: true},
		                       {key: "empNo",            label: "사원번호",    align: "center",   width: 130, hidden: true},
		                       {key: "name",             label: "성명",         align: "center",   width: 80},
		                       {key: "jik",                label: "직위",         align: "center",   width: 60},
		                       {key: "creatDttm",         label: "요청일자",    align: "center",   width: 90},
		                       {key: "todoCfDt",            label: "확인일자",      align: "center",   width: 130},
		                       {key: "todoCfOpn",         label: "확인의견",    align: "left",     width: 200},
//		                        {key: "telNo",            label: "H.P",      align: "center",   width: 130},
		                       {key: "todoKey",            label: "todoKey",      align: "center",   width: 130, hidden: true},
		                       {key: "sanctnSttus",         label: "sanctnSttus",      align: "center",   width: 130, hidden: true},
		                       {key: "todoId",            label: "todoId",      align: "center",   width: 130, hidden: true},
		                       {key: "flag",               label: "flag",      align: "center",   width: 130, hidden: true}
		                     ]
		               });
		                 return this;
		              },
						
		              setData : function(_pageNo) {
		                 var targetObj = this.target;
		                 var formData = {
		                         "fileTrgtKey" : "",
		                         "reqNo" : $("#workNo").val(),
		                         "pageNo" : _pageNo + 1
		                  }

		                  postAjax("/user/pm/pm40/selectSignResUserlst", formData, null, function(data){
		                     var list = data.result;
		                     //targetObj.setData({
		                     gridViewPop.target.setData({
		                          list : list,
		                          page : {
		                                   totalElements : list.length
		                      }
		                       });
		                     gridResize1()
		                     $.each(list, function(idx, elem){
		                           if(elem.sanctnSn == 1 && elem.gb == "결재") {
		                              $('#reportRegBtn').show();
		                           }
		                     });
		                    });
		                },

		              setData2 : function(_list) {
		                 this.target.setData({
		                          list : _list,
		                          page : {
		                                   totalElements :  _list.length,
		                      }
		                       });
		                 gridResize1();
		                }
		                ,
		              setData3 : function(_pageNo) {
		                 var targetObj = this.target;
		                 var paramObj = { "userId": $("#ordrgId").val()
		                             , "appDiv": 'APPDIV02'
		                 };
		                  postAjax("/user/wb/wb20/selectSignResUserlstInit", paramObj, null, function(data){
		                  var list = data.result;
		                     targetObj.setData({
		                          list : list,
		                          page : { totalElements : list.length }
		                       });
		                    });
		                  gridResize1();
		                }
		     } */
	
	var gridView = {
		    initView : function() {
		            this.target = new ax5.ui.grid();
		            this.target.setConfig({
		                showRowSelector: false,
		                multipleSelect: false,
		                sortable: false,
		                target: $('[data-ax5grid="first-grid"]'),
		                header: {
		                    align: "center",
		                    selector: false,
		                    columnHeight: 23,
		                },
		                body: {
		                    columnHeight:23,
		                    mergeCells : ["workRptLNm","workRptMNm","workRptSNm"],
		                     onClick: function () {
		                        this.self.select(this.dindex);                  
		                    },
		                    onDBLClick: function () {
		                       // insertDailyWorkModal("U");      
		                    },
				            grouping: {
				            	by: ["workRptMNm" ],
			                    columns: [
			                    	{
			                            label: function () {
			                                return this.groupBy.labels.join(", ") + " 소계";
			                            }, colspan: 2, align: "center"
			                        },
			                        {key: "totalSum", collector: "sum", formatter: "money", align: "right"},
			                        {key: "totPct", collector: "sum", formatter: "money", align: "right"},
			                        {key: "user1", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user2", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user3", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user4", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user5", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user6", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user7", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user8", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user9", 		collector: "sum", formatter:"money", align: "right"},
			    					{key: "user10", 	collector: "sum", formatter:"money", align: "right"},
			    					{key: "user11", 	collector: "sum", formatter:"money", align: "right"},
			    					{key: "user12", 	collector: "sum", formatter:"money", align: "right"},
			    					{key: "user13", 	collector: "sum", formatter:"money", align: "right"},
			    					{key: "user14", 	collector: "sum", formatter:"money", align: "right"},
			    					{key: "user15", 	collector: "sum", formatter:"money", align: "right"},
			                    ]
			                }		
		                },

		            page : {
		                display : false,
		            },footSum: [
				    	[
				    		{label: "총계", colspan:2, align:"center"},
						{key: "totalSum", 		collector: "sum", formatter:"money", align: "right"},
						{key: "totPct",  	collector: "sum", 	formatter:"money",	align: "right"},
						{key: "user1", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user2", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user3", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user4", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user5", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user6", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user7", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user8", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user9", 		collector: "sum", formatter:"money", align: "right"},
						{key: "user10", 	collector: "sum", formatter:"money", align: "right"},
						{key: "user11", 	collector: "sum", formatter:"money", align: "right"},
						{key: "user12", 	collector: "sum", formatter:"money", align: "right"},
						{key: "user13", 	collector: "sum", formatter:"money", align: "right"},
						{key: "user14", 	collector: "sum", formatter:"money", align: "right"},
						{key: "user15", 	collector: "sum", formatter:"money", align: "right"},
		                 ]
				    ],
		            columns : [
// 		            	 	{key: "workRptLNm", 	label: "부서구분",		width: 70,		align: "center" }
							{key: "workRptMNm",  	label: "업무분류",			width: 70,		align: "center"}
							,{key: "workRptSNm",  	label: "업무일지",  	    width: 200,		align: "left"}
							,{key: "totalSum",		label: "시간", 	    	width: 50,		align: "right"}
							,{key: "totPct",		label: "백분율", 	    	width: 55,		align: "right"}
		                ],
					});
		             return this;
		        },

		    setData : function() {
		        var targetObj = this.target;
		        var resDay = $('#writeYm').val().replace('-',''); //사용자가 등록하려는 년월
		        var formData = {
		            "coCd"          : jwt.coCd,
		            "workYm"     : resDay,
		            "workRptId" 	: "",
		            "workRptL" 		: $('#deptCd').val(),
		            "sortType"      : "DATE",	
		            "userName" 		: userName,
		            "prdtCd" : "",
		            "recordCnt" 	: 9999999	
		        }
		        
		        postAjax("/user/pm/pm40/selectWorkPrtList", formData, null, function(data){
		         	var list = data.result;
		         	if (list) {
			            targetObj.setData({
			                    list : list,
			                    page : {
			                        totalElements : list.length
			                    }
			                });
			            //gridResize2();
		         	}
				});
			}
		}
		     
	function gridHeightSet() {
		const grdiHeight = $(window).height()-800;
		gridView.target.setHeight(grdiHeight< 400 ? 400 : grdiHeight);
	}
	
	
$(document).ready(function() {
	
	$("#popForm #ordrgId").val(jwt.userId);
	$("#popForm #ordrgNm").val(jwt.userNm);
	$("#popForm #deptCd").val(jwt.deptId);
	
    // 년월 select 세팅
	SetYm();
	
    gridView.initView();
    
    GridHeaderWrite();
    gridHeightSet();
    //authChk();
    
 //   gridViewPop.initView();
	$("body").css("font-size", "12px");
    $("body").css("zoom", "100%");

	var newScreenWidth = $(window).width();
	var newScreenHeight = $(window).height();
	$('.popup_area').css('min-width', (newScreenWidth-15) + 'px');

    //작성일자//
    $('#workRptDt').datepicker({
        format : "yyyy-mm-dd",
        language : "ko",
        autoclose : true
    }).datepicker("setDate", new Date());

	const now = moment().startOf("month");
	var beDay = now.add(-2, "M").format("YYYY-MM-DD");	
    $('#cWorkYm').datepicker({
			format : "yyyy-mm",
			minViewMode: 1,
			language : "ko",
			autoclose : true
		})
		.datepicker("setDate", new Date())
		.on("changeDate", function(){
			$('#writeYm').val( $('#cWorkYm').val());
  			gridView.setData(0);
		});
    $('.popup_area').css('min-width', (newScreenWidth-15) + 'px');
    //세션에 정보를 활용하여 승인처리
    paramObj = JSON.parse(sessionStorage.getItem('paramObj'));
    sessionStorage.removeItem('paramObj');
    if (paramObj && paramObj != "undefined") {


    	$("#popForm #coCd").val(jwt.coCd);
        actionType = paramObj.actionType;
        fileTrgtKey = paramObj.fileTrgtKey;
		$("#fileTrgtKey").val(fileTrgtKey);

		setCommonSelect($(".popup_area select[data-kind]"));
		//setWorkPtDept();//자동분류 자동선택

        if (actionType == "C") {
            $("#actionBtn").text("등록");

          //modal 넘어온값만큼 만큼 루프
			$.each(paramObj, function (key, val) {
				//입고정보 SET
				if( $("#popForm").find("#"+key).length > 0 ) {
					$("#popForm").find("#"+key).val(val);
				}
			});
			 $('#workYm').text('고찰년월');
            $('#actionBtn').on("click", function() {
                insert_pm40_p02();
            });

            gridView.setData(0);
        } else if (actionType == "U") {
            $('.tit').text('작업일보 수정-팀')

            select_pm40_Info();
         	// 1. <th> 태그의 colspan 속성 변경
            $('#workYm').attr('colspan', '2');
            // 2. <td> 태그를 숨김 처리
            $('#create_td').css('display', 'none');
           
          //modal 넘어온값만큼 만큼 루프
			$.each(paramObj, function (key, val) {
				//입고정보 SET
				if( $("#popForm").find("#"+key).length > 0 ) {
					$("#popForm").find("#"+key).val(val);
				}
				
				if (key == 'workYm'){//소분류 select 코드 세팅
					$('#writeYm').val(val);
					$('#workYm').text(val.substring(0, 4)+"-"+val.substring(4, 6));
				}
				
			});
            gridView.setData(0);
            
            $('#actionBtn').text("수정");
            $('#actionBtn').on("click", function() {
                update_pm40_p02();
            });
        }
        //authChk();   // 권한체크
    } else {
        window.history.back();
    }

});



//입력정보
function select_pm40_Info() {
	var formData = {
		"workNo" : paramObj.workNo,
	}
	
	postAjaxSync("/user/pm/pm40/select_pm40_Info", formData, null, function(data) {
		if (data.result.workNo) {	//해당 자료가 존재해야함
			$.each(data.result, function(key, value) {
				if ($('#popForm #' + key)[0]) {
					$('#popForm #' + key).val(value);
					if ($('#popForm #' + key).is('[comma]')) {
						onlyNumber($('#popForm #' + key)[0]);
					}
				}
				if (key === "userNm") {
		            $("#popForm #ordrgNm").val(value);
		        }
				if (key === "userId") {
		            $("#popForm #ordrgId").val(value);
		            
		            if (value != jwt.userId ) {	//수정 버튼 작성자이면 수정 가능하게 하고 아니면 수정버튼 숨김
						$('.popup_area #actionBtn').hide();
					} else {
						$('.popup_area #actionBtn').show();
					}
		        }
			});

			// 크기 조절할 textarea ID 리스트
			const textAreas = [
			    '#workGoodTxt',  // 잘한점
			    '#workBadTxt',   // 아쉬운점
			    '#workNeedTxt',  // 개선할점
			    '#workProposalTxt', // 건의사항
			    '#workRmk'       // 비고
			];
			// 각 textarea에 대해 크기 조절 함수 호출
			textAreas.forEach(textAreaId => {
			    txtareaHeightResize($(textAreaId));
			});
			
			selectApprovalCheck(data.result.workNo);
			
			
		} else {
			alert('해당 고찰 자료가 없습니다.  전산실 확인 바랍!')
		}
	});
}

//등록
function insert_pm40_p02() {
	if (inputValidation($('.popup_area [required]'))) {		// 필수 필드의 유효성 검사
		var formData = makeFormData();						// 요청이 통과하면 makeFormData() 함수를 이용해 formData를 생성
		filePostAjax("/user/pm/pm40/insert_pm40_p02", formData,	function(data) {
			alert(data.resultMessage);
			if (data.resultCode == 200) {		//  요청이 성공(200)한 경우, gridView.setData(0)를 호출하여 그리드 뷰를 업데이트하고,
				$('#workNo').val(data.workNo);
				//kakaoTodo();
				
				 window.history.back();			// 모달을 닫음
			}
		});
	}
}


// 수정
function update_pm40_p02() {
    if (inputValidation($('.popup_area [required]'))) {
    	//문제여부가 이면 제목 입력은 필수처리하기 위함
        

        $('#actionBtn').hide();
        var formData = makeFormData();
         filePostAjax("/user/pm/pm40/update_pm40", formData,function(data) {
        	 
        	 alert(data.resultMessage);
                    if (data.resultCode == 200) {
                    	
                          //  kakaoTodo();
                       
                        window.history.back();
                    }
                }); 
    }
}

function makeFormData() {
    // 날짜 하이픈 제거
    $.each($('.popup_area input[date]'), function(idx, elem) {
        deleteHyphen(elem);
    });


    // 폼데이터 생성
    var formData = new FormData($("#popForm")[0]);

		
		var writeDt = $("#cWorkYm").val().replace(/\-/g, '');
		$("#deptCd").val(jwt.deptId.slice(0,5));
		
		formData.append("userId", $("#popForm #ordrgId").val());
		formData.append("workYm", writeDt);
		formData.append("workDiv", "팀");
		formData.append("deptCd", $("#deptCd").val());


    return formData;
}


function selectApprovalCheck(value) {
    var formData = {
          "reqNo" : value
    }
    postAjaxSync("/user/qm/qm01/selectApprovalChk", formData, null, function(data) {//결재가 진행이 되었는지 안되었는지 DB체크
       var list = data.result[0]
        if (list == 'Y'){//결재가 한개라도 진행이 되었으면 알림창
        	$('.tit').text($('.tit').text() + ' (결재진행으로 수정불가)');
            //input readonly, radio.checkbox disabled
          $.each($('#popForm select, input, textarea'), function(idx, elem){
             var id = $(elem).attr("ID");
             if( id ) {
                var eleId = "#popForm #"+id;
                if( $(elem).prop('tagName') == "INPUT" ) $(eleId).attr("readonly", true);
                if( $(elem).prop('tagName') == "TEXTAREA" ) $(eleId).attr("readonly", true);
                if( $(elem).prop('tagName') == "SELECT" ) $(eleId).css({'background-color':'#e6e6e6', 'pointer-events':'none'});
                if( $(elem).prop('type') == "checkbox" || $(elem).prop('type') == "radio") $(eleId).on('click', function(e) {e.preventDefault();});
             }

          });

          $('#main_area #actionBtn').remove();
          $("#plus-minus").remove();
        }
    });
 }



function SetYm(){
	var now = new Date();
	var nyear = now.getFullYear();
	var nmon =  (now.getMonth()+1) > 9 ? ''+(now.getMonth()+1) : '0'+(now.getMonth()+1);
	
	$('#writeYm').val(`${nyear}-${nmon}`);
	$('#workYm').text(`${nyear}-${nmon}`);
	
}

function txtareaHeightResize(obj) {
	const rowCount = obj.val().split(/\r\n|\r|\n/).length;

	if(rowCount < 4)
		obj.css('height', "60px");
	else
		obj.css('height', (rowCount * 20) + "px");
}
function GridHeaderWrite(){
	var userDeptId = jwt.deptId.substr(0, 5);
	var userDept = userDeptId.substr(0, 5);
	
	formData = {
				 "deps": userDept,
				 "userId": jwt.userId
	           }
	postAjaxSync("/user/pm/pm37/select_all_name", formData, null, function(data) {
		var list = data.result;
		userName='';
		
		 if (list.length > 0) {
                $.each(list, function(idx, elem){
                	gridView.target.addColumn({key: "user"+[idx+1], label:elem.name, width: 55, align: "right"});
                	//excelView.target.addColumn({key: "user"+[idx+1], label:elem.name, width: 70,  align: "right"});
                	userName += elem.name + ',';
                });
		 }
	});
}
</script>

</body>

</html>