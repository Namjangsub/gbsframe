<style>
	input[comma] {text-align: right;}
	.biz-qty-contain, .biz-amt-contain, .biz-creatid-contain, .biz-creatdttm-contain {
		margin-right: 0px;
		align-items: center;
		display: flex;
		flex-direction: row;
		gap: 3px;
	}
	.biz-qty-box, .biz-amt-box {
		margin-left: 3px;
		margin-bottom: 3px;
		width: 65px;
		height: 30px; 
		align-items: center;
		background-color: #eeeeee;
		color: #333;
		border: 1px solid #eeeeee;
		padding: 6px;
		border-radius: 4px;
	}

	.biz-creatid-box, .biz-creatdttm-box {
		margin-left: 3px;
		width: 70px;
		height: 30px; 
		align-items: center;
		background-color: #eeeeee;
		color: #333;
		border: 1px solid #eeeeee;
		padding: 5px;
		border-radius: 4px;
	}

	.bizTable-readonly-container {
		display: flex;
		flex-direction: column;
		gap: 3px;
		padding: 3px;
		border-radius: 4px;
		width: 200px;
	}

	.bizTable-readonly-container input[readonly] {
		width: 260px;
		height: 30px;
		padding: 1px;
		cursor: default;
		color: #333;
		border: 1px solid #ddd !important;
	}
</style>
<div class="popup_area of_a" style="width: 100%; height: 100%;">
	<div class="tit_contents">
        <h4 class="tit">ê±°ë˜ì²˜ê´€ë¦¬</h4>
    </div>

	<div class="popup_table">
		<div class="form-group">
			<input type="file" id="clntFile" style="display:none" multiple="multiple" onchange="setClntFile(this);"/>
			<form id="clntForm">
				<input type="hidden" id="pgmId" name="pgmId" value="BM0202P01">
				<input type="hidden" id="clntCd_P" name="clntCd_P">
				<input type="hidden" id="targetCd" name="targetCd">
				<!-- ê¸°ë³¸ì •ë³´ í…Œì´ë¸” -->
				<table class="popup_table">
					<colgroup>
						<col width="15%">
						<col width="18%">
						<col width="15%">
						<col width="18%">
						<col width="15%">
						<col width="19%">
					</colgroup>
					<thead>
						<tr>
							<td colspan="5" style="text-align: left;">ê¸°ë³¸ì •ë³´</td>
							<td style="text-align: right;">
								<a class="tbody_more_btn"></a>
							</td>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th class="hit">ê±°ë˜ì²˜ëª…</th>
							<td>
								<input type="text" class="form-control" id="clntNm_P" name="clntNm_P" maxlength="25" required msg="ê±°ë˜ì²˜ëª…">
								<input type="hidden" id="targetNm">
							</td>
							<th class="hit">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</th>
							<td>
								<input type="text" class="form-control" id="crn" name="crn" onkeyup="crnFormatter(this);" maxlength="14" required msg="ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸">
							</td>
							<th>ë²•ì¸ë²ˆí˜¸</th>
							<td>
								<input type="text" class="form-control" id="coprtNo" name="coprtNo" maxlength="14">
							</td>

						</tr>
						<tr>
							<th>ëŒ€í‘œìëª…</th>
							<td>
								<input type="text" class="form-control" id="repstNm" name="repstNm" maxlength="25">
							</td>
							<th class="hit">ë²ˆí˜¸ìœ í˜•</th>
							<td>
								<select class="form-control input-sm" id="crnTyp" name="crnTyp" data-kind="CRNTYP" required msg="ì‚¬ì—…ìë²ˆí˜¸ ë“±ë¡ë²ˆí˜¸ ìœ í˜•">
<!-- 									<option value="">ì„ íƒ</option> -->
								</select>
							</td>
							<th>ì—…íƒœ</th>
							<td>
								<input type="text" class="form-control" id="bizconNm" name="bizconNm" maxlength="50">
							</td>
						</tr>
						<tr>
							<th rowspan="2">ì£¼ì†Œ</th>
							<td>
								<div class="search_form">
									<input type="text" id="bizZip" name="bizZip" placeholder="ìš°í¸ë²ˆí˜¸" readonly>
									<a onclick="openDaumPostcode();"><i class="i_search_w"></i></a>
								</div>
							</td>
							<th class="hit">ê±°ë˜ì²˜êµ¬ë¶„</th>
							<td>
								<select class="form-control input-sm" id="clntDivCd" name="clntDivCd" data-kind="CLNTDIV" required  msg="ê±°ë˜ì²˜êµ¬ë¶„">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<th>ì¢…ëª©</th>
							<td>
								<input type="text" class="form-control" id="bstyNm" name="bstyNm" maxlength="20">
							</td>
						</tr>
						<tr>
							<td colspan="3">
								<div class="form-inline" style="text-align: left;">
									<input type="text" class="form-control" id="bizAddr" name="bizAddr" style="width:49.5%;" placeholder="ì£¼ì†Œ" readonly>
									<input type="text" class="form-control" id="bizAddrDtl" name="bizAddrDtl" style="width:49.5%;" placeholder="ìƒì„¸ì£¼ì†Œ" maxlength="500">
								</div>
							</td>
							<th>ì‚¬ìš©ì—¬ë¶€</th>
							<td colspan="2">
								<select class="form-control input-sm" id="useYn" name="useYn">
									<option value="Y">ì‚¬ìš©</option>
									<option value="N">ë¯¸ì‚¬ìš©</option>
								</select>
							</td>
						</tr>
						<tr>
							<th  class="hit">ì „í™”ë²ˆí˜¸</th>
							<td>
								<input type="text" class="form-control" id="bizTelNo" name="bizTelNo" onkeyup="telNumberFormatter(this);" required maxlength="20", required msg="ì „í™”ë²ˆí˜¸">
							</td>
							<th>FAX</th>
							<td>
								<input type="text" class="form-control" id="bizFaxNo" name="bizFaxNo" onkeyup="telNumberFormatter(this);" maxlength="20">
							</td>
							<th>URL</th>
							<td>
								<input type="text" class="form-control" id="subRmkUrl" name="subRmkUrl" maxlength="100">
							</td>
						</tr>
						<tr>
							<th>ì£¼ê±°ë˜ì€í–‰</th>
							<td>
								<select class="form-control input-sm" id="bankCd" name="bankCd" data-kind="BANK">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<th>ê³„ì¢Œë²ˆí˜¸</th>
							<td>
								<input type="text" class="form-control" id="bkacNo" name="bkacNo" onkeyup="onlyBkac(this);" maxlength="20">
							</td>
							<th>ê³„ì¢Œì†Œìœ ì£¼</th>
							<td>
								<input type="text" class="form-control" id="bkacOwner" name="bkacOwner" maxlength="10">
							</td>
						</tr>
<!-- 						<tr> -->
<!-- 							<th>ì‹ ìš©ì—°ê³„ì—¬ë¶€</th> -->
<!-- 							<td> -->
<!-- 								 <input type="text" id="linkGrpYn" name ="linkGrpYn" value="N" readonly> -->
<!-- 							</td>  -->
<!-- 	                    	<th>ì—°ê³„ê±°ë˜ì²˜</th> -->
<!-- 	                        <td> -->
<!-- 	                            <input type="hidden" id="basisCdtlnAmt" name="basisCdtlnAmt" > -->
<!-- 	                            <input type="hidden" id="linkGrpClntCd" name="linkGrpClntCd"> -->
<!-- 		                        <input type="text" id="linkGrpClntNm" name ="linkGrpClntNm" readonly>  -->
<!-- 	                        </td>   -->
<!-- 	                        <th>ê³µí†µì—¬ì‹ ê¸ˆì•¡(ì—°ê³„ê±°ë˜ì²˜)</th> -->
<!-- 	                        <td> -->
<!-- 	                            <div class="search_form" id="drctArea"> -->
<!-- 	          						<input id="commonCreditSecurity" name="commonCreditSecurity" style="text-align: left;" onkeyup="onlyNumber(this);" comma readonly> -->
<!-- 		                        </div> -->
<!-- 	                        </td>   -->
<!-- 							<th>ê¸°ë³¸ì—¬ì‹ ê¸ˆì•¡</th> -->
<!-- 							<td> -->
<!-- 								<input type="text" class="form-control" id="basisCdtlnAmt" name="basisCdtlnAmt" comma readonly> -->
<!-- 							</td> -->
<!-- 						</tr> -->
						<tr>
							<th>ë©”ëª¨</th>
							<td colspan="5">
								<textarea class="form-control" id="clntRmk" name="clntRmk" style="height: 60px;" maxlength="500"></textarea>
							</td>
						</tr>
					</tbody>
				</table>
				<br>
				<!-- ë§¤ì…/ë§¤ì¶œì •ë³´ í…Œì´ë¸” -->
				<table id="sellTypePopup" class="popup_table">
					<colgroup>
						<col width="10%">
						<col width="10%">
						<col width="10%">
						<col width="10%">
						<col width="10%">
						<col width="15%">
						<col width="35%">
					</colgroup>
					<thead>
						<tr>
							<td colspan="6" style="text-align: left;">ë§¤ì…/ë§¤ì¶œì •ë³´</td>
							<td style="text-align: right;">
								<a class="tbody_more_btn"></a>
							</td>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th class="tc">êµ¬ë¶„</th>
							<th class="tc">ì§€ê¸‰êµ¬ë¶„</th>
							<th class="tc">ê²°ì œë°©ë²•</th>
							<th class="tc">ìˆ˜ê¸ˆì¡°ê±´</th>
							<th class="tc">ê²°ì œì¼</th>
							<th class="tc">ë¶€ê°€ì„¸</th>
							<th class="tc">ë¹„ê³ </th>
						</tr>
						<tr>
							<td>ë§¤ì…</td>
							<td>
								<select class="form-control input-sm" id="pchsPayDivCd" name="pchsPayDivCd" data-kind="PAYDIV">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<td>
								<select class="form-control input-sm" id="pchsPmntMtdCd" name="pchsPmntMtdCd" data-kind="PMNTMTD">
									<option value="">ì„ íƒ</option>
								</select>
							</td>							
							<td>
								<select class="form-control input-sm" id="pchsClmnDivCd" name="pchsClmnDivCd" data-kind="CLMNDIV" onchange="setByPchsClmnDay(this.value);">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<td>
							   <input type="text" class="form-control" id="pchsClmnDay" name="pchsClmnDay" maxlength="20" onkeyup="onlyNumber(this)">
							</td>
							<td>
								<select class="form-control input-sm" id="pchsVatCd" name="pchsVatCd" data-kind="VAT">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<td>
							   <input type="text" class="form-control" id="pchsClmnRmk" name="pchsClmnRmk">
							</td>							
						</tr>
						<tr>
							<td>ë§¤ì¶œ</td>
							<td>
								<select class="form-control input-sm" id="sellPayDivCd" name="sellPayDivCd" data-kind="PAYDIV">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<td>
								<select class="form-control input-sm" id="sellPmntMtdCd" name="sellPmntMtdCd" data-kind="PMNTMTD">
									<option value="">ì„ íƒ</option>
								</select>
							</td>							
							<td>
								<select class="form-control input-sm" id="sellClmnDivCd" name="sellClmnDivCd" data-kind="CLMNDIV" onchange="setBySellClmnDay(this.value);">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<td>
							   <input type="text" class="form-control" id="sellClmnDay" name="sellClmnDay" maxlength="20" onkeyup="onlyNumber(this)">
							</td>
							<td>
								<select class="form-control input-sm" id="sellVatCd" name="sellVatCd" data-kind="VAT">
									<option value="">ì„ íƒ</option>
								</select>
							</td>
							<td>
							   <input type="text" class="form-control" id="sellClmnRmk" name="sellClmnRmk">
							</td>
						</tr>
					</tbody>
				</table>
			</form>
			<br>
			<!-- ì‚¬ì—…ë¶€ í…Œì´ë¸” -->
			<table class="popup_table" id="bizdeptTable">
				<colgroup>
					<col width="3%">
					<col width="11%">
					<col width="8%">
					<col width="8%">
					<col width="8%">
					<col width="8%">
					<col width="11%">
					<col width="8%">
					<col width="8%">
					<col width="8%">
					<col width="11%">
					<col width="8%">
				</colgroup>
				<thead>
					<tr>
						<td colspan="11" style="text-align: left;">ì‚¬ì—…ë¶€</td>
						<td style="text-align: right;">
							<a class="tbody_more_btn"></a>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="12">
							<div class="add_btn">
								<a onclick="addBizdeptRow();" authchk>+</a> 
								<a onclick="removeBizdeptRow();" authchk>-</a>
							</div>
						</td>
					</tr>
					<tr name="bizdeptHead">
						<th></th>
						<th class="tc">ì‚¬ì—…ë¶€ëª…</th>
<!-- 						<th class="tc">ì‚¬ì—…êµ¬ë¶„</th> -->
						<th class="tc">ë‹´ë‹¹ìëª…</th>
						<th class="tc">ë‹´ë‹¹ìì „í™”ë²ˆí˜¸</th>
						<th class="tc">ë‹´ë‹¹ìíœ´ëŒ€ì „í™”</th>
						<th class="tc">ë‹´ë‹¹ìì´ë©”ì¼</th>
						<th class="tc">ë‹´ë‹¹ìë¶€ì„œëª…</th>
						<th class="tc">ë‹´ë‹¹ìì§ìœ„</th>
						<th class="tc">ì˜ì—…íšŒì‚¬</th>
						<th class="tc">ì˜ì—…ì‚¬ì›</th>
						<th class="tc">ì‚¬ìš©ì—¬ë¶€</th>
					</tr>
				</tbody>
			</table>
			<table id="bizdeptFrameTable" style="display: none;">
				<tr name="bizdeptRow">
					<td>
						<input type="hidden"   id="bizdeptSn" name="bizdeptSn">
						<input type="checkbox" name="bizdeptChkBox">
					</td>
					<td>
						<input type="text" class="form-control" name="bizdeptNm" maxlength="25" required msg="ì‚¬ì—…ë¶€ëª…">
					</td>
<!-- 					<td> -->
<!-- 						<select class="form-control input-sm" name="bizdeptDivCd" data-kind="BIZDIV" > -->
<!-- 							<option value="">ì„ íƒ</option> -->
<!-- 						</select> -->
<!-- 					</td> -->
					<td>
						<input type="text" class="form-control" name="mngNm" maxlength="100">
					</td>
					<td>
						<input type="text" class="form-control" name="mngTelNo" onkeyup="telNumberFormatter(this);" maxlength="13">
					</td>
					<td>
						<input type="text" class="form-control" name="mngMoblphonNo" onkeyup="telNumberFormatter(this);" maxlength="13">
					</td>
					<td>
						<input type="text" class="form-control" name="mngEmail" maxlength="50">
					</td>
					<td>
						<input type="text" class="form-control" name="mngDeptNm" maxlength="15">
					</td>
					<td>
						<select class="form-control input-sm" name="mngPstCd" data-kind="PST">
							<option value="">ì„ íƒ</option>
						</select>
					</td>
					<td>
						<select class="form-control input-sm" name="salesCoCd" data-kind="CO" onchange="initSalesEmp(this);">
							<option value="">ì„ íƒ</option>
						</select>
					</td>
					<td>
						<div class="search_form">
							<input type="hidden" class="form-control" name="salesEmpId">
							<input type="text" class="form-control" name="salesEmpNm" readonly>
							<a onclick="openSecondUserSearch(this);">
								<i class="i_search_w"></i>
							</a>
						</div>
					</td>
					<td>
						<select class="form-control input-sm" name="useYn">
							<option value="Y">Y</option>
							<option value="N">N</option>
						</select>
					</td>
				</tr>
			</table>
			<br>
			<!-- ë‹´ë³´ë‚´ì—­ í…Œì´ë¸” -->
<!--			<table class="popup_table" id="pldgTable">
				<colgroup>
					<col width="8%">
					<col width="6%">
					<col width="8%">
					<col width="8%">
					<col width="10%">
					<col width="8%">
					<col width="8%">
					<col width="8%">
					<col width="32%">
					<col width="6%">
					<col width="8%">
				</colgroup>
				<thead>
					<tr>
						<td colspan="10" style="text-align: left;">ë‹´ë³´ë‚´ì—­</td>
						<td style="text-align: right;">
							<a class="tbody_more_btn"></a>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr name="pldgHead">
						<th class="tc">íšŒì‚¬</th>
						<th class="tc">êµ¬ë¶„</th>
						<th class="tc">ì¬í’ˆê·¸ë£¹</th>
						<th class="tc">ë³€ê²½</th>
						<th class="tc">ìœ í˜•</th>
						<th class="tc">ê¸ˆì•¡</th>
						<th class="tc">ì„¤ì •ì¼</th>
						<th class="tc">ë§Œê¸°ì¼</th>
						<th class="tc">ë¹„ê³ </th>
						<th class="tc">ë³´ì¦ê¸°ê´€</th>
						<th class="tc">ì‚¬ìš©ì—¬ë¶€</th>
					</tr>
				</tbody>
			</table>
			<table id="pldgFrameTable" style="display: none;">
				<tr name="pldgRow">
					<td>
				 		<input type="hidden"   id="pldgSn" name="pldgSn" >
						<select class="form-control input-sm" name="coCd" data-kind="CO" disabled>
				 			<option value="">ì„ íƒ</option>
				 		</select>
				 	</td>
				 	<td>
				 		<select class="form-control input-sm" name="selpchCd" data-kind="SELPCH" disabled>
				 			<option value="">ì„ íƒ</option>
				 		</select>
				 	</td>
				 	<td>
				 		<select class="form-control input-sm" name="prdtGrp" data-kind="PRDTGRP" disabled>
				 			<option value="">ì„ íƒ</option>
				 		</select>
				 	</td>
				 	<td>
				 		<select class="form-control input-sm" name="pldgChgCd" data-kind="PLDGCHG" disabled>
				 			<option value="">ì„ íƒ</option>
				 		</select>
				 	</td>				 	
				 	<td>
				 		<select class="form-control input-sm" name="pldgDivCd" data-kind="PLDG" disabled>
				 			<option value="">ì„ íƒ</option>
				 		</select>
				 	</td>
				 	<td>
				 		<input type="text" class="form-control" name="pldgAmt" comma readonly>
				 	</td>
				 	<td>
				 		<input type="text" class="tc" name="setupDt" readOnly>
				 	</td>
				 	<td>
				 		<input type="text" class="tc" name="exprtnDt" readOnly>
				 	</td>
				 	<td>
				 		<input type="text" class="form-control" name="pldgRmk" readOnly>
				 	</td>
				 	<td>
				 		<input type="hidden" class="form-control" name="cdtlnAmt" comma readOnly>
				 		<select class="form-control input-sm" name="grntyInsttCd" data-kind="INSTT" disabled>
				 			<option value="">ì„ íƒ</option>
				 		</select>
				 		
				 	</td>
				 	<td>
				 		<input type="text" class="tc" name="useYn" readOnly>
				 	</td>
				 	<td>
				 		<input type="text" class="tc" name="ptonNm" readOnly>
				 	</td>				 	
				 </tr>
			</table>
			<table>
				<colgroup>
					<col width="8%">
					<col width="6%">
					<col width="8%">
					<col width="8%">
					<col width="10%">
					<col width="8%">
					<col width="8%">
					<col width="8%">
					<col width="32%">
					<col width="6%">
					<col width="8%">
				</colgroup>
				<tbody><tr>
					<th class="tc" colspan="5">í•©ê³„</th>
					<td>
						<input class="tr" type="text" id="pldgTotAmt" name="pldgTotAmt" comma="" readonly="">
					</td>
					<td></td> 
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
			</tbody></table>-->
			<!-- ì—…ë¬´ì´ë ¥ê´€ë¦¬ í…Œì´ë¸” -->
			<table class="popup_table" id="bizTable">
				<colgroup>
					<col width="3%">
					<col width="15%">
					<col width="38%">
					<col width="17%">
					<col width="13%">
					<col width="14%">
				</colgroup>
				<thead>
					<tr>
						<td colspan="5" style="text-align: left;">ì—…ë¬´ì´ë ¥ê´€ë¦¬</td>
						<td style="text-align: right;">
							<a class="tbody_more_btn"></a>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="6">
							<div class="add_btn">
								<a onclick="addBizRow();" authchk>+</a>
								<a onclick="removeBizRow();" authchk>-</a>
							</div>
						</td>
					</tr>
					<tr name="bizHead">
						<th></th>
						<th class="tc">ì œëª©</th>
						<th class="tc">ë‚´ìš©</th>
						<th class="tc">ë¹„ê³ </th>
						<th class="tc">ìˆ˜ëŸ‰/ê¸ˆì•¡</th>
						<th class="tc">ì´ë ¥</th>
					</tr>
				</tbody>
			</table>
			
			<table id="bizFrameTable" style="display: none;">
				<tr name="bizRow" style="height: 70px;">
					<td>
						<input type="hidden" id="bizSn" name="bizSn">
						<input type="checkbox" name="bizChkBox">
					</td>
					<td>
						<input type="text" class="form-control" name="bizTitl" style="height: 68px;" maxlength="25" msg="ì œëª©">
					</td>
					<td>
						<textarea rows="3" class="form-control" name="bizCnts" style="height: 68px;" maxlength="2000" msg="ë‚´ìš©"></textarea>
					</td>
					<td>
						<textarea rows="3" class="form-control" name="bizRmk" style="height: 68px;" maxlength="2000" msg="ë¹„ê³ "></textarea>
					</td>
					<td>
						<div class="biz-qty-amt-containbox">
							<div class="biz-qty-contain">
								<div class="biz-qty-box">ìˆ˜ëŸ‰</div>
								<input type="text" class="form-control" name="bizQty" style="width: 115px; height: 30px; margin-bottom: 2px;" maxlength="15" onkeyup="onlyNumber(this);" msg="ìˆ˜ëŸ‰" placeholder="ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
							</div>
							<div class="biz-amt-contain">
								<div class="biz-amt-box">ê¸ˆì•¡</div>
								<input type="text" class="form-control" name="bizAmt" style="width: 115px; height: 30px;" maxlength="15" onkeyup="onlyNumber(this);" msg="ê¸ˆì•¡" placeholder="ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
							</div>
						</div>
					</td>
					<td>
						<div class="bizTable-readonly-container">
							<div class="biz-creatid-contain">
								<div class="biz-creatid-box">ì‘ì„±ì</div>
								<input type="text" class="form-control" name="creatIdNm" style="width: 120px;" readonly maxlength="15" placeholder="ì‘ì„±ì">
							</div>
							<div class="biz-creatdttm-contain">
								<div class="biz-creatdttm-box">ì‘ì„±ì¼ì‹œ</div>
								<input type="text" class="form-control" name="creatDttm" style="width: 120px;" readonly maxlength="15" placeholder="ì‘ì„±ì¼ì‹œ">
							</div>
						</div>
					</td>
				</tr>
			</table>
			<br>
			<!-- ì²¨ë¶€íŒŒì¼ í…Œì´ë¸” -->
			<table class="popup_table">
				<colgroup>
					<col width="12%">
					<col width="">
				</colgroup>
				<thead>
					<tr>
						<td style="text-align: left;">ì²¨ë¶€íŒŒì¼</td>
						<td style="text-align: right;">
							<a class="tbody_more_btn"></a>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th>
							<button type="button" class="btn btn-primary btn-sm" style="height: 25px; line-height: 15px;" onclick="clntFile.click();" authchk>ì²¨ë¶€íŒŒì¼</button>
						</th>
						<td>
							<div data-ax5grid="file-grid" data-ax5grid-config="{}" style="height: 150px; width: 100%"></div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	<div class="popup_bottom_btn">
	    <button type="button" class="btn btn-default btn-sm" id="actionBtn" authchk></button>
	    <button type="button" class="btn btn-default btn-sm" onclick="modalStack.close();">ë‹«ê¸°</button>
    </div>
</div>
<script type="text/javascript">
	var $targetRow = null;
	var clntFileArr = [];
	var deleteFileArr = [];
	var fileGridView = {
		initView: function() {
			this.target = new ax5.ui.grid();
			this.target.setConfig({
				target: $('[data-ax5grid="file-grid"]'),
				showLineNumber: true,
				showRowSelector: false,
	        	multipleSelect: false,
				header: {selector: false},
				body: {
		            onDBLClick: function () {
		            	if(this.item.fileKey){
<<<<<<< HEAD
		            		downloadFile(this.item.fileKey, this.item.fileName);
=======
							debugger;
							downLoadFile(this.item.fileKey, this.item.fileName);
>>>>>>> branch 'main' of https://github.com/Namjangsub/gbsframe.git
						}
		            }
		        },
	            columns: [
	                {key: "fileName", label: "íŒŒì¼ëª…", width: 500},
	                {key: "fileType", label: "íŒŒì¼íƒ€ì…", width: 100},
	                {key: "fileSize", label: "íŒŒì¼í¬ê¸°", width: 100},
	                {
						key:"fileDelete", label: "ì‚­ì œ", width:60,
						formatter:function() {
							return '<button type="button" class="btn btn-default btn-sm" style="height: 19px; padding: 0 0 0 0;" onclick="deleteFile('+this.dindex+');" authchk>ì‚­ì œ</button>'
						}
					}
	            ]
			});
			return this;
		},
		setData: function() {
			var targetObj = this.target;
			targetObj.setData({
				list: clntFileArr,
				page : {
					totalElements : clntFileArr.length
				}
			});
		}
	}
	
	$(document).ready(function() {
		// ì˜ì—­ ì ‘ê¸°/ì—´ê¸° ì´ë²¤íŠ¸ ë°”ì¸ë”©

		$('a.tbody_more_btn').click(function() {
			$(this).toggleClass('on');
			$(this).closest('table').find('tbody').toggle();
		});
		
		// ê³µí†µì½”ë“œ set
		setCommonSelect($(".popup_area select[data-kind]"));
		
		// ê·¸ë¦¬ë“œ ì´ˆê¸°í™”
		fileGridView.initView().setData();
		
		var actionType = modalStack.last().paramObj.actionType;
		if(actionType == "C"){
	//		addBizdeptRow();
			$('#pldgTable').hide();
			$('#actionBtn').text("ë“±ë¡");
			$('#actionBtn').on("click", function(){insertClnt();});
		}else if(actionType == "U"){
			selectClntInfo();
			$('#actionBtn').text("ì €ì¥");
			$('#actionBtn').on("click", function(){updateClnt();});
		}
		
		//ê¶Œí•œì²´í¬
		authChk();
	});

	function selectClntInfo() {
		var paramObj = {"clntCd":  modalStack.last().paramObj.clntCd };
		postAjax("/admin/bm/bm02/selectClntInfo", paramObj, null, function(data){
			setClntInfo(data.clntInfo);
		});
	}
	
	function setClntInfo(clntInfo) {
		// ê¸°ë³¸ì •ë³´ set
		$.each(clntInfo, function(key, value){
			if($('#'+key)[0]){
				if(key == 'clntCd' || key == 'clntNm'){
				
				}else{
					$('#'+key).val(value);
					// ê¸ˆì•¡ ì½¤ë§ˆ set
					if($('#'+key).is('[comma]')){
						onlyNumber($('#'+key)[0]);
					}	
				}
			}
		});
		
		$('#targetNm').prev().val(clntInfo.clntNm);
		$('#targetCd').prev().val(clntInfo.clntCd);
		
		//ì—°ê³„ê±°ë˜ì²˜ ì—†ì„ ì‹œ ê³µí†µì—¬ì‹ ê¸ˆì•¡(ì—°ê³„ê±°ë˜ì²˜) > ''
		var linkGrpClntNm = $('#linkGrpClntNm').val();
		if(linkGrpClntNm == ""){ $('#commonCreditSecurity').val(''); }
		
		//ë²ˆí˜¸ìœ í˜• set
		var crnTyp = modalStack.last().paramObj.crnTyp;
		$('#crnTyp').val(crnTyp);
		
		// ì‚¬ì—…ë¶€ set
		var bizdeptList = clntInfo.bizdeptList;
		if(bizdeptList.length > 0){
			$.each(bizdeptList, function(idx, obj){
				var $bizdeptRow = addBizdeptRow();
				for(var i=0;i<$bizdeptRow.find('[name]').length;i++){
					var bizdeptItem = $bizdeptRow.find('[name]')[i];
					var itemValue = obj[bizdeptItem.name];
					if(itemValue){
						$(bizdeptItem).val(itemValue);
					}
				}
				if (obj.salesCoCd == undefined ) {
					$('[name="salesCoCd"]').val('');
				} else {
					$('[name="salesCoCd"]').val(obj.salesCoCd);
				}
			});
		}
// 		else{
// 			addBizdeptRow();
// 		}
		
		// ë‹´ë³´ë‚´ì—­ set
		var pldgList = clntInfo.pldgList;
		if(pldgList.length > 0){
			$.each(pldgList, function(idx, obj){
				var $pldgRow = addPldgRow();
				for(var i=0;i<$pldgRow.find('[name]').length;i++){
					var pldgItem = $pldgRow.find('[name]')[i];
					var itemValue = obj[pldgItem.name];
					
					if(itemValue){
						if($(pldgItem).is('[comma]')){
							itemValue = addCommaStr(itemValue);
						}
						$(pldgItem).val(itemValue);
					}
				}
			});	
		}else{
			$('#pldgTable tbody tr[name="bizdeptHead"]').remove();
			$('#pldgTable tbody').append('<tr><td colspan="9" class="tc">ë‹´ë³´ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>');
		}
		
		countTot();

		// ì—…ë¬´ì´ë ¥ set
		var bizList = clntInfo.bizList;
		if(bizList.length > 0){
			$.each(bizList, function(idx, obj){
				var $bizRow = addBizRow();
				for(var i=0;i<$bizRow.find('[name]').length;i++){
					var bizItem = $bizRow.find('[name]')[i];
					var itemValue = obj[bizItem.name];
					if(itemValue){
						$(bizItem).val(itemValue);
					}
				}
				if (obj.salesCoCd == undefined ) {
					$('[name="salesCoCd"]').val('');
				} else {
					$('[name="salesCoCd"]').val(obj.salesCoCd);
				}
			});
		}
		
		// ì²¨ë¶€íŒŒì¼ set
		var clntFileList = clntInfo.clntFileList;
		$.each(clntFileList, function(idx, obj){
			clntFileArr.push({
				'fileKey' : obj.fileKey,
		      	'fileName' : obj.fileName,
		      	'fileType' : obj.fileType,
		      	'fileSize' : obj.fileSize,
		      	'file' : obj
			});
		});
		
		// ì²¨ë¶€íŒŒì¼ ê·¸ë¦¬ë“œ set
		fileGridView.setData();
	}
	
	function openDaumPostcode() {
		new daum.Postcode({
			oncomplete:function(data){
				// ìš°í¸ë²ˆí˜¸
				$('#bizZip').val(data.zonecode);
				$('#bizAddr').val(data.roadAddress || data.address  + ' ' + data.buildingName);
			}
		}).open();
	}

	// ì‚¬ì—…ë¶€ ì¶”ê°€
	function addBizdeptRow(){
		var $bizdeptRow = $('#bizdeptFrameTable tr[name="bizdeptRow"]').clone();
		$('#bizdeptTable tbody').append($bizdeptRow[0]);
		// ì ‘ì†ì íšŒì‚¬ set
		$bizdeptRow.find('select[name="salesCoCd"]').val(jwt.coCd)
		return $bizdeptRow;
	}
	
	// ì‚¬ì—…ë¶€ ì‚­ì œ
	function removeBizdeptRow(){
		var $checkedBizdepts = $('#bizdeptTable input[name="bizdeptChkBox"]:checked');
		// ì‚¬ì—…ë¶€ ë‚´ì—­ ì¶”ê°€
		var bizdeptArr = [];

		if($checkedBizdepts.length > 0){
			$.each($checkedBizdepts, function(idx, elem){

				var bizdepObj = {};
				// í‚¤ ì¶”ê°€
				var bizdeptSn = $(elem).closest('tr').find('[name="bizdeptSn"]').val();
				if(bizdeptSn){
					bizdepObj["bizdeptSn"] = bizdeptSn;
					bizdeptArr.push(bizdepObj);
				}
				
				$(elem).closest('tr[name="bizdeptRow"]').remove();
			});
			
			deleteAjax("/admin/bm/bm02/deleteClntBizdept", {"bizdeptArr": bizdeptArr}, null, function(data) {
				if (data.resultCode == 200) {
					alert(data.resultMessage);
				}
			});
		}else{
			alert("ì‚­ì œí•  ì‚¬ì—…ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
		}
	}
	
	// ì˜ì—…íšŒì‚¬ ë³€ê²½
	function initSalesEmp(elem){
		var changedRow = $(elem).closest('tr[name="bizdeptRow"]');
		changedRow.find('[name="salesEmpId"]').val("");
		changedRow.find('[name="salesEmpNm"]').val("");
	}
	
	// ì˜ì—…ì‚¬ì› ê²€ìƒ‰
	function openSecondUserSearch(elem){
		$targetRow = $(elem).closest('tr[name="bizdeptRow"]');
		
		if(!$targetRow.find('[name="salesCoCd"]').val()){
			alert("ì˜ì—…íšŒì‚¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
			$targetRow.find('[name="salesCoCd"]').focus();
			return false;
		}
		
		var paramObj = {
			"coCd" : "GUN", // $targetRow.find('[name="salesCoCd"]').val(),
			"userId": $targetRow.find('[name="salesEmpId"]').val(),
			"userNm": $targetRow.find('[name="salesEmpNm"]').val(),
			"useYn": "Y"
		};
		
		openSecondModal("/static/html/cmn/modal/userSearch.html", 450, 650, "ì‚¬ìš©ì ê²€ìƒ‰", paramObj, function (tree){
			var checkedId = tree.get_checked()[0];
			var checkedNode = tree.get_node(checkedId);
			$targetRow.find('[name=salesEmpId]').val(checkedNode.id);
			$targetRow.find('[name=salesEmpNm]').val(checkedNode.text);
		});
	}
	
	// ë‹´ë³´ë‚´ì—­ ì¶”ê°€
	function addPldgRow(){
		var $pldgRow = $('#pldgFrameTable tr[name="pldgRow"]').clone();
		$('#pldgTable tbody').append($pldgRow[0]);
		return $pldgRow;
	}

	// ì—…ë¬´ì´ë ¥ ì¶”ê°€
	function addBizRow(){
		var $bizRow = $('#bizFrameTable tr[name="bizRow"]').clone();
		$('#bizTable tbody').append($bizRow[0]);
		// ì ‘ì†ì íšŒì‚¬ set
		$bizRow.find('select[name="salesCoCd"]').val(jwt.coCd);
		return $bizRow;
	}

	// ì—…ë¬´ì´ë ¥ ì‚­ì œ
	function removeBizRow(){
		var $checkedBizs = $('#bizTable input[name="bizChkBox"]:checked');
		var bizArr = [];
		var clntCd = $('#clntCd_P').val();

		if($checkedBizs.length > 0){
			$.each($checkedBizs, function(idx, elem){
				var bizObj = {};
				var bizSn = $(elem).closest('tr').find('[name="bizSn"]').val();
				if(bizSn){
					bizObj["bizSn"] = bizSn;
					bizObj["clntCd_P"] = clntCd;
					bizArr.push(bizObj);
				}
				$(elem).closest('tr[name="bizRow"]').remove();
			});
			
			deleteAjax("/admin/bm/bm02/deleteBiz", {"bizArr": bizArr}, null, function(data) {
				
			});
		}else{
			alert("ì‚­ì œí•  ì—…ë¬´ì´ë ¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
		}
	}
	
	// íŒŒì¼ ì¶”ê°€
	function setClntFile(elem) {
		var tempFiles = elem.files;
		// ì „ì—­ë³€ìˆ˜ ë°°ì—´ì— ì„ íƒëœ íŒŒì¼ ì¶”ê°€ 
		$.each(tempFiles, function(idx, obj){
			var typeArr = obj.name.split(".");
			clntFileArr.push({
				'fileKey' : 0,
		      	'fileName' : obj.name,
		      	'fileType' : typeArr[typeArr.length-1],
		      	'fileSize' : obj.size,
		      	'file' : obj
			});
		});
		
		// ì²¨ë¶€íŒŒì¼ ê·¸ë¦¬ë“œ set
		fileGridView.setData();
		
		// input file ì´ˆê¸°í™”
		$(elem).val("");
	}
	
	// íŒŒì¼ ì‚­ì œ
	function deleteFile(rowIndex) {
		if(clntFileArr[rowIndex].fileKey){
		// ê¸° ë“±ë¡ë˜ì–´ ìˆëŠ” íŒŒì¼ ì‚­ì œì‹œ
			deleteFileArr.push(clntFileArr[rowIndex].fileKey);
		}
		clntFileArr.splice(rowIndex, 1);
		
		// ì²¨ë¶€íŒŒì¼ ê·¸ë¦¬ë“œ set
		fileGridView.setData();
	}
	
	// íŒŒì¼ ë‹¤ìš´ë¡œë“œ
<<<<<<< HEAD
	function downloadFile(fileKey, fileName) {
	    postAjax("/admin/cm/cm08/fileDownInfo", { fileKey: fileKey }, null, function(data) {
	        const fileInfo = data.fileInfo;
	        const filePath = encodeURI(fileInfo.filePath + fileInfo.fileKey + "_" + fileInfo.fileName, "UTF-8");
	
	        fetch(`/admin/cm/cm08/fileDownload?filePath=${filePath}`, {
	            method: "GET",
	            headers: {
	                "Authorization": authorizationToken
	            }
	        })
	        .then(response => {
	            if (!response.ok) throw new Error("ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨");
	            return response.blob();
	        })
	        .then(blob => {
	            // ğŸ‘‰ ìë™ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬
	            const downloadUrl = window.URL.createObjectURL(blob);
	            const link = document.createElement("a");
	            link.href = downloadUrl;
	            link.download = fileName;  // ë‹¤ìš´ë¡œë“œë  íŒŒì¼ ì´ë¦„
	            document.body.appendChild(link);
	            link.click();
	            document.body.removeChild(link);
	            window.URL.revokeObjectURL(downloadUrl);
	        })
	        .catch(error => {
	            console.error("íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜:", error);
	        });
	    });
=======
	async function downLoadFile(fileKey, fileName) {
		try {
//			const response = await fetch(`/admin/cm/cm08/fileDownloadAuth?fileKey=${fileKey}&userId=${jwt.userId}`);
			const response = await fetch(`/admin/cm/cm08/fileDownloadAuth2?fileKey=${fileKey}&userId=${jwt.userId}`, {
				  method: "GET",
				  headers: {"Authorization": authorizationToken}
			});
			if (!response.ok) throw new Error('ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨');
			const blob = await response.blob();

			saveBlobAsFile(blob, fileName);
			return 'SUCCESS';
			
		} catch (error) {
			console.error("íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜:", error);
			return 'ERROR';
		}
>>>>>>> branch 'main' of https://github.com/Namjangsub/gbsframe.git
	}

	
	// ë“±ë¡
	function insertClnt() {
// 		debugger;
		if(inputValidation($('.popup_area [required]').not('#bizdeptFrameTable [required]'))){
			var formData = makeFormData();
			filePostAjax("/admin/bm/bm02/insertClnt", formData, function(data){
				alert(data.resultMessage);
				if(data.resultCode == 200){
					gridView.setData(0);
					modalStack.close();
				}
			});
		}
	}
	
	// ìˆ˜ì •
	function updateClnt() {
		if(inputValidation($('.popup_area [required]').not('#bizdeptFrameTable [required]'))){
			var formData = makeFormData();
			filePutAjax("/admin/bm/bm02/updateClnt", formData, function(data){
				alert(data.resultMessage);
				if(data.resultCode == 200){
					if (typeof gridView !== 'undefined') gridView.setData(0);
// 					if (typeof clntPurchaseGridView !== 'undefined') clntPurchaseGridView.setData(0);
					modalStack.close();
				}
			});
		}
	}
	
	// í¼ë°ì´í„° ìƒì„±
	function makeFormData() {
		// ì½¤ë§ˆ ì œê±°
		$.each($('input[comma]'), function(idx, elem){deleteComma(elem);});
		// í¼ë°ì´í„° ìƒì„±
		var formData = new FormData($('#clntForm')[0]);
		// ìœ ì €ì•„ì´ë”” ì¶”ê°€
		formData.append("userId", jwt.userId);
		
		// ì‚¬ì—…ë¶€ ì¶”ê°€
		var bizdeptArr = [];
		$.each($('#bizdeptTable tr[name="bizdeptRow"]'), function(idx, elem){
			var bizdeptObj = {};
			$.each($(elem).find('[name]'), function(idx, elem){
				var elemName = elem.name;
				var elemValue = elem.value;
				bizdeptObj[elemName] = elemValue;
			});
			bizdeptArr.push(bizdeptObj);
		});
		formData.append("bizdeptArr", JSON.stringify(bizdeptArr));

		// ì—…ë¬´ì´ë ¥ê´€ë¦¬ ì¶”ê°€
		var bizArr = [];
		$.each($('#bizTable tr[name="bizRow"]'), function(idx, elem){
			var bizObj = {};
			$.each($(elem).find('[name]'), function(idx, elem){
				var elemName = elem.name;
				var elemValue = elem.value;

				// ê¸ˆì•¡ í•„ë“œ(bizAmt)ì—ì„œ ì‰¼í‘œ ì œê±°
				if (elemName === "bizAmt" || elemName === "bizQty") {
					elemValue = elemValue.replace(/,/g, ''); // ì‰¼í‘œ ì œê±°
				}

				bizObj[elemName] = elemValue;
			});
			delete bizObj["creatId"];
			delete bizObj["creatDttm"];
			bizArr.push(bizObj);
		});
		formData.append("bizArr", JSON.stringify(bizArr));
		
		// ì²¨ë¶€íŒŒì¼ ì¶”ê°€
		$.each(clntFileArr, function(idx, obj){
			// ì‹ ê·œíŒŒì¼ë§Œ ì¶”ê°€
			if(obj.fileKey == 0){
				formData.append("files", obj.file);
			}
		});
		
		// ìˆ˜ì •ì‹œ ì‚­ì œëœ íŒŒì¼ ì¶”ê°€
		var actionType = modalStack.last().paramObj.actionType;
		if(actionType == "U"){
			formData.append("deleteFileArr", JSON.stringify(deleteFileArr));
		}

		return formData;
	}
	
	//ë§¤ì… ì¼ì readonly ì²´í¬
	function setByPchsClmnDay(value){
		// ìˆ˜ê¸ˆì¡°ê±´
		// CLMNDIV07 ë‹¹ì›”
		// CLMNDIV01 ë‹¹ì›”ë§ì¼
		// CLMNDIV04 ìµì›”
		// CLMNDIV02 ìµì›”ë§ì¼
		// CLMNDIV05 ì°¨ìµì›”
		// CLMNDIV03 ì°¨ìµì›”ë§ì¼
		// CLMNDIV52 ì§í˜„ê¸ˆ
		// CLMNDIV38 ë°”í„°ì—…ì²´
		// CLMNDIV10 ë‚©í’ˆí›„
		// CLMNDIV11 ë§ˆê°í›„(ê³„ì‚°ì„œë°œí–‰)
		
		if(value == "CLMNDIV01" || value == "CLMNDIV02" || value == "CLMNDIV03"){
			$('#sellTypePopup #pchsClmnDay').prop("readonly", true);
			$('#sellTypePopup #pchsClmnDay').val("");
		}else{
			$('#sellTypePopup #pchsClmnDay').prop("readonly", false);
		}
	}
	
	//ë§¤ì¶œ ì¼ì disabled ì²´í¬
	function setBySellClmnDay(value){
		// ìˆ˜ê¸ˆì¡°ê±´
		// CLMNDIV07 ë‹¹ì›”
		// CLMNDIV01 ë‹¹ì›”ë§ì¼
		// CLMNDIV04 ìµì›”
		// CLMNDIV02 ìµì›”ë§ì¼
		// CLMNDIV05 ì°¨ìµì›”
		// CLMNDIV03 ì°¨ìµì›”ë§ì¼
		// CLMNDIV52 ì§í˜„ê¸ˆ
		// CLMNDIV38 ë°”í„°ì—…ì²´
		// CLMNDIV10 ë‚©í’ˆí›„
		// CLMNDIV11 ë§ˆê°í›„(ê³„ì‚°ì„œë°œí–‰)
		
		if(value == "CLMNDIV01" || value == "CLMNDIV02" || value == "CLMNDIV03"){
			$('#sellTypePopup #sellClmnDay').prop("readonly", true);
			$('#sellTypePopup #sellClmnDay').val("");
		}else{
			$('#sellTypePopup #sellClmnDay').prop("readonly", false);
		}
	}
	
	function countTot() {
		var pldgTotAmt = 0;
		var cdtlnTotAmt = 0;
		
		$.each($('#pldgTable tr[name="pldgRow"]'), function(idx, elem){
			var pldgAmt = Number(deleteCommaStr($(elem).find('input[name="pldgAmt"]').val())) || 0;
// 			var cdtlnAmt = Number(deleteCommaStr($(elem).find('input[name="cdtlnAmt"]').val())) || 0;

           // var useYn = $(elem).find('input[name="useYn"]').val();

		   if($(elem).find('input[name="useYn"]').val() == "Y")
			{
				pldgTotAmt += pldgAmt;
	// 			cdtlnTotAmt += cdtlnAmt;
			} 
		});
		$('#pldgTotAmt').val(addCommaStr(pldgTotAmt));
// 		$('#cdtlnTotAmt').val(addCommaStr(cdtlnTotAmt));

	}
</script>