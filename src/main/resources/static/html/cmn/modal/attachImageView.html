<style>
    .resized-image {
        width: 1024px;
        height: 768px;
        object-fit: contain; /* Maintain aspect ratio */
    }
</style>
<div id="commonViewPopup">
		<div class="popup_table">
			<img id="viewImgData" name="viewImgData" class="resized-image" src="data:image/png;base64," onclick="modalStack.close();">
		</div>
	<div class="popup_bottom_btn">
		<button class="close_btn" onclick="modalStack.close();">닫기</button>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function() {
	    // '이미지 다운로드' 버튼 클릭 시 이미지 다운로드
	    var fileKey = modalStack.last().paramObj.fileKey;
	    var fileName = modalStack.last().paramObj.fileName;
		var xhr = new XMLHttpRequest();
		xhr.open("GET", "/admin/cm/cm08/fileDownloadAuth?fileKey="+fileKey+"&userId="+jwt.userId, true);
		xhr.responseType = 'blob';
		xhr.onload = function() {
			if (xhr.status === 200) {
				var blob = xhr.response;
		          
				// Blob을 base64 데이터 URL로 변환
				var reader = new FileReader();
				reader.readAsDataURL(blob);
				reader.onloadend = function() {
					var base64data = reader.result;
					// base64 데이터를 이미지로 표시하는 img 요소에 설정
					var imgElement = document.getElementById('viewImgData');
					imgElement.src = base64data;
				};
			}
		};
	
		xhr.send();
		
		//마우스 오른쪽 클릭 파일저장함
//         document.getElementById('viewImgData').addEventListener('contextmenu', function(event) {
//             // Prevent the default context menu from showing
//             event.preventDefault();
            
//             // Create a temporary link element for downloading
//             const link = document.createElement('a');
//             link.href = event.target.src;
//             link.download = fileName;
//             document.body.appendChild(link);
//             link.click();
//             document.body.removeChild(link);
//         });
	});

</script>
