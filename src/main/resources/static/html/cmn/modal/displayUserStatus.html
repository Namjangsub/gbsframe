<style>
.empTR{
	height : 30px;
	text-align: left;
}
.emp_red {
	background-color: red;
	width: 6px;
	height: 6px;
	border-radius: 3px;
}

.emp_orange {
	background-color: RGB(252 198 3);
	width: 6px;
	height: 6px;
	border-radius: 3px;
}

.emp_blue {
	background-color: RGB(55 51 181);
	width: 6px;
	height: 6px;
	border-radius: 3px;
}


.arrow_box {
  display: none;
  position: absolute;
  width: 100px;
  padding: 8px;
  left: 0;
  -webkit-border-radius: 8px;
  -moz-border-radius: 8px;  
  border-radius: 8px;
  background: #333;
  color: #fff;
  font-size: 14px;
}

.arrow_box:after {
  position: absolute;
  bottom: 100%;
  left: 50%;
  width: 0;
  height: 0;
  margin-left: -10px;
  border: solid transparent;
  border-color: rgba(51, 51, 51, 0);
  border-bottom-color: #333;
  border-width: 10px;
  pointer-events: none;
  content: " ";
}

</style>

<div id="commonPopup">
	<div class="popup_area" style="min-height: 130px !important;">
		<div class="popup_table">
		<div id="employeeStatusListContainer"></div>	

		</div>
	</div>
	<div class="popup_bottom_btn">
		<button class="close_btn" onclick="modalStack.close();">닫기</button>
	</div>
</div>
<script type="text/javascript">
  
	$(document).ready(function() {
		createCheckBox();
	});
	

	function createCheckBox() {

		$('#employeeStatusListContainer').empty();
		var param = {};
		postAjaxSync("/admin/cm/cm06/selectEmployeeStatusList", param , null,  function(data){
			var codeList = data.result;
			var container = $('#employeeStatusListContainer');
			var lastDept = '';
			const table = $('<table>').appendTo('#employeeStatusListContainer')
			var tableRow = '';
			var tdCount = 0;
			$.each(codeList, function (index, item){
				if (lastDept != item.dept) {
					if (tdCount != 0 || tdCount != 4) {
						for (let i = tdCount; i < 4; i++) {
							const tdElement  = $('<td>').appendTo(tableRow);
						}
					}
					
					tableRow = $('<tr>').css('color', 'gray').addClass('empTR').appendTo(table);
					var trElement = $('<tr>');
					const rowCnt = Math.ceil(item.cnt / 4) // 양의 정부만 추출 ex) 4/3 = 2
					$('<th>').attr('rowspan', rowCnt).css('width', '11%').text(item.deptNm).appendTo(tableRow);
					lastDept = item.dept;
					tdCount = 0;
				} else {
// 					tableRow = $('<tr>').appendTo(table);
// 					var trElement = $('<tr>');
				}
				if (tdCount == 4) {
					tableRow = $('<tr>').css('color', 'gray').addClass('empTR').appendTo(table);
					var trElement = $('<tr>');
					tdCount = 0;
				}
				var workHoly = '';
				var textColor = 'rgb(2 141 113)';  //기본 컬러
				var userName =  item.name + item.levelNm.replace(/\s+/g, '');
				var txtTitle = userName + '님은 정상 근무중입니다.';
				if (item.workRptRmk == undefined) item.workRptRmk='';
				if (item.workHolyNm != undefined){	//사고자 컬러
					workHoly = '(' + item.workHolyNm + ')';
					textColor = 'rgb(129 129 130)';
					txtTitle = userName + '님은 ' + item.workHolyNm + '중입니다.\n' + item.workRptRmk;
				}
				userName = '<a style="color:' + textColor + '" title="' +  txtTitle + '">' + userName + workHoly+ '</a>';
				const iHtml = 
						userName  + '\n' +
						'<i class="fas fa-calendar-alt"></i><i class="fas ' + setStatus(item.scdLoad) + '"></i>\n' +
						'<i class="fas fa-tasks"></i><i class="fas ' + setStatus(item.qcLoad) + '"></i>\n' +
						'<i class="fas fa-user-shield"></i><i class="fas ' + setStatus(item.jobLoad) + '"></i>\n' +
						'<i class="fas fa-people-carry"></i><i class="fas ' + setStatus(item.commLoad) + '"></i>\n' 
				const tdElement  = $('<td>').appendTo(tableRow);
				tdElement.append(iHtml);
				tdCount += 1;

			});

			if (tdCount != 0 || tdCount != 4) {
				for (let i = tdCount; i < 4; i++) {
					const tdElement  = $('<td>').appendTo(tableRow);
				}
			}
		})	
	}

	function setStatus(set) {
		return (set == "COMM3") ? "emp_red" : (set == "COMM2") ? "emp_orange" : "emp_blue";
	}
	
</script>
