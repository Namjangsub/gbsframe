<style>
.empTR{
	height : 30px;
	text-align: left;
}
.emp_red {
	background-color: red;
	width: 6px;
	height: 6px;
	border-radius: 3px;
}

.emp_orange {
	background-color: RGB(252 198 3);
	width: 6px;
	height: 6px;
	border-radius: 3px;
}

.emp_blue {
	background-color: RGB(55 51 181);
	width: 6px;
	height: 6px;
	border-radius: 3px;
}

#stsName {
  margin-left: 4px;
  width: 115px;
  display: inline-block; 
}


/* Tooltip container */
/* this is a _demo_ container. remember the importance of relative and absolute positioning */
.tooltip-container {
    position: relative;
    display: flex;
    place-content: center;
    margin-top: 100px;
}

/* styling of the tooltip display */
p#tooltip-text {
    display: none;
    position: absolute;
    top: -60px;
    z-index: 1;
    background: #00732c;
    padding: 8px;
    font-size: 1rem;
    color: #fff;
    border-radius: 2px;
    animation: fadeIn 0.6s;
}

/* optional styling to add a "wedge" to the tooltip */
p#tooltip-text:before {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -8px;
  border: 8px solid transparent;
  border-top: 8px solid #00732c;
}

@keyframes fadeIn {
 from {
   opacity: 0;
 }
 to {
   opacity: 1;
 }
}

</style>


<span data-toggle="tootip" title ="툴팁 나오닝~~" > </span>



<div id="commonPopup">
	<div class="popup_area">
		<div class="popup_table" id="employeeStatusListContainer">
		</div>
	</div>
	<div class="popup_bottom_btn">
		<button class="close_btn" onclick="modalStack.close();">닫기</button>
	</div>
</div>
<script type="text/javascript">
  
	$(document).ready(function() {
		createCheckBox();
		
		
		 $('[data-toggle="tooltip"]').tooltip();   
		
	});
	

	function createCheckBox() {

		$('#employeeStatusListContainer').empty();
		var param = {};
		postAjaxSync("/admin/cm/cm06/selectEmployeeStatusList", param , null,  function(data){
			var codeList = data.result;
			var container = $('#employeeStatusListContainer');
			var lastDept = ''; //부서 변경 체크용
			const table = $('<table>').appendTo('#employeeStatusListContainer')
			var tableRow = '';
			var tdCount = 0;
			var tdColunCount = 4; //한줄에 들어가 사람 숫자임
			$.each(codeList, function (index, item){
				if (lastDept != item.dept) {
					if (tdCount != 0 || tdCount != tdColunCount) {
						for (let i = tdCount; i < tdColunCount; i++) {
							const tdElement  = $('<td>').appendTo(tableRow);
						}
					}
					
					tableRow = $('<tr>').css('color', 'gray').addClass('empTR').appendTo(table);
					var trElement = $('<tr>');
					const rowCnt = Math.ceil(item.cnt / tdColunCount) // 양의 정부만 추출 ex) 4/3 = 2
					$('<th>').attr('rowspan', rowCnt).css('width', '11%').text(item.deptNm).appendTo(tableRow);
					lastDept = item.dept;
					tdCount = 0;
				} else {
// 					tableRow = $('<tr>').appendTo(table);
// 					var trElement = $('<tr>');
				}
				if (tdCount == tdColunCount) {
					tableRow = $('<tr>').css('color', 'gray').addClass('empTR').appendTo(table);
					var trElement = $('<tr>');
					tdCount = 0;
				}
				var workHoly = '';
				var textColor = 'rgb(2 141 113)';  //기본 컬러
				var userName =  item.name + " " + item.levelNm.replace(/\s+/g, '');
				var txtTitle = userName + '님은 정상 근무중입니다.';
				if (item.workRptRmk == undefined) item.workRptRmk='';
				if (item.workHolyNm != undefined){	//사고자 컬러
					workHoly = '(' + item.workHolyNm + ')';
					textColor = 'rgb(129 129 130)';
					txtTitle = userName + '님은 ' + item.workHolyNm + '중입니다.\n' + item.workRptRmk;
				}
				userName = '<div id="stsName" style="color:' + textColor + '"<a title="' +  txtTitle + '">' + userName + workHoly+ '</a>';
				const iHtml = 
						userName  + '\n' +
						'</div><i class="fa fa-list-ol"></i><i class="fa ' + setStatus(item.scdLoad) + '"></i>\n' +
						'<i class="fa fa-industry"></i><i class="fa ' + setStatus(item.qcLoad) + '"></i>\n' +
						'<i class="fa fa-cogs"></i><i class="fa ' + setStatus(item.jobLoad) + '"></i>\n' +
						'<i class="fa fa-people-carry"></i><i class="fa ' + setStatus(item.commLoad) + '"></i>\n' 
				const tdElement  = $('<td>').appendTo(tableRow);
				tdElement.append(iHtml);
				tdCount += 1;

			});

			if (tdCount != 0 || tdCount != tdColunCount) {
				for (let i = tdCount; i < tdColunCount; i++) {
					const tdElement  = $('<td>').appendTo(tableRow);
				}
			}
		})	
	}

	function setStatus(set) {
		return (set == "COMM3") ? "emp_red" : (set == "COMM2") ? "emp_orange" : "emp_blue";
	}
	
</script>
