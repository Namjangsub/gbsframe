<div class="popup_area of_a" style="width: 100%; height: 100%;">
    <div class="tit_contents">
      <h4 class="tit">물류진행요청 View</h4>
    </div>

 <div class="form-group popup_table">
  <form id="popForm" onSubmit="return false;">
		<input type="hidden" id="userId"     	name="userId">
		<input type="hidden" id="pgmId"     	name="pgmId"	value="CR1001M01">
		<input type="hidden" id="fileTrgtKey"  	name="fileTrgtKey">

		<input type="hidden" id="ordrsClntCd"  	name="ordrsClntCd">
 		<table>

        <colgroup>
          <col width="11%">
          <col width="14%">
          <col width="11%">
          <col width="14%">
          <col width="11%">
          <col width="14%">
          <col width="11%">
          <col width="14%">
        </colgroup>

        <tr>
			<th>회사</th>
			<td>
				<select id="coCd" name="coCd" data-kind="CO" msg="회사" class="form-control" readonly="readonly">
				</select>
			</td>
			<th>수주번호</th>
			<td>
				<input type="text" id="ordrsNo" name="ordrsNo" msg="수주번호" class="form-control" readonly="readonly">
			</td>
			<th>고객사</th>
			<td>
				<input type="text" id="ordrsClntNm" name="ordrsClntNm" msg="고객사" class="form-control" readonly="readonly">
			</td>
			<th>고객사PJT</th>
			<td>
				<input type="text" id="clntPjt" name="clntPjt" msg="고객사PJT" class="form-control" readonly="readonly">
			</td>
        </tr>

        <tr>
			<th>요청자</th>
			<td>
	             <input type="hidden" id="reqId" name="reqId" msg="요청자">
	             <input type="text" id="reqIdNm" name="reqIdNm" msg="요청자" class="form-control">
			</td>
			<th>PART NO</th>
			<td>
				<input type="text" id="partNo" name="partNo" msg="PART NO">
			</td>
			<th>발행일자</th>
			<td>
				<input id="pblicteDt" name="pblicteDt" msg="발행일자" date>
			</td>
			<th>요구일정일자</th>
			<td>
				<input id="reqFxDt" name="reqFxDt" msg="요구일정일자" date>
			</td>
        </tr>

        <tr>
			<th>Sales Code</th>
			<td colspan="7" valign="top">
				<div style="width: 100%; height: 240px;margin-left:5px;">
					<div class="add_btn pdl10" style="width: 100%;">
					</div>
	                <div data-ax5grid="salescd-grid" data-ax5grid-config="{}" style="height:230px; width: 99%;">
	                </div>
				</div>
			</td>
        </tr>

        <tr>
			<th>운송구분</th>
			<td>
				<select id="trnsDiv" name="trnsDiv" data-kind="LGISTDIV03" onchange="trnsDivChange(this.value)" msg="운송구분" class="form-control">
				   <option value="">선택</option>
				</select>
			</td>
			<th>분류구분</th>
			<td>
				<select id="clasDiv" name="clasDiv" data-kind="LGISTDIV01" msg="분류구분" class="form-control">
				   <option value="">선택</option>
				</select>
			</td>
 			<th></th>
			<th></th>
			<th></th>
			<th></th>
        </tr>

        <tr id="dmsTran">
			<th class="dmsClass">국내운송지역</th>
			<td>
				<select id="dmsTrnsAreaDiv" name="dmsTrnsAreaDiv" data-kind="LGISTDIV0201" msg="국내운송지역" class="form-control">
				   <option value="">선택</option>
				</select>
			</td>
			<th class="dmsClass">국내발송조건</th>
			<td>
				<select id="dmsSendCndDiv" name="dmsSendCndDiv" data-kind="LGISTDIV0202" onchange="changeSetEtc(this.value,this.name)" msg="국내발송조건">
				   <option value="">선택</option>
				</select>
			</td>
			<td colspan="2">
				<input data-maxlength="300" type="text" id="dmsSendCndDivEtc" name="dmsSendCndDivEtc" msg="국내발송조건 -기타" readonly="readonly">
			</td>
			<th class="dmsClass">국내포장종류</th>
			<td>
				<select id="dmsPackKindDiv" name="dmsPackKindDiv" data-kind="LGISTDIV0203" msg="국내포장종류" class="form-control">
				   <option value="">선택</option>
				</select>
			</td>
        </tr>

        <tr id="ovsTran">
			<th class="ovsClass">해외운송지역</th>
			<td>
				<select id="ovsTrnsAreaDiv" name="ovsTrnsAreaDiv" data-kind="LGISTDIV0204" msg="해외운송지역" class="form-control">
				   <option value="">선택</option>
				</select>
			</td>
			<th class="ovsClass">해외발송조건</th>
			<td>
				<select id="ovsSendCndDiv" name="ovsSendCndDiv" data-kind="LGISTDIV0205" onchange="changeSetEtc(this.value,this.name)" msg="해외발송조건">
				   <option value="">선택</option>
				</select>
			</td>
			<td colspan="2">
				<input data-maxlength="300" type="text" id="ovsSendCndDivEtc" name="ovsSendCndDivEtc" msg="해외발송조건 -기타" readonly="readonly">
			</td>
			<th class="ovsClass">해외포장종류</th>
			<td>
				<select id="ovsPackKindDiv" name="ovsPackKindDiv" data-kind="LGISTDIV0206" msg="해외포장종류" class="form-control">
				   <option value="">선택</option>
				</select>
			</td>
        </tr>

        <tr>
			<th colspan="4" style="text-align:center;height:30px">출발지 정보</th>
			<th colspan="4" style="text-align:center;height:30px">도착지 정보</th>
        </tr>
        <tr>
			<th>출발 장소</th>
			<td colspan="3">
				<input data-maxlength="300" type="text" id="staPlace" name="staPlace" msg="출발 장소/업체명" class="form-control">
			</td>
			<th>도착 장소</th>
			<td colspan="3">
				<input data-maxlength="300" type="text" id="arvlPlace" name="arvlPlace" msg="도착 장소/업체명" class="form-control">
			</td>
        </tr>
        <tr>
			<th>출발 담당자</th>
			<td colspan="3">
	             <input type="hidden" id="staChrgId" name="staChrgId" msg="출발 담당자">
                 <input type="text" id="staChrgIdNm" name="staChrgIdNm" class="form-control" msg="출발 담당자">
			</td>
			<th>도착 담당자</th>
			<td colspan="3">
	             <input data-maxlength="300" type="text" id="arvlChrgCont" name="arvlChrgCont" msg="도착 담당자" class="form-control">
			</td>
        </tr>
        <tr>
			<th>출발주소</th>
			<td colspan="3">
				<textarea data-maxlength="300" rows="2" id="staAddr" name="staAddr" class="form-control" msg="출발주소"></textarea>
			</td>
			<th>도착주소</th>
			<td colspan="3">
	             <textarea data-maxlength="300" rows="2" id="arvlAddr" name="arvlAddr" class="form-control"  msg="도착주소"></textarea>
			</td>
        </tr>
        <tr>
			<th>품목내용</th>
			<td colspan="7">
				<textarea data-maxlength="300" rows="2" id="prdlstCont" name="prdlstCont" class="form-control"  msg="비고"></textarea>
			</td>
        </tr>
        <tr>
			<th>제품금액</th>
			<td>
				<input comma type="text" id="prdAmt" name="prdAmt" maxlength="12" class="form-control" msg="제품금액">
			</td>
			<th>가로사이즈</th>
			<td>
				<input data-positive type="text" id="widthSize" name="widthSize" maxlength="10" class="form-control" msg="가로사이즈"
				 style="float:left;width:80%;"><span style="float:right;width:20%;margin-top:3px;">mm</span>
			</td>
			<th>세로사이즈</th>
			<td>
				<input data-positive type="text" id="vrticlSize" name="vrticlSize" maxlength="10" class="form-control" msg="세로사이즈"
				 style="float:left;width:80%;"><span style="float:right;width:20%;margin-top:3px;">mm</span>
			</td>
			<th>높이사이즈</th>
			<td>
				<input data-positive type="text" id="heightSize" name="heightSize" maxlength="10" class="form-control" msg="높이사이즈"
				 style="float:left;width:80%;"><span style="float:right;width:20%;margin-top:3px;">mm</span>
			</td>
        </tr>
        <tr>
			<th>포장전무게</th>
			<td>
				<input data-positive type="text" id="frmlcBeforeWt" name="frmlcBeforeWt" maxlength="10" class="form-control" msg="포장전무게"
				style="float:left;width:80%;"><span style="float:right;width:20%;margin-top:3px;">kg</span>
			</td>
			<th>포장후무게</th>
			<td>
				<input data-positive type="text" id="frmlcAfterWt" name="frmlcAfterWt" maxlength="10" class="form-control" msg="포장후무게"
				style="float:left;width:80%;"><span style="float:right;width:20%;margin-top:3px;">kg</span>
			</td>
			<th>출하일정일</th>
			<td>
				<input id="shipmntDt" name="shipmntDt" msg="출하일정일" date>
			</td>
			<th>희망도착일</th>
			<td>
				<input id="hopeArvlDt" name="hopeArvlDt" msg="희망도착일" date>
			</td>
        </tr>

        <tr>
			<th>비고</th>
			<td colspan="7">
				<textarea data-maxlength="500" rows="3" id="lgistRmk" name="lgistRmk" class="form-control"  msg="비고"></textarea>
			</td>
        </tr>

      </table>

    </form>
	</div>

	<!-- 공통 파일 영역
	<div id="fileList_area"></div>
	 -->

</div>
    <!-- 하단 버튼
	<div class ="popup_bottom_btn">
		<button type="button" id="actionBtn" authChk>등록</button>
		<button type="button" class="close_btn"
			onclick="modalStack.close();">닫기</button>
	</div>
	 -->

<script type="text/javascript">
	var actionType = null;
	var fileTrgtKey = null;

	let loadData = {};

	var salescdGridView = {
			initView: function(){
				this.target = new ax5.ui.grid();
				this.target.setConfig({
			        showLineNumber: true,
					showRowSelector : false,
					multipleSelect : false,
					sortable : false,
		            target: $('[data-ax5grid="salescd-grid"]'),
		            header : {
		                align : "center",
		                selector : true
		            },
			        body: {
			        	  //mergeCells : ["coCd","salesCd", "dsgnNo", "upperCd","lowerCd","ordrgDiv10"],
			              onClick: function () {
				          },
				          onDBLClick: function () {
				          },
				          onDataChanged: function () {
				          },
			        },
			        columns : [
			        		 {key: "dtaChk",			label: " ", 			width: 30, 	styleClass: "grid-font-blue-bold"	,hidden:true}
				 	 	 	,{key: "coCd", 				label: "CO", 			width: 50,	align: "center",hidden:true}
							,{key: "salesCd", 			label: "Sales Code", 	width: 120,	align: "left"}
							,{key: "ordrsClntNm", 		label: "고객사", 			width: 120,		align: "left",hidden:true}
							,{key: "clntPjt", 			label: "고객사 PJT", 		width: 120,		align: "left",hidden:true}
							,{key: "ordrsDtlDiv20Nm", 	label: "신작구분", 		width: 80,		align: "center"}
							,{key: "prdtCdNm", 			label: "제품명", 			width: 200,		align: "left"}
							,{key: "itemDivNm", 		label: "아이템구분", 		width: 180,		align: "left"}
							,{key: "eqpNm", 			label: "설비명", 			width: 200,		align: "left"}
							,{key: "ordrsNo", 			label: "수주번호", 		width: 100,		align: "center",hidden:true}
			         	]
			    });
				return this;
			},

			setData: function(_page){
				var target = this.target;
				/*
				var formData = {
					"coCd" 		 : $("#coCd").val(),
					"ordrsNo" 	 : $("#ordrsNo").val(),
					"fileTrgtKey": $("#fileTrgtKey").val(),
				}
				*/

				var formData = getSearchParam("#popForm");
	    		postAjax("/user/cr/cr10/selectSelesCdViewList", formData, null, function(data) {
					var list = data.resultList;
					target.setData({
	            		list : list,
	            		page : {
	            			totalElements : list.length
	            		}
	       			});
	    	 	});
			}
		}


	$(document).ready(function() {
		setCommonSelect($(".popup_area select[data-kind]"));

		actionType = modalStack.last().paramObj.actionType;
		fileTrgtKey = modalStack.last().paramObj.fileTrgtKey;

		loadData = {
				"fileTrgtKey" : modalStack.last().paramObj.fileTrgtKey,
				"coCd" : modalStack.last().paramObj.coCd,
				"ordrsNo" : modalStack.last().paramObj.ordrsNo,
				"clntPjt" : modalStack.last().paramObj.clntPjt,
				"reqId" : modalStack.last().paramObj.reqId,
				"reqIdNm" : modalStack.last().paramObj.reqIdNm,
				"ordrsClntNm" : modalStack.last().paramObj.ordrsClntNm,
				"ordrsClntCd" : modalStack.last().paramObj.ordrsClntCd,
		};

		//loadFormData("#popForm", modalStack.last().paramObj);
		if(actionType == "C"){
			loadData.staPlace = modalStack.last().paramObj.staPlace; //출발장소를 기본 회사명으로.
		}
		loadFormData("#popForm", loadData);

		/**
		 * grid 초기화
		*/
		salescdGridView.initView().setData(0);

		selectLgistMastInfo();

	});

	function trnsDivChangeSetValue(){
		var trnsDiv_value = $("#trnsDiv").val();
		if(trnsDiv_value == "LGISTDIV0301"){
			$("select[name=ovsTrnsAreaDiv]").val("");
			$("select[name=ovsSendCndDiv]").val("");
			$("input[name=ovsSendCndDivEtc]").val("");
			$("select[name=ovsPackKindDiv]").val("");
		}
		else {
			$("select[name=dmsTrnsAreaDiv]").val("");
			$("select[name=dmsSendCndDiv]").val("");
			$("input[name=dmsSendCndDivEtc]").val("");
			$("select[name=dmsPackKindDiv]").val("");
		}
	}

	//운송구분이 바뀔때 값셋팅
	function trnsDivChange(_value) {
		if(_value == "LGISTDIV0301") { //국내
			$('#dmsTran').show();
			$('#ovsTran').hide();
		}
		else if(_value == "LGISTDIV0302") { //해외
			$('#dmsTran').hide();
			$('#ovsTran').show();
		}
		else {
			$('#dmsTran').hide();
			$('#ovsTran').hide();
			changeSetEtc("x","dmsSendCndDiv");
			changeSetEtc("x","ovsSendCndDiv");
		}
	}

	//기타입력
	function changeSetEtc(_value,_name){
		if(!isEmpty(_value) && _value.indexOf("99") != -1){//기타
		}
		else {//기타아닐때
			$("input[name="+_name+"Etc"+"]").val("");
		}
	}

	function selectLgistMastInfo() {						//그리드에 뿌리는 데이터
		var formData = {
			"fileTrgtKey" : fileTrgtKey,
		}
		postAjax("/user/cr/cr10/selectLgistMastInfo", formData, null, function(data) {
			loadFormData("#popForm", data.result, function(data){
				$('#trnsDiv').trigger('change');
				//발송조건구분기타 활성/비활성
				changeSetEtc(data.dmsSendCndDiv,"dmsSendCndDiv");
				changeSetEtc(data.ovsSendCndDiv,"ovsSendCndDiv");

				setDisabledInput("#popForm" , true);
			});
		});
	}

	function setDisabledInput(_form , _status){
		$.each($(_form+" input"), function (idx, elem) {
			$(elem).prop("readonly", _status);
		});
		$.each($(_form+" textarea"), function (idx, elem) {
			$(elem).prop("readonly", _status);
		});
		$.each($(_form+" select"), function (idx, elem) {
			$(elem).prop("readonly", _status);
			$(elem).prop("disabled", _status);
		});
	}

</script>