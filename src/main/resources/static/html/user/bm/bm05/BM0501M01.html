<!DOCTYPE html>
<html lang="ko">
<style>
	.add_btn_small{
	    display: inline-block;
	    padding: 0px;
	}
                
	.add_btn_small a {
	    display: inline-block;
	    width: 33px;
	    height: 20px;
	    line-height: 20px;
	    text-align: center;
	    color: #444;
	    background: #ffffff;
	    box-shadow: 1px 1px rgba(0,0,0,0.15);
	}
</style>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" href="/static/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
	<link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
	<link rel="stylesheet" href="/static/fontawesome/css/all.css">
	<link rel="stylesheet" href="/static/css/ax5/ax5grid.css">
	<link rel="stylesheet" href="/static/css/ax5/ax5mask.css">
	<link rel="stylesheet" href="/static/css/ax5/ax5modal.css">
	<link rel="stylesheet" href="/static/css/ax5/ax5toast.css">
	<link rel="stylesheet" href="/static/css/jstree/style.min.css">
	<link rel="stylesheet" href="/static/css/gnb.css">
	<link rel="stylesheet" href="/static/css/main.css">
	<link rel="stylesheet" href="/static/css/sub.css">
	<link rel="stylesheet" href="/static/css/common.css">
          
	<script src="/static/js/jquery-latest.min.js"></script>
	<script src="/static/js/jquery.serializeObject.js"></script>
	<script src="/static/bootstrap/js/bootstrap.min.js"></script>
	<script src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
	<script src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
	<script src="/static/js/moment/moment-with-locales.js"></script>
	<script src="/static/js/ax5/ax5core.min.js"></script>
	<script src="/static/js/ax5/ax5grid.min.js"></script>
	<script src="/static/js/ax5/ax5mask.min.js"></script>
	<script src="/static/js/ax5/ax5modal.min.js"></script>
	<script src="/static/js/ax5/ax5toast.min.js"></script>
	<script src="/static/js/jstree/jstree.min.js"></script>
	<script type="text/javascript" src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js" ></script>
	<script src="/static/js/global.js"></script>
</head>

<body>
	<div id="head_area"></div>
	<div id="top_area"></div>
	
	<div id="main_area">
		<!-- 페이지 상단 -->
		<div class="contents no_bg">
			<ul class="btn_ul">
				<li class="btn_r">
					 <a onclick="initSearch();">
					 <button class="bg_gray">초기화</button>
					 </a>
					 <a onclick="bmMstrGridView.setData(0);">
					 	<button class="bg_gray">검 색</button>
					 </a>
	            </li>
            </ul>
        </div>
		<!-- 검색 콘텐츠 -->
		<div class="contents search">
			<div class="">
				<!-- 테이블 인풋 3분할 -->
				<table class="table_input type04">
					<!-- 검색조건 1행 -->
<!-- 
 					<tr>
						<th class= "hit">회사</th>
						<td>
							<select  id="coCd_S" data-kind="CO" required="required" onchange="bmMstrGridView.setData(0);">
						      <option value="">전체</option>
							</select>
						</td>
						
						<th class= "hit">발생일자</th>
						<td>
							<div class="date_input">
								<input type="text" class="input_calendar" id="wbsPlansDt" data-search="wbsPlansDt"  "autocomplete="off" date>
								<span>~</span>
								<input type="text" class="input_calendar" id="wbsPlaneDt" data-search="wbsPlaneDt"  autocomplete="off" date>
							</div>
						</td>
						
						<th>&nbsp;</th>
						<td>&nbsp;</td>
						
						<th>고객사</th>
						<td>
							<input type="hidden" id="clntCd_S">
							<div class="search_form" style="width: 100%;">
								<input type="text" id="clntNm_S" onkeyup="if(event.keyCode != 13){resetClntCd()}; event.keyCode == 8 ? clntCd_S.value = '' : event.keyCode == 13 ? shipGridView.setData(0) : ''; ">
								<a onclick="openClntSearch();"><i class="i_search_w"></i></a>
							</div>
						</td>
					</tr>
 -->
					<!-- 검색조건 2행 -->                    
					<tr>
						<th class= "hit">회사</th>
						<td>
							<select  id="coCd_S" data-kind="CO" required="required" onchange="bmMstrGridView.setData(0);">
						      <option value="">전체</option>
							</select>
						</td>
						
						<th>품목구분</th>
			            <td>
							<select id="goodsDiv" data-kind="GOODSDIV" data-search="goodsDiv" onchange="getGrid();">
								<option value="">선택</option>
							</select>
						</td>
			
						<th>자재유형</th>
						<td>
							<select id="matrDiv" data-kind="MATRDIV" data-search="matrDiv" onkeyup="event.keyCode == 8 ? salesCd_S.value = '' : event.keyCode == 13 ? gridView.setData(0) : ''">
							   <option value="">선택</option>
							</select>
						</td>
						
						<th>자재그룹</th>
						<td>
							<select id="matrGrp" data-kind="MATRGRP">
								<option value="">선택</option>
							</select>
						</td>
			        </tr>
			
		            <!-- 검색조건 3행 -->   
					<tr>
						<th>품번</th>
						<td>
							<div class="search_form"  style="width: 100%;">
								<input type="text" id="matrNo" required="required">
								<a onclick="wbsPlanNoSearch();"><i class="i_search_w"></i></a>
							</div>
						</td>
					 
						<th>품명</th>
						<td>
						    <input type="text" class="matrNm" id="matrNm" data-search="matrNm" onkeyup="if(event.keyCode == 13){bmMstrGridView.setData(0)};">
						</td>
					 
						<th>형번</th>
						<td>
							<input type="text" class="matrMno" id="matrMno" data-search="matrMno">
						</td>        
					
						<th>규격</th>
						<td>
							<input type="text" class="matrSpec" id="matrSpec" data-search="matrSpec">
						</td>  
					</tr>
						      
		            <!-- 검색조건 END -->
	            </table>
            </div>
        </div>
        <!-- // 콘텐츠 -->

		<!-- 콘텐츠 -->
		<div class="contents no_bg">
		<!-- 콘텐츠 타이틀 -->
		<div class="contents_tit">
			<span  style="height: 30px; line-height: 30px;font-size: 15px;"> </span>
			<div class="add_btn_small pdl10">
<!-- 				<a onclick="insertWBSModal();" style="height: 30px; line-height: 28px;" authchk>+</a> -->
				<a onclick="" data-grid-control="row-add" style="height: 30px; line-height: 28px;"authchk>+</a>
				<a onclick="" data-grid-control="row-remove" style="height: 30px; line-height: 28px;" authchk>-</a>
				<a onclick="excelDown();" style="height: 30px; line-height: 28px; width: 90px;"><i class="fas fa-file-excel"></i> 엑셀다운로드</a>
			    </div>
				<select id="recordCnt" class="prae_select" data-search="recordCnt" onchange="changeRecordCnt();">
					<option value="10">10</option>
					<option value="20" selected>20</option>
					<option value="50">50</option>
					<option value="100">100</option>
					<option value="9999999"  >전체</option>
		        </select>
			</div>
		</div>

		<!-- 콘텐츠 -->
		<div class="contents">
			<table>
				<!-- 1행 -->
				<tr>
					<td>
					<!-- 그리드의 행추가 -->
						<div class="ax5_grid" data-ax5grid="first-grid" data-ax5grid-config="{}" style="height: 650px; width: 100%" ></div>
						<button id="btn1" onclick="gridAddRow();">+</button>
						<button class="btn btn-default" data-grid-control="row-add">row add</button>
						<button class="btn btn-default" data-grid-control="row-remove" onclick="gridAddRow();">row remove</button>
    					<button class="btn btn-default" data-grid-control="row-update" onclick="gridAddRow();">row update</button>
					</td>
					<td>
						<form id="BmMstrForm">
							<table style="height: 650px; width: 100%;" class="table_input type03">
								<thead></thead>
								<tbody>
									<tr>
										<th class="hit">회사</th>
										<td>
											<select id="coCd_S1" name="coCd_S1" data-kind="CO" onchange="prdtStknChange(this);">
												<option value="">선택</option>
											</select>
										</td>	
									</tr>
									<tr>
										<th class="hit">품번</th>
										<td>
											<div>
												<input type="text" id="matrNo1" name="matrNo1" data-kind="matrNo">
											</div>
										</td>
										<th class="hit">품명</th>
										<td>
											<div>
												<input type="text" id="matrNm1" name="matrNm1" data-kind="matrNm">
											</div>
										</td>
									</tr>
									<tr>
										<th class="hit">품목구분</th>
										<td>
											<div>
												<select id="goodsDiv1" name="goodsDiv1" data-kind="GOODSDIV" required="required">
													<option value="" selected>선택</option>
												</select>
											</div>
										</td>
										<th class="hit">거래처분류</th>
										<td>	
											<div>
												<select id="matrClntDiv" name="matrClntDiv" data-kind="MATRCLNTDIV" required="required">
													<option value="">선택</option>
												</select>
											</div>
										</td>
									</tr>
									<tr>
										<th>자재유형</th>
										<td>
											<div>
												<select id="matrDiv1"  name="matrDiv1" data-kind="MATRDIV" required="required">
													<option value="">선택</option>
												</select>
											</div>
										</td>
										<th>자재그룹</th>
										<td>
											<div>
												<select id="matrGrp1" name="matrGrp1" data-kind="MATRGRP" required="required">
													<option value="">선택</option>
												</select>
											</div>
										</td>
									</tr>
									<tr>
										<th>소재</th>
										<td>
											<div>
												<input type="text" id="matrMat1" name="matrMat1" data-kind="" value="">
											</div>
										</td>
										<th>사이즈</th>
										<td>
											<div>
												<input type="text" id="matrSize1" name="matrSize1" data-kind="" value="">
											</div>
										</td>
									</tr>
									<tr>
										<th>규격</th>
										<td>
											<div>
												<input type="text" id="matrSpec1" name="matrSpec1" data-kind="" value="">
											</div>
										</td>
										<td colspan="2">
											<div>
												<button>∅</button>
												<button>X</button>
												<button>T</button>
												<button>/</button>
												<button>-</button>
											</div>
										</td>
									</tr>
									<tr>
										<th>Maker</th>
										<td>
											<div>
												<input type="text" id="matrMakrNm1" name="matrMakrNm1" data-kind="" value="">
											</div>
										</td>
										<th>형번</th>
										<td>
											<div>
												<input type="text" id="matrMno1" name="matrMno1" data-kind="" value="">
											</div>
										</td>
									</tr>
									<tr>
										<th>중량</th>
										<td>
											<div>
												<input type="text" id="matrWt" name="matrWt" data-kind="" value="">
											</div>
										</td>
										<th>관리단위</th>
										<td>
											<div>
												<select id="matrUnit1" name="matrUnit1" data-kind="UNITDIV" required="required">
													<option value="">선택</option>
												</select>
											</div>
										</td>
									</tr>
									<tr>
										<th>원산지</th>
										<td>
											<div>
												<input type="text" id="originNm" name="originNm" value="" data-kind="">
											</div>
										</td>
										<th>대표도번</th>
										<td>
											<div>
												<input type="text" id="matrDrwNo" name="matrDrwNo" value="" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>입고검사구분</th>
										<td>
											<div>
												<select id="matrTestDiv1" name="matrTestDiv1" data-kind="MATRTESTDIV" required="required">
													<option value="">선택</option>
												</select>
											</div>
										</td>
										<th>리드타임</th>
										<td>
											<div>
												<input type="text" id="dlvrRqmDay" name="dlvrRqmDay" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>구매/외주</th>
										<td>
											<div>
												<select id="matrPurcDivNm" name="matrPurcDivNm" data-kind="MATRPURCDIV" required="required">
													<option value="">선택</option>
												</select>
											</div>
										</td>
										<th>최소발주량</th>
										<td>
											<div>
												<input type="text" id="minOrdrgQty1" name="minOrdrgQty1" value="" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>안전재고</th>
										<td>
											<div>
												<input type="text" id="matrSaftQty1" name="matrSaftQty1" value="" data-kind="">
											</div>
										</td>
										<th>재고관리여부</th>
										<td>
											<div>
												<select id="matrStockCd" name="matrStockCd" data-kind="MATRSTOCKCD" data-search="matrStockCd" value="" required="required">
													<option value="">선택</option>
													<option value="Y">Y</option>
													<option value="N">N</option>
												</select>
											</div>
										</td>
									</tr>
									<tr>
										<th>2D설계소요일</th>
										<td>
											<div>
												<input type="text" id="dsgn2dMd" name="dsgn2dMd" value="" data-kind="">
											</div>
										</td>
										<th>3D설계소요일</th>
										<td>
											<div>
												<input type="text" id="dsgn3dMd" name="dsgn3dMd" value="" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>2D평균소요일</th>
										<td>
											<div>
												<input type="text" id="avrg2dMd" name="avrg2dMd" value="" data-kind="">
											</div>
										</td>
										<th>3D평균소요일</th>
										<td>
											<div>
												<input type="text" id="avrg3dMd" name="avrg3dMd" value="" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>최종생산소요일</th>
										<td>
											<div>
												<input type="text" id="prdctnRqmMd" name="prdctnRqmMd" value="" data-kind="">
											</div>
										</td>
										<th>평균생산소요일</th>
										<td>
											<div>
												<input type="text" id="prdctnAvrgMd" name="prdctnAvrgMd" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>구매업체1</th>
										<td>
											<div class="search_form" style="width: 100%;">
												<input type="text" id="pchsClntCd1" name="pchsClntCd1" data-kind="CLNTDIV" required="required"> 
												<a onclick="clntSearch();">
												<i class="i_search_w"></i>
												</a>
											</div>
										</td>
										<th>발주비율1</th>
										<td>
											<div>
												<input type="text" id="pchsClntPct1" name="pchsClntPct1" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>구매업체2</th>
										<td>
											<div class="search_form" style="width: 100%;">
												<input type="text" id="pchsClntCd2" name="pchsClntCd2" data-kind="clntCd" required="required">
												 <a onclick="clntSearch();">
												 <i class="i_search_w"></i>
												 </a>
											</div>
										</td>
										<th>발주비율2</th>
										<td>
											<div>
												<input type="text" id="pchsClntPct2" name="pchsClntPct2" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>구매업체3</th>
										<td>
											<div class="search_form" style="width: 100%;">
												<input type="text" id="pchsClntCd3" name="pchsClntCd3" data-kind="CLNTDIV" required="required" >
												 <a	onclick="clntSearch();">
												 <i class="i_search_w"></i>
												 </a>
											</div>
										</td>
										<th>발주비율3</th>
										<td>
											<div>
												<input type="text" id="pchsClntPct3" name="pchsClntPct3" data-kind="">
											</div>
										</td>
									</tr>
									<tr>
										<th>최종구매단가</th>
										<td>
											<input type="text" id="matrUpr" name="matrUpr" readonly="readonly" data-kind="">
										</td>
										<th>평균구매단가</th>
										<td>
											<input type="text" id="matrAvrgUpr" name="matrAvrgUpr" readonly="readonly" data-kind="">
										</td>
									</tr>
									<tr>
										<th>최종거래일자</th>
										<td>
											<input type="text" id="matrLastTrstDt" name="matrLastTrstDt" readonly="readonly" data-kind="">
										</td>
										<th>설계대상구분</th>
										<td>
											<input type="text" id="dsgnTrgtYn" name="dsgnTrgtYn" data-kind="">
										</td>
									</tr>
								</tbody>
							</table>
							<div>
								<button>등록</button>
								<button>닫기</button>
							<!-- 	<button type="button" class="btn btn-default btn-sm" id="actionBtn" authchk>등록</button>
								<button type="button" class="btn btn-default btn-sm" onclick="modalStack.close();">닫기</button> -->
							</div>
						</form>
					</td>
				</tr>
			</table>
			<div data-ax5grid="excel-grid" data-ax5grid-config="{}" style="display: none;"></div>
		</div>
		
		<div class="contents">
			<table class="popup_table" style="height:80px;">
				<colgroup>
	           		<col width="30%">
	                <col width="70%">
	           	</colgroup>
	           	<tr style="height:100px;vertical-align:top;">
	               	<td style="border:0px;vertical-align:top;">
	                    <table>
	                    <tr>
	                    <td style="text-align: LEFT;height:20px;border:0px;">*파일폴더</td>
	                    </tr>
	                    <tr>
	                    <td style="height:100px;vertical-align:top;border:0px;" colspan="2"><!-- 파일 리스트 트리 추가 --></td>
	                    </tr>
	                    <tr>
	                    	<th colspan="2">목록</th>
	                    </tr>
	                    <tr>
	                    	<td>영업</td>
	                    	<td></td>
	                    </tr>
	                    <tr>
	                    	<td></td>
	                    	<td>사업계획</td>
	                    </tr>
	                    <tr>
	                    	<td></td>
	                    	<td>사전영업</td>
	                    </tr>
	                    <tr>
	                    	<td></td>
	                    	<td>견적</td>
	                    </tr>
	                    </table>
	               </td>
	               <td style="border:0px;vertical-align:top;">
	                    <table>
	                    <tr>
	                    <td style="text-align: LEFT;height:20px;border:0px;">*첨부파일</td>
	                    </tr>
	                    <tr>
	                    <td style="height:100px;vertical-align:top;border:0px;"><!-- 첨부파일 리스트 그리드 추가 --></td>
	                    </tr>
	                    </table>
	               </td>
	           </tr>
	      </table>
		</div>
    </div>
                    
</body>
</html>

<script type="text/javascript">
	//debugger;
    //var openFrom = null;
    var bmMstrGridView = {
    	initView: function(){
			this.target = new ax5.ui.grid();
			this.target.setConfig({
				// 체크박스
				showRowSelector: true,
				multipleSelect: false,
				sortable: true,
				target: $('[data-ax5grid="first-grid"]'),
				header: {
	              align: "center",
	              selector: false
	            },
	            body: {
					onClick: function () {
					    this.self.select(this.dindex);
					    var row = this.dindex;
                        var paramObj = {"row":row};
                        // 그리드값 가져오기 호출
                        getGrid();
					},
					onDBLClick: function () {
						this.self.clearSelect();
                        this.self.select(this.dindex);
						// updateWBSModal(1);
						/* var cKey = this.column.key;
                        if(cKey == "lvl1"){
                        	var paramObj = {
                                    "actionType": "C",
                                    "coCd": $('#coCd_S').val()
                            };
                        	openModal("/static/html/user/wb/wb01/WB0101P01.html", 1300, 780, "", paramObj);   */
                        //}  
					    //this.self.clearSelect();
					    //this.self.select(this.dindex);
					    /* Grid에서 lvl1, 2, 3 클릭 시 일정 계획 등록 팝업 창 실행 */
                        /* if (this.column.key == "lvl1"){
                            updateWBSModal(1);
                        }
                        else if (this.column.key == "lvl2"){
                            updateWBSModal(2);
                        }
                        else if (this.column.key == "lvl3"){
                            updateWBSModal(3);
                        } */
                        /* 일정계획등록 팝업창 END */
					},
			   },
	           page: {
					navigationItemCount: 9,
					height: 30,
					display: true,
					firstIcon: '<i class="fa fa-step-backward" aria-hidden="true"></i>',
					prevIcon: '<i class="fa fa-caret-left" aria-hidden="true"></i>',
					nextIcon: '<i class="fa fa-caret-right" aria-hidden="true"></i>',
					lastIcon: '<i class="fa fa-step-forward" aria-hidden="true"></i>',
					onChange: function () {
						bmMstrGridView.setData(this.page.selectPage); 
					}
	           },
	           columns: [
	        	   {key: "coCd", 		label: "회사",		hidden: true},
	        	   {key: "rn",      label: "No.",          align: "center",   width: 60},
	               {key: "matrNo",      label: "품번",	align: "center",   width: 130},
	               {key: "matrNm",      label: "품명",      align: "center",   width: 130},
	               {key: "goodsDivNm",      label: "품목구분",      align: "center",   width: 130},
	               {key: "matrClntDivNm",      label: "거래처분류",	hidden: true},
	               {key: "matrPurcDivNm",      label: "구매외주구분",	hidden: true},
	               {key: "matrDivNm",      label: "자재유형",      align: "center",   width: 130},
	               {key: "matrGrpNm",      label: "자재그룹",      align: "center",   width: 100},
	               {key: "matrStockCd",      label: "재고관리여부",      align: "center",   width: 100},
	               {key: "rn",      label: "No.",      align: "center",   width: 130},
	               {key: "matrMat",      label: "재질",      align: "left",   width: 130},
	               {key: "matrMakrNm",      label: "Maker",      align: "left",   width: 130},
	               {key: "matrMno",      label: "형번",      align: "left",   width: 200},
	               {key: "matrSpec",      label: "규격",      align: "left",   width: 100},
	               {key: "matrGrpNm",      label: "자재그룹",      align: "left",   width: 100},
	               {key: "matrTestDivNm",      label: "입고검사구분",   align: "center",   width: 100}, 
	               {key: "matrUnitNm",      label: "관리단위",      align: "left",   width: 100},
	               {key: "dlvrRqmDay",      label: "리드타임",      align: "right",   width: 100},
	               {key: "minOrdrgQty",      label: "최소발주량",      align: "right",   width: 120},
	               {key: "matrSaftQty",      label: "안전재고",      align: "right",   width: 120},
	               {key: "creatDttm",      label: "등록일시",      align: "left",   width: 120},
	               {key: "creatId",      label: "등록자",		align: "center",   width: 100},
	               {key: "udtDttm",      label: "수정일시",      align: "center",   width: 120},
	               {key: "udtId",      label: "수정자",	align: "center",   width: 100}
	              ]
	        });
	        return this;
		
	      },
          setData: function(_pageNo) {
        	    var targetObj = this.target;
        	    var formData = {
        	    		// 조회조건 수정하기
        	               "coCd" : $("#coCd_S").val(),
        	               "pageNo" : _pageNo + 1, 
        	               "recordCnt" : $("#recordCnt").val(),
          
        	           }
        	    // 여기를 바꿔야함 "/user/bm/bm02/selectBmMstrList"
                postAjax("/user/bm/bm05/selectBmMstrList", formData, null, function(data){
                    var list = data.resultList;
                   
/* 	박부장님 230519  */
//                     bmMstrGridView.initView().setData(0);	
//                     bmMstrGridView.target.select(0);
//                     var row = bmMstrGridView.getList("selected"); // Object
					targetObj.setData({
					    list : list,
					    page : {
		                    currentPage : _pageNo,
		                    pageSize : data.paginationInfo.pageSize,
		                    totalElements : data.paginationInfo.totalRecordCount,
		                    totalPages : data.paginationInfo.totalPageCount
					    } 
					});
					setBmMstr(list);
                });
        	    // this.target.select(0);
        	    
           } 
     }

     var excelView = {
		initView: function(){
		this.target = new ax5.ui.grid();
		this.target.setConfig({
		target: $('[data-ax5grid="excel-grid"]'),
		columns: [
			 {key: "coCd", 		label: "회사",		hidden: true},
       	  	 {key: "rn",      label: "No.",          align: "center",   width: 60},
             {key: "matrNo",      label: "품번",	align: "center",   width: 130},
             {key: "matrNm",      label: "품명",      align: "center",   width: 130},
             {key: "goodsDivNm",      label: "품목구분",      align: "center",   width: 130},
             {key: "matrClntDivNm",      label: "거래처분류",	hidden: true},
             {key: "matrPurcDivNm",      label: "구매외주구분",	hidden: true},
             {key: "matrDivNm",      label: "자재유형",      align: "center",   width: 130},
             {key: "matrGrpNm",      label: "자재그룹",      align: "center",   width: 100},
             {key: "rn",      label: "No.",      align: "center",   width: 130},
             {key: "matrMat",      label: "재질",      align: "left",   width: 130},
             {key: "matrMakrNm",      label: "Maker",      align: "left",   width: 130},
             {key: "matrMno",      label: "형번",      align: "left",   width: 200},
             {key: "matrSpec",      label: "규격",      align: "left",   width: 100},
             {key: "matrGrp",      label: "자재그룹",      align: "left",   width: 100},
             {key: "matrTestDivNm",      label: "입고검사구분",   align: "center",   width: 100}, 
             {key: "matrUnitNm",      label: "관리단위",      align: "left",   width: 100},
             {key: "",      label: "리드타임",      align: "right",   width: 100},
             {key: "minOrdrgQty",      label: "최소발주량",      align: "right",   width: 120},
             {key: "matrSaftQty",      label: "안전재고",      align: "right",   width: 120},
             {key: "creatDttm",      label: "등록일시",      align: "left",   width: 120},
             {key: "creatId",      label: "등록자",		align: "center",   width: 100},
             {key: "udtDttm",      label: "수정일시",      align: "center",   width: 120},
             {key: "udtId",      label: "수정자",	align: "center",   width: 100}
           ]
		});
	    return this;
      }
    }
    
    // 그리드 추가, 삭제
    $('[data-grid-control]').click(function () {
        switch (this.getAttribute("data-grid-control")) {
            case "row-add":
            	bmMstrGridView.target.addRow($.extend({}, bmMstrGridView.target.list.length, {__index: undefined}));
                break;
            case "row-remove":
            	bmMstrGridView.target.removeRow();
                break;
        }
    });
     
    function initSearch() {
        // datepicker를 제외한 select, input 값 모두 초기화
        $(".contents.search select").val("");
        $(".contents.search input[type='text']:not(.input_calendar)").val("");
        
        // 회사 초기화
        $("#coCd_S").val(jwt.coCd);
        
        // 날짜 초기화
        $('#wbsPlansDt').datepicker("setDate", moment(new Date()).startOf("month").toDate());
        $('#wbsPlaneDt').datepicker("setDate", moment(new Date()).endOf("month").toDate());
        
        // 상세정보 초기화
//         $(".contents select").val("");
//         $(".contents select input[type='text']").val("");
        
		$.each($('#main_area [data-kind]'), function(idx, elem) {
            // 상세정보 초기화
			$(elem).val("");
        });
		 
		// 재검색
		bmMstrGridView.setData(0);
	}

	// 페이지 로드
	$(document).ready(function() {
		mainDefaultLoad("WBS", "자재마스터관리");
		setCommonSelect($("#main_area select[data-kind]"));

		// 접속자 회사 set
		$("#coCd_S").val(jwt.coCd);
		$("#coCd_S1").val(jwt.coCd);
		/* 		
		 // 시작일 (현재날짜의 월 첫일)
		 $('#wbsPlansDt').datepicker({
		 format : "yyyy-mm-dd",
		 language : "ko",
		 autoclose : true
		 })
		 .datepicker("setDate", moment(new Date()).startOf("month").toDate())
		 .on("changeDate", function(){
		 if($('#wbsPlansDt').val() > $('#wbsPlaneDt').val()){
		 alert("날짜를 확인해주세요");
		 $('#wbsPlansDt').datepicker("setDate", new Date($('#wbsPlaneDt').val()));
		 }
		 });
		
		 // 종료일 (현재날짜의 월 말일)
		 $('#wbsPlaneDt').datepicker({
		 format : "yyyy-mm-dd",
		 language : "ko",
		 autoclose : true
		 })
		 .datepicker("setDate", moment(new Date()).endOf("month").toDate())
		 .on("changeDate", function(){
		 if($('#wbsPlansDt').val() > $('#wbsPlaneDt').val()){
		 alert("날짜를 확인해주세요");
		 $('#wbsPlaneDt').datepicker("setDate", new Date($('#wbsPlansDt').val()));
		 }
		 }); 
		 */
		// 페이지 가져오기
		//debugger;
		bmMstrGridView.initView().setData(0);
		bmMstrGridView.target.select(0);
		console.log();
		var row = bmMstrGridView.target.getList()[0]; // Object
		//  alert(row);
		excelView.initView();
		// 그리드값 가져오기 호출
		getGrid();

	})

	/* 	 
	 // 그리드 값 가져오기
	 function getGrid() {
	 var row = grid.target.getList("selected")[0];
	 "goodsDiv" : $("#goodsDiv").val(row.goodsDiv);
	 "matrDiv" : $("#matrDiv").val(row.matrDiv);
	 "matrGrp" : $("#matrGrp").val(row.matrGrp);
	
	 } */

	// 거래처 검색
	function openClntSearch() {
		openModal("/static/html/cmn/modal/clntSearch.html", 600, 420, "거래처 검색",
				{}, function(grid) {
					var row = grid.target.getList("selected")[0];
					$('#clntCd_S').val(row.clntCd);
					$('#clntNm_S').val(row.clntNm);
				});
	}

	//사용자 검색
	function openUserTree2() {
		var paramObj = {
			"coCd" : "GUN", // $('#coCd').val(),
			"userId" : $('#salesMng_S').val(),
			"useYn" : "Y"
		};
		openSecondModal("/static/html/cmn/modal/userSearch.html", 300, 500,
				"사용자 검색", paramObj, function(tree) {
					var checkedId = tree.get_checked()[0];
					var checkedNode = tree.get_node(checkedId);
					$('#salesMngId').val(checkedNode.id);
					$('#salesMngNm').val(checkedNode.text);
					$("#deptNm").val(checkedNode.original.deptNm);
					$("#deptId").val(checkedNode.parent);
				});
	}

	//관리번호 (WbsPlanNo) 검색
	function wbsPlanNoSearch() {
		var paramObj = {
			"coCd" : $('#coCd_S').val(),
			"salesCd" : $('#salesCd_S').val()
		};
		openSecondModal("/static/html/cmn/modal/wbsPlanNoSearch.html", 450,
				270, "관리번호 검색", paramObj, function(grid) {
					var row = grid.target.getList("selected")[0];
					$('#wbsPlanNo').val(row.wbsPlanNo);

				});
	}

	//Sales Code (수주마스터, 수주상세테이블 조인) 검색
	function wbsSalesCodeSearch() {
		var paramObj = {
			"coCd" : $('#coCd_S').val(),
			"salesCd" : $('#salesCd_S').val()
		};
		openSecondModal("/static/html/cmn/modal/wbsSalesCodeSearch.html", 1000,
				330, "SALES CODE 검색", paramObj, function(grid) {
					var row = grid.target.getList("selected")[0];
					$('#salesCd').val(row.salesCd);
					$('#wbsClntPjt').val(row.clntPjt);
					$('#eqp_nm').val(row.eqNm);
				});
	}

	function excelDown() {
		var formData = {
			"coCd" : $("#coCd_S").val(),
			"pageNo" : 1,
			"recordCnt" : 99999999
		}
		postAjax("/user/wb/wb01/selectWbsPlanList", formData, null, function(
				data) {
			var list = data.resultList;
			excelView.target.setData({
				list : list,
				page : {
					totalElements : list.length,
				}
			});
			var todayDate = new Date().format('yyyyMMddHHmmss');
			excelView.target.exportExcel("자재마스터관리_" + todayDate + ".xls");
		});
	}

	function updateWBSModal(idx) {
		var paramObj = {
			"actionType" : "C",
			"coCd" : $('#coCd_S').val()
		};
		if (idx == 1) {
			openModal("/static/html/user/wb/wb01/WB0101P01.html", 1300, 780,
					"", paramObj);
		} else if (idx == 2) {
			openModal("/static/html/user/wb/wb01/WB0101P02.html", 1300, 780,
					"", paramObj);
		} else if (idx == 3) {
			openModal("/static/html/user/wb/wb01/WB0101P03.html", 1300, 780,
					"", paramObj);
		}
	}

	function insertWBSModal() {
		var paramObj = {
			"actionType" : "C",
			"coCd" : $('#coCd_S').val()
		};
		openModal("/static/html/user/wb/wb01/WB0101P03.html", 1300, 780, "",
				paramObj);
	}

	function deleteWbs() {
		var paramObj = {
			"actionType" : "C",
			"coCd" : $('#coCd_S').val()
		};
		openModal("/static/html/user/wb/wb01/WB0101P08.html", 1300, 780, "",
				paramObj);
		var row = wbsGridView.target.getList("selected")[0];
		var formData = {
			"shipSeq" : row.shipSeq,
			"reqDt" : row.reqDt.replace(/\-/g, '')
		}
		postAjax("/user/ar/ar01/selectConfirmCount", formData, null, function(
				data) {
			if (data.result == 0) {
				if (confirm("삭제하시겠습니까?")) {
					deleteAjax("/user/ar/ar01/deleteShip", formData, null,
							function(data) {
								if (data.resultCode == 200) {
									alert(data.resultMessage);
									shipGridView.setData(0);
								}
							});
				}
			} else {
				alert("삭제할 수 없는 데이터 입니다.");
			}
		});
	}

	function changeRecordCnt() {
		//alert($("#recordCnt").val());
		//wbsGridView.initView();
		bmMstrGridView.setData(0);
	}

	// Grid값 가져오기
	function getGrid() {
		// debugger;
		// ready 시 바로 조회되게 바꿔보기 -> 230515 보류 중 
		// bmMstrGridView.SelectRow(row, true);
		// var row = bmMstrGridView.target.getList(); //전체 행 -> 배열 Object
		// 첫번째 행을 가져온다.
		// var row = bmMstrGridView.target.getList()[0]; // Object
		// 선택한 행 가져오기
		var row = bmMstrGridView.target.getList("selected")[0]; // Object
		// console.log(row); // Object
		// console.log(row.__index); // 인덱스
		// console.log(typeof row);
		// row 객체를 배열로 변경
		// let rowArr = Object.keys(row)
		// console.log(Object.keys(row));
		// 배열의 길이		
		// console.log(rowArr.length);
		// console.log(row.length);
		// 값 가져오는 함수 만들기
		if (row != undefined) {
			// 품번
			$('#matrNo1').val(row.matrNo);
			// 품명
			$('#matrNm1').val(row.matrNm);
			// 품목구분
			$('#goodsDiv1').val(row.goodsDiv);
			// 자재유형
			$('#matrDiv1').val(row.matrDiv);
			// 자재그룹
			$('#matrGrp1').val(row.matrGrp);
			// 소재
			$('#matrMat1').val(row.matrMat);
			// 규격
			$('#matrSpec1').val(row.matrSpec);
			// 사이즈
			$('#matrSize1').val(row.matrSize);
			// Maker
			$('#matrMakrNm1').val(row.matrMakrNm);
			// 형번
			$('#matrMno1').val(row.matrMno);
			// 입고검사구분
			$('#matrTestDiv1').val(row.matrTestDiv);
			// 관리단위
			$('#matrUnit1').val(row.matrUnit);
			// 안전재고
			$('#matrSaftQty1').val(row.matrSaftQty);
			// 최소발주량
			$('#minOrdrgQty1').val(row.minOrdrgQty);
			// 거래처 구분
			$('#matrClntDiv').val(row.matrClntDiv);
			// 구매/외주구분
			$('#matrPurcDivNm').val(row.matrPurcDiv);
			// 중량 
			$('#matrWt').val(row.matrWt);
			// 원산지
			$('#originNm').val(row.originNm);
			// 대표도번
			$('#matrDrwNo').val(row.matrDrwNo);
			// 재고관리여부
			$('#matrStockCd').val(row.matrStockCd);
			// 2D설계소요일
			$('#dsgn2dMd').val(row.dsgn2dMd);
			// 2D평균소요일
			$('#avrg2dMd').val(row.avrg2dMd);
			// 3D설계소요일
			$('#dsgn3dMd').val(row.dsgn3dMd);
			// 3D평균소요일 -> 화면설계서 상 2D평균소요일로 되어 있음(고칠 예정?)
			$('#avrg3dMd').val(row.avrg3dMd);
			// 최종생산소요일
			$('#prdctnRqmMd').val(row.prdctnRqmMd);
			// 평균생산소요일
			$('#prdctnAvrgMd').val(row.prdctnAvrgMd);
			// 최종구매단가
			$('#matrUpr').val(row.matrUpr);
			// 평균구매단가
			$('#matrAvrgUpr').val(row.matrAvrgUpr);
			// 최종거래일자
			$('#matrLastTrstDt').val(row.matrLastTrstDt);
			// 발주비율1
			$('#pchsClntPct1').val(row.pchsClntPct1);
			// 발주비율2
			$('#pchsClntPct2').val(row.pchsClntPct2);
			// 발주비율3
			$('#pchsClntPct3').val(row.pchsClntPct3);
			// 설계대상구분 
			$('#dsgnTrgtYn').val(row.dsgnTrgtYn);
			// 리드타임
			$('#dlvrRqmDay').val(row.dlvrRqmDay);
		}
	}

	//거래처
	function clntSearch(type) {
		openSecondModal("/static/html/cmn/modal/clntSearch.html", 600, 420,
				"거래처 검색", {}, function(grid) {
					var row = grid.target.getList("selected")[0];
					if (type == 'LINK') {
						$('#linkGrpClntCd_S').val(row.clntCd);
						$('#linkGrpClntNm_S').val(row.clntNm);

					} else {

						$('#clntCd_S').val(row.clntCd);
						$('#clntNm_S').val(row.clntNm);
					}
				});
	}

	// 행추가 기능
	function gridAddRow() {
		// index
		// + 누르면 행추가
		// 그리드 기준으로 행추가
		// 첫번째 행 -> 객체
		var grid = bmMstrGridView.target.getList()[0];
		console.log(grid);
		// 전체행	-> 배열 객체
		var gridList = bmMstrGridView.target.list;
		console.log(bmMstrGridView.target.list);
		console.log(gridList[0]);
		console.log(gridList[1]);
		console.log(gridList[2]);
		// 그리드 객체 생성 안에서만 사용할 수 있나...?
		// 함수만들어서 쓰면 파라미터로 인덱스 받아와서 쓰는 듯?	
		//.addRow(추가할 내용, 삽인할위치(생략시 마지막),갯수)
		/*  bmMstrGridView.target.addRow -> ★target을 넣어야함! */
		// 인덱스 0을 기준으로 행 추가(행 복사됨)
		//  	bmMstrGridView.target.addRow($.extend({}, gridList[0], {__index : undefined })); 
		// 		bmMstrGridView.addRow($.extend({}, gridList[Math.floor(Math.random() * gridList.length)], {__index : undefined })); 
		//		bmMstrGridView.setValue(gridList);
		// 빈 행 추가
		bmMstrGridView.target.addRow($.extend({},
				bmMstrGridView.target.list.length, {
					__index : undefined
				}));
	}

	// 페이지 로드 시 속성에 값넣기, 값 초기화
	function setBmMstr(list) {
		// list -> grid
		var lst = list;
		// console.log(list);
		// console.log(list.length);
		if (lst.length !== undefined) {
			$('#matrNo1').val(lst[0].matrNo);
			$('#matrNm1').val(lst[0].matrNm);
			$('#goodsDiv1').val(lst[0].goodsDiv);
			$('#matrDiv1').val(lst[0].matrDiv);
			$('#matrGrp1').val(lst[0].matrGrp);
			$('#matrMat1').val(lst[0].matrMat);
			$('#matrSpec1').val(lst[0].matrSpec);
			$('#matrSize1').val(lst[0].matrSize);
			$('#matrMakrNm1').val(lst[0].matrMakrNm);
			$('#matrMno1').val(lst[0].matrMno);
			$('#matrTestDiv1').val(lst[0].matrTestDiv);
			$('#matrUnit1').val(lst[0].matrUnit);
			$('#matrSaftQty1').val(lst[0].matrSaftQty);
			$('#minOrdrgQty1').val(lst[0].minOrdrgQty);
			$('#matrClntDiv').val(lst[0].matrClntDiv);
			$('#matrPurcDivNm').val(lst[0].matrPurcDiv);
			$('#matrWt').val(lst[0].matrWt);
			$('#originNm').val(lst[0].originNm);
			$('#matrDrwNo').val(lst[0].matrDrwNo);
			$('#matrStockCd').val(lst[0].matrStockCd);
			$('#dsgn2dMd').val(lst[0].dsgn2dMd);
			$('#avrg2dMd').val(lst[0].avrg2dMd);
			$('#dsgn3dMd').val(lst[0].dsgn3dMd);
			$('#avrg3dMd').val(lst[0].avrg3dMd);
			$('#prdctnRqmMd').val(lst[0].prdctnRqmMd);
			$('#prdctnAvrgMd').val(lst[0].prdctnAvrgMd);
			$('#matrUpr').val(lst[0].matrUpr);
			$('#matrAvrgUpr').val(lst[0].matrAvrgUpr);
			$('#matrLastTrstDt').val(lst[0].matrLastTrstDt);
			$('#pchsClntPct1').val(lst[0].pchsClntPct1);
			$('#pchsClntPct2').val(lst[0].pchsClntPct2);
			$('#pchsClntPct3').val(lst[0].pchsClntPct3);
			$('#dsgnTrgtYn').val(lst[0].dsgnTrgtYn);
			$('#dlvrRqmDay').val(lst[0].dlvrRqmDay);

		}
		
		/* $.each($('.contents tbody td'), function(index, item) {
            // 상세정보 초기화
			$('.contents select').val("");
			$('.contents input[type="text"]').val("");
        }); */
	}
</script>
