<!DOCTYPE html>
<html lang="ko">
<head>     
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="/static/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
<link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
<link rel="stylesheet" href="/static/fontawesome/css/all.css">
<link rel="stylesheet" href="/static/css/ax5/ax5grid.css">
<link rel="stylesheet" href="/static/css/ax5/ax5mask.css">
<link rel="stylesheet" href="/static/css/ax5/ax5modal.css">
<link rel="stylesheet" href="/static/css/ax5/ax5toast.css">
<link rel="stylesheet" href="/static/css/jstree/style.min.css">
<link rel="stylesheet" href="/static/css/gnb.css">
<link rel="stylesheet" href="/static/css/main.css">
<link rel="stylesheet" href="/static/css/sub.css">
<link rel="stylesheet" href="/static/css/common.css">

<script src="/static/js/jquery-latest.min.js"></script>
<script src="/static/js/jquery.serializeObject.js"></script>
<script src="/static/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
<script src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
<script src="/static/js/moment/moment-with-locales.js"></script>
<script src="/static/js/ax5/ax5core.min.js"></script>
<script src="/static/js/ax5/ax5grid.min.js"></script>
<script src="/static/js/ax5/ax5mask.min.js"></script>
<script src="/static/js/ax5/ax5modal.min.js"></script>
<script src="/static/js/ax5/ax5toast.min.js"></script>
<script src="/static/js/jstree/jstree.min.js"></script>
<script type="text/javascript" src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="/static/js/global.js"></script>
<script src="/static/js/fileTree.js"></script>
</head>

<body>
  <div id="head_area"></div>
  <div id="top_area"></div>
  <div id="main_area">
    <!-- 		  페이지 상단  -->
    <div class="contents no_bg">
        <ul class="btn_ul">
            <li class="btn_r">
                <a onclick="initSearch();"><button class="bg_gray">초기화</button></a>
                <a onclick="DataSearch()"><button class="bg_gray">검 색</button></a>
            </li>
        </ul>
    </div>
    <!--  테이블 test -->

    <div class="contents search">
      <div class="">
        <!--  테이블 인풋 3분할  -->
        <table class="table_input type04">
          <!-- 검색조건 1행 -->
          <tr>
				<th class="hit">회사</th>
				<td>
				  <select id="coCd_S" name="coCd_S" data-kind="CO" data-search="coCd" required msg="회사" onchange="DataSearch();">
				    <option value="">전체</option>
				  </select>
				</td>
				
				<th class="hit">폐기일자</th>
				<td>
				  <div class="date_input">
				    <input id="ioDtFrom_S" name="ioDtFrom_S"  class="input_calendar" autocomplete="off"
				      required msg="시작일자" data-search="ioDtFrom">
				    <span>~</span>
				    <input id="ioDtTo_S" name="ioDtTo_S"  class="input_calendar" autocomplete="off"
				      required msg="종료일자" data-search="ioDtTo">
				  </div>
				</td>
				<th>고객사</th>
				<td>
					<input type="hidden" id="ordrsClntCd_S" name="ordrsClntCd_S" data-search="ordrsClntCd">
					<div class="search_form">
					<input type="text" id="clntNm_S" name="clntNm_S"  data-search="clntNm" onchange="DataSearch();" 
					onkeyup="event.keyCode == 8 ? ordrsClntCd_S.value='' : event.keyCode == 13 ? DataSearch() : ''">					  
					<a onclick="openClntSearch();"><i class="i_search_w"></i></a>
					</div>
				</td>
				<th></th>
				<td></td>
          </tr>

		  <!-- 검색조건 2행 -->
          <tr>
				<th>SalesCode</th>
				<td>
					<input type="hidden" id="salesNm_S" name="salesNm_S" data-search="salesNm">
				    <div class="search_form">
				    	<input type="text" id="salesCd_S" name="salesCd_S" data-search="salesCd" onchange="DataSearch();"
				    	onkeyup="if(window.event.keyCode == 13){gridView_S1.setData(0)};">
				    	<a onclick="wbsSalesCodeSearch();"><i class="i_search_w"></i></a>
				    </div>				    
				</td>
				<th>제품구분</th>
				<td>
					<input type="hidden" id="prdtCd_S" name="prdtCd_S" data-search="prdtCd">
			   		<div class="search_form">
			    	  <input type="text" id="prdtNm_S" name="prdtNm_S" data-search="prdtNm" onchange="DataSearch();" 
			    	  onkeyup="if(window.event.keyCode == 13){gridView_S1.setData(0)};">
				    	<a onclick="openPrdtSearch();"><i class="i_search_w"></i></a>
					</div>
				</td>
				<th>아이템구분</th>
				<td>
					<select id="itemDiv_S" name="itemDiv_S" data-kind="ITEMLIST" data-search="itemDiv" onchange="DataSearch();" >
						<option value="">전체</option>
					</select>	
				</td>
				<th></th>
				<td></td>
          </tr>

		  <!-- 검색조건 3행 --> 
          <tr>
				<th>폐기창고</th>
				<td>
<!-- 					<select  id="outWhCd_S" name="outWhCd_S" data-search="outWhCd" onchange="DataSearch();"> -->
<!-- 						<option value="">전체</option> -->
<!-- 					</select>		 			 -->
					<select id="outWhNm_S" name="outWhNm_S"   data-search="outWhNm" onchange="DataSearch();">						    
						<option value="">전체</option>
					</select>
				</td>
				<th>품번</th>
				<td>
					<input type="hidden" id="matrCd_S" name="matrCd_S" data-search="matrCd"> 
			   		<div class="search_form">
			    	  <input type="text" id="matrCdNm_S" name="matrCdNm_S" data-search="matrCdNm" onchange="DataSearch();" 
			    	  onkeyup="if(window.event.keyCode == 13){gridView_S1.setData(0)};">
				    	<a onclick="openMatListSearch();"><i class="i_search_w"></i></a>
					</div>
				</td>
				<th>품명</th>
				<td>
					<input type="text" id="matrNm_S" name="matrNm_S" data-search="matrNm" onchange="DataSearch();"
					onkeyup="event.keyCode == 8 ? matrNm_S.value='' : event.keyCode == 13 ? gridView_S1.setData(0) : '' ">
				</td>					
				<th>규격</th>
				<td>
					<input type="text" id="matrSpec_S" name="matrSpec_S data-search="matrSpec" onchange="DataSearch();"
					onkeyup="event.keyCode == 8 ? matrSpec_S.value='' : event.keyCode == 13 ? gridView_S1.setData(0) : '' ">
				</td>
          </tr>
          
          <!-- 검색조건 4행 -->
          <tr>
          		<th>거래처분류</th>
				<td>
					<select id="matrClntDiv_S" name="matrClntDiv_S" data-kind="MATRCLNTDIV" data-search="matrClntDiv" onchange="DataSearch();">
						<option value="">전체</option>
					</select>	
				</td>
          		<th>소재</th>
				<td>
					<input type="text" id="matrMat_S" name="matrMat_S"  data-search="matrMat" onchange="DataSearch();"
					onkeyup="event.keyCode == 8 ? matrMat_S.value='' : event.keyCode == 13 ? gridView_S1.setData(0) : '' ">
				</td>
				<th>Maker</th>
				<td>
					<input type="text" id="matrMakrNm_S" name="matrMakrNm_S" data-search="matrMakrNm" onchange="DataSearch();"
					onkeyup="event.keyCode == 8 ? matrMakrNm_S.value='' : event.keyCode == 13 ? gridView_S1.setData(0) : '' ">
				</td>
				<th>형번</th>
				<td>
					<input type="text" id="matrMno_S" name="matrMno_S"  data-search="matrMno" onchange="DataSearch();"
					onkeyup="event.keyCode == 8 ? matrMno_S.value='' : event.keyCode == 13 ? gridView_S1.setData(0) : '' ">
				</td>
          	
          </tr>

        </table>
		<input type="hidden" id="userId"    name="userId">
		<input type="hidden" id="pgmId"     name="pgmId" value="SM0501M01">
      </div>
    </div>

	<!-- 콘텐츠 - 폐기내역 조회 -->
    <div class="contents no_bg">
      <!-- 콘텐츠 타이틀 -->
      <div class="contents_tit">
      	<span  style="height: 30px; line-height: 30px;font-size: 15px;">폐기내역 조회 </span>
        <div class="add_btn_small pdl10">

		  <a onclick="excelDown();"
						style="height: 30px; line-height: 28px; width: 90px;"><i
						class="fas fa-file-excel"></i>엑셀다운로드</a>
          <a onclick="insertIoModal('C');" style="height: 30px; line-height: 28px;" authchk>+</a>
          <a onclick="deleteIoCost();" style="height: 30px; line-height: 28px;" authchk>-</a>
        </div>
        <select id="recordCnt" class="prae_select" onchange="DataSearch();">
          <option value="10">10</option>
          <option value="20" selected>20</option>
          <option value="50">50</option>
          <option value="100">100</option>
          <option value="9999999">전체</option>
        </select>
      </div>
    </div>
	<!-- 콘텐츠 -->
    <div class="contents">
      <!-- 리스트 -->
      <div class="ax5_grid">
        <div data-ax5grid="first-grid" data-ax5grid-config="{}" style="height: 300px; width: 100%"></div>
      	<div data-ax5grid="grid1_excel" data-ax5grid-config="{}" style="display: none;"></div>
      </div>
    </div>
    
    <!-- 콘텐츠 - 폐기상세 -->
    <div class="contents no_bg">
      <!-- 콘텐츠 타이틀 -->
      <div class="contents_tit">
      	<span  style="height: 30px; line-height: 30px;font-size: 15px;">폐기상세 </span>        
      </div>
    </div>
	<!-- 콘텐츠 -->
    <div class="contents">
      <!-- 리스트 -->
      <div class="ax5_grid">
      		<div data-ax5grid="second-grid" data-ax5grid-config="{}" style="height: 250px; width: 100%;"></div>
      </div>
    </div>
</body>
</html>


<script type="text/javascript">
	var isFirst = true;
	ax5.ui.grid.formatter["bilgYn"] = function () {
		var color = this.value == "Y" ? "color-circle_02.png" : "color-circle_01.png";
		if (this.value == "E"){
			return 'E';
		} else {
			return '<img src="/static/img/'+color+'" style="width: 10px;height: 10px;"></img>';
		}
	};
	
	//gridView_S1
	var gridView_S1 = {
		initView : function() {
  			this.target = new ax5.ui.grid();
  			this.target.setConfig({
  				showLineNumber : true,
  				showRowSelector: true,
  		    	multipleSelect: false,
  		    	sortable: true,
  		        target: $('[data-ax5grid="first-grid"]'),
  		        header: {
  		        	align: "center",
  		        	selector: true
  		        },
  		        body: {
  		        	mergeCells : ["coCdNm","salesCd"],
  		        	 onClick: function () {
  		        		 var item = this.item;
  		        		 console.log(item);
  		        		 this.self.select(this.dindex);
  		                
  		              //클릭시  gridView_S2 호출
  		              gridView_S2.initView().setData(0);
  		            },
  		            onDBLClick: function () {
  		            	insertIoModal("U");
  		            	
  		            },
  		        },

				page : {
					navigationItemCount : 10,
					height : 30,
					display : true,
					firstIcon : '<i class="fa fa-step-backward" aria-hidden="true"></i>',
					prevIcon : '<i class="fa fa-caret-left" aria-hidden="true"></i>',
					nextIcon : '<i class="fa fa-caret-right" aria-hidden="true"></i>',
					lastIcon : '<i class="fa fa-step-forward" aria-hidden="true"></i>',
					onChange : function() {
						gridView_S1.setData(this.page.selectPage);
					}
				},

// 				footSum: [
//   			    	[
//   			    		{label: "총계", colspan:12, align:"center"},
// 						{key: "costAmt", 		collector: "sum", formatter:"money", align: "right"}
//   	                 ]
//   			    ],

		    	columns : [	
		    			{key: "rn"               , label: "No."          , align: "center", width: 60 , hidden: true}
						,{key: "fileTrgtKey",	label: "파일대상KEY",		width: 50,		align: "center", 	hidden:true}
						,{key: "coCd",	    	label: "회사코드",			width: 70,		align: "center", 	hidden:true}
						,{key: "coCdNm",	    	label: "회사",			width: 70,		align: "center" }
						,{key: "salesCd", 		label: "Sales Code", 	width: 110,		align: "center",	hidden:false}
						,{key: "outWhCd",		label: "폐기창고 코드",			hidden: true }
						,{key: "outWhNm",		label: "폐기창고",			width: 110,		align: "center"} 
						,{key: "ioDt",		label: "폐기일자",			width: 100,		align: "center"}
						,{key: "ioResn",		label: "폐기사유", 	    width: 110,		align: "center"}
						,{key: "ioRmk", 	label: "비고", 			width: 110,		align: "center"}
						,{key: "ioNo", 	label: "폐기번호", 			width: 110,		align: "center"}						
						,{key: "creatId", 		label: "생성자아이디", 	 	hidden:true}
						,{key: "creatNm", 		label: "생성자", 			width: 110,		align: "center"	}
						,{key: "creatDttm",		label: "생성일시", 		width: 110,		align: "center"}
						,{key: "udtId", 		label: "변경자아이디", 		hidden:true}
						,{key: "udtNm", 		label: "변경자", 			width: 110,		align: "center"  }
						,{key: "udtDttm",		label: "변경일시", 		width: 110,		align: "center"}						
						,{key: "ordrsClntCd",		label: "고객사", 		hidden:true}	
						,{key: "clntNm", label: "고객사명",               hidden:true}
						,{key: "prdtCd", label: "제품구분",             hidden:true}
						,{key: "ioDiv", label: "수불구분",             hidden:true}
						,{key: "etcField1", label: "여분필드(고정)",             hidden:true}
						,{key: "etcField2", label: "여분필드(숫자)",             hidden:true}
						,{key: "etcField3", label: "여분필드(가변)",             hidden:true}
    	            	]

					});
        			return this;
        		},

		setData : function(_pageNo) {
			if (isFirst) return;
			var targetObj = this.target;
			if (inputValidation($('input[required]'))) {
 				var formData = {}
// 						"coCd" : $("#coCd_S").val(),
// 						"strtDt" : $("#ioDtFrom_S").val(),
// 						"endDt" : $("#ioDtTo_S").val(),
// 						"ordrsClntCd" : $("#ordrsClntCd_S").val(),
// 						"clntNm" : $("#ordrsClntNm").val(),
// 						"clntNm" : $("#ordrsClntNm").val(),
// 						"salesCd" : $("#salesCd_S").val(),
// 						"prdtCd" : $("#prdtNm_S").val(),
// 						"itemDiv" : $("#itemDiv_S").val(),
// 						"outWhCd" : $("#outWhCd_S").val(),
// 						"outWhNm" : $("#outWhCd_S").val(),
// 						"matrCd" : $("#matrCd_S").val(),
// 						"matrNm" : $("#matrNm_S").val(),
// 						"matrSpec" : $("#matrSpec_S").val(),
// 						"matrClntDiv" : $("matrClntDiv_S").val(),
// 						"matrMat" : $("#matrMat_S").val(),
// 						"matrMakrNm" : $("#matrMakrNm_S").val(),
// 						"matrMno" : $("#matrMno_S").val(),
// 						"pageNo" : _pageNo + 1,
// 						"recordCnt" : $("#recordCnt").val()						
// 				};

				//data-search  조회 
				//없는 것은 formData~ 처리 // 하나라도 없으면 리스트에 안나온다
				$.each($('[data-search]'), function(idx, elem){
					formData[$(elem).data("search")] = $(elem).val();
				});	
				formData["ioDtFrom"]  = $("#ioDtFrom_S").val().replace(/\-/g, '');
				formData["ioDtTo"]   = $("#ioDtTo_S").val().replace(/\-/g, '');
				//formData["outWhNm"]   = $("#outWhNm_S").val();
				formData["searchType"]   = $("#searchType_S").val();
				formData["searchValue"]   = $("#searchValue_S").val();
				formData["pageNo"] = _pageNo + 1;
				//data-search  조회 
				
//				debugger;
				postAjax("/user/sm/sm05/selectIoList", formData, null, function(data){
				var list = data.result;
					targetObj.setData({
  						list : list,
  						page : {
  							currentPage   : _pageNo,
  							pageSize      : data.paginationInfo.pageSize,
  							totalElements : data.paginationInfo.totalRecordCount,
  							totalPages    : data.paginationInfo.totalPageCount
  						}
					
  					});
  				});
				//debugger;
  			}
		}
  	}
        		
    //폐기상세
    var gridView_S2 = {
		initView : function() {
  			this.target = new ax5.ui.grid();
  			this.target.setConfig({
  				showLineNumber : true,
  				showRowSelector: false,
  		    	multipleSelect: false,
  		    	sortable: true,
  		        target: $('[data-ax5grid="second-grid"]'),
  		        header: {
  		        	align: "center",
  		        	selector: true
  		        },
  		        body: {
  		        	//mergeCells : ["coCdNm","salesCd","costNo","pchsClntNm"], 
  		        	 onClick: function () {
  		                this.self.select(this.dindex);
  		                
  		                var row = this.dindex;
                        var paramObj = {"row" : row};
  		              
  		            },
  		            onDBLClick: function () {
  		            	this.self.clearSelect();
                        this.self.select(this.dindex);
                        
  		            	//insertIoCostModal("U");
  		            },
  		        },

				page : {
					navigationItemCount : 10,
					height : 30,
					display : true,
					firstIcon : '<i class="fa fa-step-backward" aria-hidden="true"></i>',
					prevIcon : '<i class="fa fa-caret-left" aria-hidden="true"></i>',
					nextIcon : '<i class="fa fa-caret-right" aria-hidden="true"></i>',
					lastIcon : '<i class="fa fa-step-forward" aria-hidden="true"></i>',
					onChange : function() {
						gridView_S2.setData(this.page.selectPage);
					}
				},

// 				footSum: [
//   			    	[
//   			    		{label: "총계", colspan:12, align:"center"},
// 						{key: "costAmt", 		collector: "sum", formatter:"money", align: "right"}
//   	                 ]
//   			    ],

		    	columns : [	
		    			{key: "rn"               , label: "No."          , align: "center", width: 60 , hidden: true}
						,{key: "ioSeq",		    label: "순번",			width: 60,		align: "center"}
						,{key: "dsgnNo",		label: "도번",			width: 200,		align: "center"}
						,{key: "matrCd",		label: "품번",			width: 100,		align: "center"}
						,{key: "matrNm",		label: "품명",			width: 110,		align: "center"}
						,{key: "matrSpec",		label: "규격",			width: 110,		align: "center"}
						,{key: "matrMat",		label: "소재",			width: 80,		align: "center"}
						,{key: "matrMakrNm",    label: "MAKER", 	    width: 80,		align: "center"}
						,{key: "matrMno", 	    label: "형번", 			width: 100,		align: "center"}
						,{key: "ioQty", 	    label: "폐기수량", 	    width: 90,		align: "center"}						
						,{key: "creatId", 		label: "생성자아이디", 	 	hidden:true}
						,{key: "creatNm", 		label: "생성자", 			width: 110,		align: "center"	}
						,{key: "creatDttm",		label: "생성일시", 		width: 110,		align: "center"}
						,{key: "udtId", 		label: "변경자아이디", 		hidden:true}
						,{key: "udtNm", 		label: "변경자", 			width: 110,		align: "center"  }
						,{key: "udtDttm",		label: "변경일시", 		width: 110,		align: "center"}						
						,{key: "coCd", 		label: "회사코드", 		hidden:true}
						,{key: "coCdNm", 		label: "회사명", 		hidden:true}
						,{key: "ioNo", 		label: "폐기번호", 		hidden:true}
						,{key: "salesCd", 		label: "Sales Code", 		hidden:true}
						,{key: "ioDtlRmk", 		label: "폐기상세비고", 		hidden:true}
						,{key: "outInoutKey", 		label: "출고수불번호", 		hidden:true}
						,{key: "creatPgm", 		label: "생성프로그램ID", 		hidden:true}
						,{key: "udtPgm", 		label: "최종수정프로그램ID", 		hidden:true}
						,{key: "etcField1", 		label: "여분필드(고정)", 		hidden:true}
						,{key: "etcField2", 		label: "여분필드(숫자)", 		hidden:true}
						,{key: "etcField3", 		label: "여분필드(가변)", 		hidden:true}
    	            ]

							});
        			return this;
        		},

		setData : function(_pageNo) {
//			if (isFirst) return;
			var targetObj = this.target;
//			if (inputValidation($('input[required]'))) {
				var formData = {}
						
// 						"coCd" : $("#coCd_S").val(),
// 						"ioNo" : $("#ioNo_S").val(),
// 						"pageNo" : _pageNo + 1, 
// 		               	"recordCnt" : $("#recordCnt").val()
// 				};
				$.each($('[data-search]'), function(idx, elem){
					formData[$(elem).data("search")] = $(elem).val();
				});	
// 				formData["ioDtFrom"]  = $("#ioDtFrom_S").val().replace(/\-/g, '');
// 				formData["ioDtTo"]   = $("#ioDtTo_S").val().replace(/\-/g, '');
				formData["searchType"]   = $("#searchType_S").val();
				formData["searchValue"]   = $("#searchValue_S").val();
				formData["pageNo"] = _pageNo + 1;
				formData["recordCnt"]   = $("#recordCnt").val();
//				debugger;
				postAjax("/user/sm/sm05/selectIoDetailList", formData, null, function(data){
				var list = data.result;
					targetObj.setData({
  						list : list,
  						page : {
  							currentPage   : _pageNo,
  							pageSize      : data.paginationInfo.pageSize,
  							totalElements : data.paginationInfo.totalRecordCount,
  							totalPages    : data.paginationInfo.totalPageCount
  						}
  					});
  				});
  			}
  		}
    //폐기상세
    
    //엑셀뷰
    var excelView = {
		initView: function(){
			this.target = new ax5.ui.grid();
			this.target.setConfig({
				target: $('[data-ax5grid="grid1_excel"]'),
				columns: [
						{key: "rn"               , label: "No."          , align: "center", width: 60 , hidden: true}
						,{key: "fileTrgtKey",	label: "파일대상KEY",		width: 50,		align: "center", 	hidden:true}
						,{key: "coCd",	    	label: "회사코드",			width: 70,		align: "center", 	hidden:true}
						,{key: "coCdNm",	    	label: "회사",			width: 70,		align: "center" }
						,{key: "salesCd", 		label: "Sales Code", 	width: 110,		align: "center",	hidden:false}
						,{key: "outWhCd",		label: "폐기창고 코드",			hidden: true }
						,{key: "outWhNm",		label: "폐기창고",			width: 110,		align: "center"} 
						,{key: "ioDt",		label: "폐기일자",			width: 100,		align: "center"}
						,{key: "ioResn",		label: "폐기사유", 	    width: 110,		align: "center"}
						,{key: "ioRmk", 	label: "비고", 			width: 110,		align: "center"}
						,{key: "ioNo", 	label: "폐기번호", 			width: 110,		align: "center"}						
						,{key: "creatId", 		label: "생성자아이디", 	 	hidden:true}						
						,{key: "creatDttm",		label: "생성일시", 		width: 110,		align: "center"}											
						,{key: "ordrsClntCd",		label: "고객사", 		hidden:true}	
						,{key: "clntNm", label: "고객사명",               hidden:true}
						,{key: "prdtCd", label: "제품구분",             hidden:true}
						,{key: "ioDiv", label: "수불구분",             hidden:true}						
						,{key: "creatNm"          , label: "생성자"        , align: "center", width: 100, hidden: false,
							formatter: function(){
								if(this.item.creatNm == undefined){return '-';}
								return this.item.creatNm;
								}
						},
						{key: "creatDttm"        , label: "생성일"      , align: "center", width: 130, hidden: false,
							formatter: function(){
								if(this.item.creatDttm == undefined){return '-';}
								return this.item.creatDttm;
							}
						},
						{key: "udtId"            , label: "변경자"        , align: "center", width: 100, hidden: true},
						{key: "udtNm"            , label: "변경자"        , align: "center", width: 100, hidden: false,
							formatter: function(){
								if(this.item.udtNm == undefined){return '-';}
								return this.item.udtNm;
							}
						},
						{key: "udtDttm"          , label: "변경일"      , align: "center", width: 130, hidden: false,
							formatter: function(){
								if(this.item.udtDttm == undefined){return '-';}
								return this.item.udtDttm;
							}
						},
						{key: "etcField1"        , label: "여분필드(고정)", align: "center", width: 100, hidden: true},
						{key: "etcField2"        , label: "여분필드(숫자)", align: "center", width: 100, hidden: true},
						{key: "etcField3"        , label: "여분필드(가변)", align: "center", width: 100, hidden: true}
				],
			});
			return this;
		}
	}
    //엑셀 다운
    function excelDown() {
		var paramObj = {"pageNo": 1};
		$.each($('#main_area [data-search]'), function(idx, elem){
			paramObj[$(elem).data('search')] = elem.value;
		});
		paramObj.recordCnt = 99999999;
		//paramObj["baseDt"] = $("#baseDt").val().replace(/\-/g,'');
		postAjax("/user/sm/sm05/selectIoList", paramObj, null, function(data){
			//debugger;
			var list = data.result;
			excelView.target.setData({
				list : list,
				page : {
					totalElements : list.length,
				}
			});
			var todayDate = new Date().format('yyyyMMddHHmmss');
			excelView.target.exportExcel("폐기등록 목록_"+todayDate+".xls");
		});
	}

  	$(document).ready(function() {

  		mainDefaultLoad("매입관리", "폐기등록");			// 페이지 타이틀 설정
  		setCommonSelect($("#main_area select[data-kind]"));		// 공통코드 set

		$("#coCd_S").val(jwt.coCd);
		// 시작일 (현재날짜의 월 첫일)
		$('#ioDtFrom_S').datepicker({
  			format : "yyyy-mm-dd",
  			language : "ko",
  			autoclose : true
  		})

  		.datepicker("setDate", moment(new Date()).startOf("month").toDate())
  		.on("changeDate", function(){
  			if($('#ioDtFrom_S').val() > $('#ioDtTo_S').val()){
  				alert("날짜를 확인해주세요");
  				$('#ioDtFrom_S').datepicker("setDate", new Date($('#ioDtTo_S').val()));
  			}
  		});

  		// 종료일 (현재날짜의 월 말일)
  		$('#ioDtTo_S').datepicker({
  			format : "yyyy-mm-dd",
  			language : "ko",
  			autoclose : true
  		})
  		.datepicker("setDate", moment(new Date()).endOf("month").toDate())
  		.on("changeDate", function(){
  			if($('#ioDtFrom_S').val() > $('#ioDtTo_S').val()){
  				alert("날짜를 확인해주세요");
  				$('#ioDtTo_S').datepicker("setDate", new Date($('#ioDtFrom_S').val()));
  			}
  		});
  		
  		//폐기창고 - 조회창에 값 고정
		//$("#outWhNm_S").val();
		
  		//폐기창고 - select box 값 선택시 리스트 화면에 표시
  		getOutWhNm();
  		
        isFirst = false;    
        
  		gridView_S1.initView().setData(0);
  		excelView.initView();
  		
  		
  		//권한체크
  		authChk();

  	});

	/*수정 or 등록 버튼 클릭 시*/
	function insertIoModal(type) {
		if (type == 'U') {
			
// 			if (selectGridValidation(gridView)) {
// 				return;
// 			}
			var row = gridView_S1.target.getList("selected")[0];
			//debugger;
			var paramObj = {
				"actionType" : type,
				"fileTrgtKey" : row.fileTrgtKey,
				"coCd" 	   : row.coCd,
		       	"userId"   : jwt.userId,
		       	"pgmId"    : "SM0501M001"
			};
		} else {
			var paramObj = {
					"actionType" : type,
					"fileTrgtKey" : 0,
					"coCd" 	   : jwt.coCd,
			       	"userId"   : jwt.userId,
			       	"pgmId"    : "SM0501M001"
			}
		}
		openModal("/static/html/user/sm/sm05/SM0501P01.html", 1500, 750, "", paramObj, function(data) {
			DataSearch();
			//gridView_S1.setData(0);
		});
	}

	/*삭제 버튼 클릭 시*/
	function deleteIoCost() {
		var row = gridView_S1.target.getList("selected")[0];
		var formData = {
				"fileTrgtKey" 	: row.fileTrgtKey,
				"coCd" 	   		: row.coCd,
		       	"userId"   		: jwt.userId,
		       	"fileTrgtTyp"  : $('#pgmId').val(),
		}
		if (confirm("삭제하시겠습니까?")) {
			putAjax("/user/sm/sm10/deleteIoCost", formData, null, function(data) {
						alert(data.resultMessage);
						if (data.resultCode == 200) {
							gridView_S1.setData(0);
						}
					});
		}

	}

	// 초기화 버튼용
	function initSearch() {
		$('[data-search]').off("change");	//바인딩기능 오프
		$('.contents.search select, .contents.search input').val("");
		
		$("#ioDtFrom_S").val(dateToStr(moment(new Date()).startOf("month").toDate()));
		$("#ioDtTo_S").val(dateToStr(moment(new Date()).endOf("month").toDate()));
		$("#coCd_S").val(jwt.coCd);
		
        // 검색조건 이벤트 bind
  		$('[data-search]').on("change", function(){
  			gridView_S1.setData(0);
  		});		
  		gridView_S1.initView().setData(0);
	}
	
	// 검색 버튼
	function DataSearch() {
		gridView_S1.setData(0);
		//gridView_S2.setData(0);
	}

	// 출력 버튼용
// 	function setReportMain() {
//   	 	var row = gridView_S1.target.getList("selected")[0];
//   		if (row == undefined) {
//   			alert("출력할 프로젝트를 선택해주세요.");
//   			return;
//   		}
//   		var fileName = "SM1001M001.jrf";
//   		var arg = "coCd#" + row.coCd + "#prjctCd#" + row.prjctCd + "#";
// 		callReport(fileName, arg, "1050", "700");
// 	}
	
	//돋보기 부분
	// 고객사 검색
	function openClntSearch() {
		var paramObj = {
				//"searchValue" :  $("#clntNm_S").val()
				"ordrsClntCd" : $('#ordrsClntCd_S').val(),
           		"ordrsClntNm": $('#clntNm_S').val() 
		}		
		openSecondModal("/static/html/cmn/modal/clntSearch.html", 600, 420, "거래처 검색", paramObj, function (grid) {
			var row = grid.target.getList("selected")[0];
// 			if(openType == "P"){
// 				$('#clntCd_S').val(row.clntCd);
// 				$('#clntNm_S').val(row.clntNm);
// 				gridView_S1.setData(0);
// 			}else if(openType == "V"){
				$('#ordrsClntCd_S').val(row.ordrsClntCd);
				$('#clntNm_S').val(row.ordrsClntNm);
// 			}
				DataSearch();
		});
	}
	
	//Sales Code (수주마스터, 수주상세테이블 조인) 검색
    function wbsSalesCodeSearch() {
        var paramObj = {
           "coCd" : $('#coCd_S').val(),
           "salesCd": $('#salesCd_S').val()
        };
        openSecondModal("/static/html/cmn/modal/wbsSalesCodeSearch.html", 1000, 430, "SALES CODE 검색", paramObj, function (grid){
            var row = grid.target.getList("selected")[0];
            $('#salesCd_S').val(row.salesCd);
//             $('#salesNm_S').val(row.salesCd);
//             $('#eqp_nm').val(row.eqNm);
            DataSearch();
        });
    }

	//제품구분 검색
	function openPrdtSearch(){
		var paramObj = {
				"coCd": $('#coCd_S').val(),
				"prdtCd": $('#prdtCd_S').val(),
				"prdtNm": $('#prdtNm_S').val(),
				"useYn" : "Y"
		}
		openSecondModal("/static/html/cmn/modal/prdtSearch.html", 800, 600, "제품 검색", paramObj, function (grid) {
			var row = grid.target.getList("selected")[0];
			$("#prdtCd_S").val(row.prdtCd);
			$("#prdtNm_S").val(row.prdtNm);
			DataSearch();
		});
	}
	
	//품번 검색
	function openMatListSearch() {
		// setBmMstr()에서 강제로 맨위에 있는 행을 선택하고 있기 때문에 값을 초기화 해줘야한다. 230601
		/* 수정해야함 그리드 컬럼을 전부 초기화해야하는 듯 */
		/* 품번, 품명만 초기화 해두기 */
		//debugger;
		// $('#coCd').val(""); // 회사 초기화
		
		$('#matrCd').val("");
		$('#matrNm').val("");

		//alert("searchValue : " + $("#matrCdNm_S").val());
		var paramObj = {
			"searchValue" : $("#matrCdNm_S").val()
		}	
		openSecondModal("/static/html/cmn/modal/matListSearch.html", 600, 420, "자재 품번 검색", paramObj, function(grid) {
			var row = grid.target.getList("selected")[0];
			//console.log(row.matrCd);
			//if (openType == "P") {
				$('#matrCd_S').val(row.matrCd);		// 	품번 값 가져오기
				$('#matrCdNm_S').val(row.matrCd);	//	품번 값 가져오기
				DataSearch();
			//} 
		});  
	}
	//돋보기 부분	
	
	//폐기창고 값 선택 함수    
	function getOutWhNm() {
		var paramObj = {
				"outWhNm" : "INOUTDIV_O02",
				"coCd" : $("#coCd_S").val()
		};
		
		postAjax("/user/sm/sm05/selectOutWhNm", paramObj, null, function (data) {
   	    var row = data.whList;
//    	    debugger;
		for(var i=0;  i<row.length; i++) {
		    $('#outWhNm_S').append($('<option>', { 
		        value: row[i].codeEtc,
		        text : row[i].codeNm 
		    }));					
		}
		
       });
	}
    	
	

</script>