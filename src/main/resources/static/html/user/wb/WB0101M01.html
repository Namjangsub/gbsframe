<!DOCTYPE html>
<html lang="ko">
          <style>
                    .add_btn_small{
                        display: inline-block;
                        padding: 0px;
                    }
                    
                    .add_btn_small a {
                        display: inline-block;
                        width: 33px;
                        height: 20px;
                        line-height: 20px;
                        text-align: center;
                        color: #444;
                        background: #ffffff;
                        box-shadow: 1px 1px rgba(0,0,0,0.15);
                    }
          </style>
<head>
          <meta charset="utf-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge">
          <meta name="viewport" content="width=device-width, initial-scale=1">
          <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
          <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
          <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
          <link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
          <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
          <link rel="stylesheet" href="/static/fontawesome/css/all.css">
          <link rel="stylesheet" href="/static/css/ax5/ax5grid.css">
          <link rel="stylesheet" href="/static/css/ax5/ax5mask.css">
          <link rel="stylesheet" href="/static/css/ax5/ax5modal.css">
          <link rel="stylesheet" href="/static/css/ax5/ax5toast.css">
          <link rel="stylesheet" href="/static/css/jstree/style.min.css">
          <link rel="stylesheet" href="/static/css/gnb.css">
          <link rel="stylesheet" href="/static/css/main.css">
          <link rel="stylesheet" href="/static/css/sub.css">
          <link rel="stylesheet" href="/static/css/common.css">
          
          <script src="/static/js/jquery-latest.min.js"></script>
          <script src="/static/js/jquery.serializeObject.js"></script>
          <script src="/static/bootstrap/js/bootstrap.min.js"></script>
          <script src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
          <script src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
          <script src="/static/js/moment/moment-with-locales.js"></script>
          <script src="/static/js/ax5/ax5core.min.js"></script>
          <script src="/static/js/ax5/ax5grid.min.js"></script>
          <script src="/static/js/ax5/ax5mask.min.js"></script>
          <script src="/static/js/ax5/ax5modal.min.js"></script>
          <script src="/static/js/ax5/ax5toast.min.js"></script>
          <script src="/static/js/jstree/jstree.min.js"></script>
          <script type="text/javascript" src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js" ></script>
          <script src="/static/js/global.js"></script>
</head>

<body>
          <div id="head_area"></div>
          <div id="top_area"></div>
          
          <div id="main_area">
                    <!-- 페이지 상단 -->
                    <div class="contents no_bg">
                <ul class="btn_ul">
                  <li class="btn_r">
                              <a onclick="initSearch();">
                              <button class="bg_gray">초기화</button>
                            </a>
                            <a onclick="wbsGridView.setData(0);">
                              <button class="bg_gray">검 색</button>
                            </a>
                  </li>
                </ul>
          </div>
                      <!-- 검색 콘텐츠 -->
              <div class="contents search">
                  <div class="">
                      <!-- 테이블 인풋 3분할 -->
                      <table class="table_input type04">
                        <!-- 검색조건 1행 -->
                        <tr>
                          
                          <th class= "hit">회사</th>
                          <td>
                              <select id="coCd_S" data-kind="CO" required="required" onchange="setByCoCd(this.value); wbsGridView.setData(0);">
                                        <option value="">전체</option>
                              </select>
                          </td>
                          
                          <th class= "hit">발생일자</th>
                          <td>
                              <div class="date_input">
                                <input type="text" id="reqDtFrom" class="input_calendar" autocomplete="off">
                                <span>~</span>
                                <input type="text" id="reqDtTo" class="input_calendar" autocomplete="off">
                              </div>
                          </td>
                          
                          <th>&nbsp;</th>
                          <td>&nbsp;</td>
                          
                          <th>고객사</th>
                          <td>
                                 <input type="hidden" id="clntCd_S">
                                 <div class="search_form" style="width:180px;">
                                    <input type="text" id="clntNm_S" onkeyup="if(event.keyCode != 13){resetClntCd()}; event.keyCode == 8 ? clntCd_S.value = '' : event.keyCode == 13 ? wbsGridView.setData(0) : ''; ">
                                        <a onclick="openClntSearch();"><i class="i_search_w"></i></a>
                                  </div>
                          </td>
                          
                        </tr>
                        <!-- 검색조건 2행 -->                    
                        <tr>
                          <th>Sales Code</th>
                          <td>
                              <input type="hidden" id="clntCd_S">
                                 <div class="search_form" style="width:180px;">
                                    <input type="text" id="clntNm_S" onkeyup="if(event.keyCode != 13){resetClntCd()}; event.keyCode == 8 ? clntCd_S.value = '' : event.keyCode == 13 ? wbsGridView.setData(0) : ''; ">
                                        <a onclick="openClntSearch();"><i class="i_search_w"></i></a>
                                  </div>
                          </td>
                          
                          <th>제품 구분</th>
                          <td>
                            <div class="search_form">
                                     <select id="prdtDivCd" name="prdtDivCd" data-kind="PRDTDIV" onchange="prdtDivCombo(this);" required="required" msg="제품구분" style="width:180px;">
                                               <option value="">선택</option>
                                     </select>
                            </div>
                          </td>
                          
                          <th>아이템 구분</th>
                          <td>
                            <div class="search_form">
                                     <select id="prdtDivCd" name="prdtDivCd" data-kind="PRDTDIV" onchange="prdtDivCombo(this);" required="required" msg="아이템구분" style="width:180px;">
                                               <option value="">선택</option>
                                     </select>
                            </div>
                          </td>
                          
                          <th>공유대상자</th>
                          <td>
                             <input type="hidden" id="clntCd_S">
                                 <div class="search_form" style="width: 180px;">
                                    <input type="text" id="clntNm_S" onkeyup="if(event.keyCode != 13){resetClntCd()}; event.keyCode == 8 ? clntCd_S.value = '' : event.keyCode == 13 ? wbsGridView.setData(0) : ''; ">
                                        <a onclick="openClntSearch();"><i class="i_search_w"></i></a>
                                  </div>
                          </td> 
                                        
                        </tr>

                         <!-- 검색조건 3행 -->   
                         
                         
                         <tr>
                          <th>고객사 PJT</th>
                          <td>
                              <input type="text" id="prdtSpec" data-search="prdtSpec" onkeyup="event.keyCode == 13 ? mainwbsGridView.setData(0) : ''">
                          </td>
                          
                          <th>설비명</th>
                          <td>
                            <input type="text" id="prdtSpec" data-search="prdtSpec" onkeyup="event.keyCode == 13 ? mainwbsGridView.setData(0) : ''">
                          </td>
                          
                          <th>관리번호</th>
                          <td>
	                          <input type="hidden" id="clntCd_S">
	                                 <div class="search_form" style="width: 180px;">
	                                    <input type="text" id="clntNm_S" onkeyup="if(event.keyCode != 13){resetClntCd()}; event.keyCode == 8 ? clntCd_S.value = '' : event.keyCode == 13 ? wbsGridView.setData(0) : ''; ">
	                                        <a onclick="openClntSearch();"><i class="i_search_w"></i></a>
	                                  </div>
                          </td>
                          
                          <th>차수</th>
                          <td>
                              <div class="search_form">
                                     <select id="prdtDivCd" name="prdtDivCd" data-kind="PRDTDIV" onchange="prdtDivCombo(this);" required="required" msg="아이템구분" style="width:180px;">
                                               <option value="">선택</option>
                                     </select>
                            </div>
                          </td> 
                                        
                        </tr>
                        
                         <!-- 검색조건 END --> 
                      </table>
                  </div>
              </div>
                    <!-- // 콘텐츠 -->

                    <!-- 콘텐츠 -->
                    <div class="contents no_bg">
                   
                              <!-- 콘텐츠 타이틀 -->
                              <div class="contents_tit">
                                 <span  style="height: 30px; line-height: 30px;font-size: 15px;">등록된 일정계획 리스트 </span>
                                        <div class="add_btn_small pdl10">
		                         <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
		                          <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
		                          <a onclick="excelDown();" style="height: 30px; line-height: 28px; width: 90px;"><i class="fas fa-file-excel"></i> 엑셀다운로드</a>
                                        </div>
                                        <select id="recordCnt" class="prae_select" onchange="changeRecordCnt();">
                                                  <option value="10">10</option>
                                                  <option value="20" >20</option>
                                                  <option value="50">50</option>
                                                  <option value="100">100</option>
                                                  <option value="9999999" selected>전체</option>
                                        </select>
                              </div>
                    </div>
            <!-- 콘텐츠 -->
              <div class="contents">
                <!-- 리스트 -->
                  <div class="ax5_grid" data-ax5grid="first-grid" data-ax5grid-config="{}" style="height: 650px; width: 100%" ></div>
                  <div data-ax5grid="excel-grid" data-ax5grid-config="{}" style="display: none;"></div>
              </div>
          </div>
                    
</body>
</html>

<script type="text/javascript">
          var openFrom = null;
          var wbsGridView = {
                    initView: function(){
                              this.target = new ax5.ui.grid();
                              this.target.setConfig({
                              showRowSelector: true,
                              multipleSelect: true,
                              sortable: true,
                              target: $('[data-ax5grid="first-grid"]'),
                              header: {
                                  align: "center",
                                  selector: false
                                  },
                              body: {
                                  onClick: function () {
                                      this.self.select(this.dindex); 
                                      /* Grid에서 lvl1, 2, 3 클릭 시 일정 계획 등록 팝업 창 실행 */
                                      if (this.column.key == "lvl1"){
                                    	  insertWBSModal(1);
                                      }
                                      else if (this.column.key == "lvl2"){
                                    	  insertWBSModal(2);
                                      }
                                      else if (this.column.key == "lvl3"){
                                    	  insertWBSModal(3);
                                      }
                                      insertWBSModal(3);
                                      /* 일정계획등록 팝업창 END */
                                  },
                                  onDBLClick: function () {
                                      this.self.clearSelect();
                                      this.self.select(this.dindex);
                                      
                                  },
                              },
/*                               page: {
                                          navigationItemCount: 9,
                                          height: 30,
                                          display: true,
                                          firstIcon: '<i class="fa fa-step-backward" aria-hidden="true"></i>',
                                          prevIcon: '<i class="fa fa-caret-left" aria-hidden="true"></i>',
                                          nextIcon: '<i class="fa fa-caret-right" aria-hidden="true"></i>',
                                          lastIcon: '<i class="fa fa-step-forward" aria-hidden="true"></i>',
                                          onChange: function () {
                                                  wbsGridView.setData(this.page.selectPage);
                                          }
                              }, */
                            columns: [
                                        {key: "",      label: "회사",          hidden: true},
                                        {key: "",      label: "NO.",      align: "center",   width: 80},
                                        {key: "",      label: "Sales Code",   align: "center",   width:150},
                                        {key: "lvl1",      label: "Lv.1",         align: "center",   width: 150},
                                        
                                        {key: "lvl2",      label: "Lv.2",        align: "center",   width: 150},
                                        {key: "lvl3",      label: "Lv.3",             align: "center",   width: 150},
                                        {key: "",      label: "주요내용",             align: "center",   width: 300},
                                        {key: "",      label: "작성자",             align: "center",   width: 150},
                                        {key: "",      label: "담당자",            align: "center",   width: 150},
                                        
                                        {key: "creatDttm",      label: "시작일자",    width: 150, align: "center",
	                                        formatter: function(){
	                                                  if(this.item.creatDttm == undefined){return '-';}
	                                                  return this.item.creatDttm;
	                                        }
                                        },
                                        {key: "creatDttm",      label: "종료일자",    width: 150, align: "center",
	                                        formatter: function(){
	                                                  if(this.item.creatDttm == undefined){return '-';}
	                                                  return this.item.creatDttm;
	                                        }
                                        }
                                     ]

                               });
                              return this;
                    }
                    /* setData: function(_pageNo) {
                              var targetObj = this.target;
                              var formData = {
                                        "reqDtFrom"         : $("#reqDtFrom").val().replace(/\-/g,''),
                                        "reqDtTo"                     : $("#reqDtTo").val().replace(/\-/g,''),
                                        "coCd"                        : $("#coCd_S").val(),
                                        "typCd"             : $("#typCd_S").val(),
                                        "whCd"                        : $("#whCd_S").val(),
                                        "shipYn"            : $("#shipYn_S").val(),
                                        "clntCd"            : $("#clntCd_S").val(),
                                        "clntNm"            : $("#clntNm_S").val(),
                                        "taxivcCoprt"       : $("#taxivcCoprt").val(),
                                        "prdtGrp"                     : $("#prdtGrp_S").val(), 
                                        "shipRmk"                     : $("#shipRmk").val(), 
//                                      "searchType"        : $("#searchType").val(),
//                                      "searchValue"       : $("#searchValue").val(),
                                        "pageNo"            : _pageNo + 1, 
                                        "recordCnt"         : $("#recordCnt").val(),
                                        "siteCd"            : $("#siteCd_S").val(),
                                        "siteNm"            : $("#siteNm_S").val()
                              }
                              postAjax("/user/ar/ar01/selectShipList", formData, null, function(data){
                                        var list = data.resultList;
                                        targetObj.setData({
                                                  list : list,
                                                  page : {
                                                            currentPage : _pageNo,
                                                            pageSize : data.paginationInfo.pageSize,
                                                            totalElements : data.paginationInfo.totalRecordCount,
                                                            totalPages : data.paginationInfo.totalPageCount
                                                  }
                                        });
                              });
                    } */
          }
          
          var excelView = {
                    initView: function(){
                              this.target = new ax5.ui.grid();
                              this.target.setConfig({
                              target: $('[data-ax5grid="excel-grid"]'),
                            columns: [
                                {key: "",      label: "회사",          hidden: true},
                                {key: "",      label: "NO.",      align: "center",   width: 80},
                                {key: "",      label: "Sales Code",   align: "center",   width:150},
                                {key: "lvl1",      label: "Lv.1",         align: "center",   width: 150},
                                {key: "lvl2",      label: "Lv.2",        align: "center",   width: 150},
                                {key: "lvl3",      label: "Lv.3",             align: "center",   width: 150},
                                {key: "",      label: "주요내용",             align: "center",   width: 300},
                                {key: "",      label: "작성자",             align: "center",   width: 150},
                                {key: "",      label: "담당자",            align: "center",   width: 150},
                                {key: "creatDttm",      label: "시작일자",    width: 150, align: "center",
                                    formatter: function(){
                                              if(this.item.creatDttm == undefined){return '-';}
                                              return this.item.creatDttm;
                                    }
                                },
                                {key: "creatDttm",      label: "종료일자",    width: 150, align: "center",
                                    formatter: function(){
                                              if(this.item.creatDttm == undefined){return '-';}
                                              return this.item.creatDttm;
                                    }
                                }
                            ]
                        });
                              return this;
                    }
          }         
          $(document).ready(function() {
                    mainDefaultLoad("WBS", "일정계획등록");
                    wbsGridView.initView().setData(0);

          })
          
         function insertWBSModal(idx){
                    var paramObj = {
                              "actionType": "C",
                              "coCd": $('#coCd_S').val()
                    };
                    openModal("/static/html/user/wb/WB0101P01.html", 1300, 780, "", paramObj);
          }
</script>
