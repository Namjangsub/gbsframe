<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="/static/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/static/fontawesome/css/all.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5grid.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5mask.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5modal.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5toast.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5menu.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5calendar.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5picker.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5select.css">
    <link rel="stylesheet" href="/static/css/jstree/style.min.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5combobox.css">
    <link rel="stylesheet" href="/static/css/gnb.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/sub.css">
    <link rel="stylesheet" href="/static/css/common.css">

    <script type="text/javascript" src="/static/js/jquery-latest.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.serializeObject.js"></script>
    <script type="text/javascript" src="/static/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
    <script type="text/javascript" src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
    <script type="text/javascript" src="/static/js/moment/moment-with-locales.js"></script>
    <script type="text/javascript" src="/static/js/jstree/jstree.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5core.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5grid.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5mask.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5modal.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5toast.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.5.0/jszip.min.js"></script>
    <script type="text/javascript" src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js" ></script>
    <script type="text/javascript" src="/static/js/workingDayCalc.js"></script>
	<script type="text/javascript" src="/static/js/korean-lunar-calendar.min.js"></script>
    <script type="text/javascript" src="/static/js/global.js"></script>
    <script type="text/javascript" src="/static/js/fileTree.js"></script>

    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-calendar/master/dist/ax5calendar.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-picker/master/dist/ax5picker.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-menu/master/dist/ax5menu.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-formatter/master/dist/ax5formatter.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-combobox/master/dist/ax5combobox.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-select/master/dist/ax5select.min.js"></script>
    <!-- 도움말 팝업 -->
    <script src="/static/js/manualPopup.js"></script>

</head>

<body>
	<div id="head_area"></div>
	<div id="top_area"></div>
	
	<div id="main_area">
		<!-- 페이지 상단 -->
		<div class="contents no_bg">
			<ul class="btn_ul">
				<li class="btn_r">
				     <a onclick="manualPopup();"> <button type="button" class="bg_gray" onclick="manualPopup();">도움말</button> </a>
					 <a onclick="initSearch();"><button class="bg_gray">초기화</button></a>
					 <a onclick="gridView.setData(0);"><button class="bg_gray">검 색</button></a>
	            </li>
            </ul>
        </div>
    
		<!-- 검색 콘텐츠 -->
		<div class="contents search">
			<div class="">
				<!-- 테이블 인풋 3분할 -->
				<table class="table_input type04">
				
					<!-- 검색조건 1행 -->
					 <tr>
                        <th style="width:80px;">회사</th>
                        <td style="width:200px;">
                           <select id="coCd_S" name="coCd_S" data-kind="CO" data-search="coCd" required msg="회사" onChange="gridView.setData(0);changeCocd();">
                           </select>
                        </td>
                        <th class="">고객사</th>
						<td>
							<input type="hidden" id="ordrsClntCd_S" name="ordrsClntCd_S" data-search="ordrsClntCd">
							<div class="search_form">
								<input type="text" id="ordrsClntNm_S" name="ordrsClntNm_S" data-search="ordrsClntNm" onkeyup="event.keyCode == 8 ? ordrsClntCd_S.value = '' : event.keyCode == 13 ? DataSearch() : ''">
								<a onclick="opendClntSearch($('#ordrsClntNm_S').val());"><i class="i_search_w"></i></a>
							</div>
						</td>
						<th>고객사PJT</th>
						<td>
                            <select id="clntPjt_S" name="clntPjt_S" data-kind="PRJCTCD" data-search="clntPjt" onchange="gridView.setData(0);">
								<option value="">전체</option>
							</select>
						</td>
                        <th  style="width:90px;">Sales Code</th>
                        <td style="width:200px;">
                            <div class="search_form">
                                <input type="text" id="salesCd_S" name="salesCd_S" data-search="salesCd" onkeyup="event.keyCode == 13 ? gridView.setData(0) : ''">
                                <a onclick="wbsSalesCodeSearch('S');"><i class="i_search_w"></i></a>
                            </div>
                            <input type="hidden" id="salesNm_S" name="salesNm_S" >
                        </td>
                    </tr>
                    <!-- 검색조건 2행 -->
					<tr>
						<th style="width:100px;">과제 시작일</th>
                        <td >
                        <div style="width:400px;">
                          <input type="text" class="input_calendar" id="beginDt_S" name="beginDt_S" data-search="beginDt_S" autocomplete="off" date onkeyup="dateMask(this);">
                          <span>~</span>
                          <input type="text" class="input_calendar" id="deDt_S" name="deDt_S" data-search="deDt_S"  autocomplete="off" date onkeyup="dateMask(this);">
                        </div>
                        </td>
                        
                        <td></td><td></td>
                        <th style="width:100px;">평가대상</th>
                        <td>
                        <select id="wbsCloseYn_S" name="wbsCloseYn_S" data-search="wbsCloseYn_S" onChange="gridView.setData(0);">
                            <option value="">선택</option>
                            <option value="Y">Y</option>
                            <option value="N">N</option>                            
                        </select>
                        </td>
                        
                        <th style="width:100px;">평가완료</th>
                        <td>
                        <select id="closeYn_S" name="closeYn_S" data-search="closeYn_S" onChange="gridView.setData(0);">
                            <option value="">선택</option>
                            <option value="Y">Y</option>
                            <option value="N">N</option>                            
                        </select>
                        </td>
					</tr>
		            <!-- 검색조건 END -->
	            </table>
	            <input type="hidden" id="userId"    name="userId">
                <input type="hidden" id="pgmId"     name="pgmId" value="WB2501M01">
            </div>
        </div>

    <div class="contents no_bg">
              <div class="contents_tit">
                <div class="add_btn_small pdl10">
                  <a id="cretTaskEvl" onclick="wbsTaskEvlInsert();" style="height: 30px; line-height: 28px; width: 80px;"><i class="fas fa-tasks"></i> 과제 평가</a>
                  <a id="closeTaskEvl" onclick="closeYn();" style="height: 30px; line-height: 28px; width: 80px;"><i class="fas fa-check-square"></i> 평가완료</a>
                  <a onclick="excelDown();" style="height: 30px; line-height: 28px; width: 90px;"><i class="fas fa-file-excel"></i> 엑셀다운로드</a>
                  
                </div>
                <select id="recordCnt" style="height: 30px;" class="prae_select" onchange="gridView.setData(0);">
                  <option value="25" >25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                  <option value="9999999" selected>전체</option>
                </select> 
    </div>
        
     <div class="contents" style="margin: 0px; padding: 0px; height: 100%; width: 100%; min-width: 660px;">
         <div class="ax5_grid" data-ax5grid="first-grid" data-ax5grid-config="{}" style="width: 100%; height: 660px;"></div>
         <div data-ax5grid="excel-grid" data-ax5grid-config="{}" style="display: none;"></div>            
     </div>
    </div>	
    </div>         
</body>
</html>

<script type="text/javascript">
 var isFirst = true;
 var coCd = null;
 var salesCd = null;

 ax5.ui.grid.formatter["chkYn"] = function () {
	    var color = this.value == "Y" ? "color-circle_02.png" : "";
	    if (this.value != "Y"){
	        return ' ';
	    } else {
	        return '<img src="/static/img/'+color+'" style="width: 10px;height: 10px;"></img>';
	    }
	};
	var gridView = {
		    initView : function() {
		        this.target = new ax5.ui.grid();
		        this.target.setConfig({
		        	showRowSelector: true,
		            multipleSelect: false,
	                sortable          : false,
		            target: $('[data-ax5grid="first-grid"]'),
		            header : {
		                align : "center",
		                selector : false
		            },
		            body: {
		            	mergeCells : ["clntNm","clntPjt","ordrsNo"],
		            	columnHeight: 26,
		                onClick: function () {	
		                	this.self.clearSelect();
		                    this.self.select(this.dindex);
		                	coCd = this.item.coCd;
		                	salesCd = this.item.salesCd; 
		                },
		                onDBLClick: function () {
		                	this.self.clearSelect();
                            this.self.select(this.dindex);
                            coCd = this.item.coCd;
                            salesCd = this.item.salesCd;
                            if (this.item.fileTrgtKey != undefined) {
                            	wbsTaskEvlUpdate();
                            }
                            else {
                            	wbsTaskEvlInsert();	
                            }                            
		                },
		                onDataChanged: function () {
                        }
		           },
		           columns: [
		        	    {key: "coCd",             label: "회사코드",          hidden:true},
		                {key: "coCdNm",             label: "회사명",        hidden:true},
		                {key: "evlId",           label: "평가자",     hidden:true},                        
		                {key: "clntNm",           label: "고객명",           width: 100,  align: "center"},    
		                {key: "clntCd",              label: "고객코드",       hidden:true},
		                {key: "clntPjtNm",             label: "고객사프로젝트",  width: 110,    align: "center"},
		                {key: "ordrsNo",          label: "수주번호",          width: 80,   align: "center"},
		                {key: "fileTrgtKey",              label: "FILE TRGT KEY",       hidden:true},
		                {key: "sjFileTrgtKey",              label: "과제 FILE TRGT KEY",       hidden:true},
		                {label: "과제정보", columns: [ 
		                	{key: "salesCd",           label: "SALES CODE",     width: 110,    align: "center"},                
	                        {key: "sjNm",           label: "과제명",     width: 110,    align: "left"},
	                        {key: "verNo",           label: "Ver.",     width: 40,    align: "center"},
	                        {key: "beginDt",           label: "과제시작일",     width: 80,    align: "center"},
	                        {key: "deDt",           label: "출고일",     width: 80,    align: "center"},
	                        {key: "acptncDt",           label: "완료검수일",     width: 80,    align: "center"},
	                        {key: "smrizeNm",           label: "총괄PM",     width: 80,    align: "center"},
	                        {key: "reqreDaycnt",           label: "소요일수",     width: 60,    align: "right"},  	                        
	                    ]},		                
                        {label: "실적정보", columns: [ 
                    	   {key: "rsltssDt",           label: "시작일",     width: 80,    align: "center"},
                           {key: "rsltseDt",           label: "종료일",     width: 80,    align: "center"},
                           {key: "rsltDaycnt",           label: "소요일수",     width: 80,    align: "right"},
                           {key: "rsltsMh",           label: "공수",     width: 80,    align: "right", formatter: "money"},
                        ]},	                        
                        {label: "평가정보", columns: [ 
                        	{key: "wbsCloseYn",           label: "평가대상",     width: 60,    align: "center"},   
                        	{key: "planCloseYn",           label: "평가완료",     width: 60,    align: "center", formatter: "chkYn"},  
                            {key: "evlDt",           label: "평가일자",     width: 80,    align: "center"},
                            {key: "evlNm",           label: "평가자",     width: 80,    align: "center"},
                            {key: "evlCnts",           label: "평가내용",     width: 300,    align: "left"},
                            
                        ]},                        
                        {label: "이슈정보", columns: [ 
                        	{key: "planCnt",           label: "계획이슈",     width: 80,    align: "right"},
                            {key: "rlstCnt",           label: "실적이슈",     width: 80,    align: "right"},
                            {key: "fileTrgtKey",           label: "FILE_TRGT_KEY",     hidden:true},
                        ]},               
		           ],
		           page : {
		        	   navigationItemCount: 10,
	                    height: 30,
	                    display: true,
	                    firstIcon: '<i class="fa fa-step-backward" aria-hidden="true"></i>',
	                    prevIcon: '<i class="fa fa-caret-left" aria-hidden="true"></i>',
	                    nextIcon: '<i class="fa fa-caret-right" aria-hidden="true"></i>',
	                    lastIcon: '<i class="fa fa-step-forward" aria-hidden="true"></i>',
	                    onChange: function () {
	                    	gridView.setData(this.page.selectPage);
	                    }
	                },
		        });
		        return this;
		    },
		    setData : function(_pageNo) {
		    	if (isFirst) return;
	            var targetObj = this.target;
    			var paramObj = {
    					"coCd": $('#coCd_S').val(),
    					"ordrsClntNm" : $('#ordrsClntNm_S').val(),
    					"salesCd": $('#salesCd_S').val(),
    					"clntPjt": $('#clntPjt_S').val(),
    					"beginDt": $('#beginDt_S').val(),
    					"deDt": $('#deDt_S').val(),
    					"closeYn": $('#closeYn_S').val(),
    					"wbsCloseYn": $('#wbsCloseYn_S').val(),
    					"pageNo" : _pageNo + 1,
                        "recordCnt": $('#recordCnt').val()
    			};
	            postAjax("/user/wb/wb25/selectWbsTaskEvlList", paramObj, null, function(data){
	            	 var list = data.fileList;
	                    targetObj.setData({
	                        list : list,
	                        page : {
	                        	currentPage   : _pageNo,
	                            pageSize      : data.paginationInfo.pageSize,
	                            totalElements : data.paginationInfo.totalRecordCount,
	                            totalPages    : data.paginationInfo.totalPageCount
	                        }
	                    });
	            });
	        } 
		    
		}
	
	var excelView = {
            initView: function(){
            this.target = new ax5.ui.grid();
            this.target.setConfig({
            target: $('[data-ax5grid="excel-grid"]'),
            columns: [
            	{key: "coCd",             label: "회사코드",          hidden:true},
                {key: "coCdNm",             label: "회사명",        hidden:true},
                {key: "clntNm",           label: "고객명",           width: 100,  align: "center"},    
                {key: "clntCd",              label: "고객코드",       hidden:true},
                {key: "clntPjt",             label: "고객사프로젝트",  width: 110,    align: "center"},
                {key: "ordrsNo",          label: "수주번호",          width: 80,   align: "center"},
                {key: "salesCd",           label: "SALES CODE",     width: 110,    align: "center"},                
                {key: "sjNm",           label: "과제명",     width: 110,    align: "left"},
                {key: "verNo",           label: "Ver.",     width: 40,    align: "center"},
                {key: "beginDt",           label: "시작일",     width: 80,    align: "center"},
                {key: "deDt",           label: "출고일",     width: 80,    align: "center"},
                {key: "acptncDt",           label: "완료검수일",     width: 80,    align: "center"},
                {key: "smrizeNm",           label: "총괄PM",     width: 80,    align: "center"},
                {key: "reqreDaycnt",           label: "소요일수",     width: 60,    align: "center"},                
                {key: "dsgnPlanHour",           label: "설계계획공수",     width: 80,    align: "center"},
                {key: "prdctnPlanHour",           label: "생산계획공수",     width: 80,    align: "center"}, 
                {key: "wbsCloseYn",           label: "평가대상",     width: 60,    align: "center"},   
                {key: "closeYn",           label: "평가확정",     width: 60,    align: "center"},                
                {key: "evlDt",           label: "평가일자",     width: 80,    align: "center"},
                {key: "evlNm",           label: "평가자",     width: 80,    align: "center"},
                {key: "planCnt",           label: "계획이슈",     width: 80,    align: "center"},
                {key: "rlstCnt",           label: "실적이슈",     width: 80,    align: "center"},
                {key: "evlCnts",           label: "평가내용",     width: 300,    align: "left"},
                {key: "fileTrgtKey",           label: "FILE_TRGT_KEY",     hidden:true},
            ],
            });
            return this;
        }
    }        
	
	$(document).ready(function() {

		 mainDefaultLoad("실행계획", "과제평가");          // 페이지 타이틀 설정
		 setCommonSelect($("#main_area select[data-kind]"));     // 공통코드 set

		 //alert(jwt.coCd);
		 
		 isFirst = false;    
		 
		 $("#coCd_S").val(jwt.coCd);
		 
		 $('#beginDt_S').datepicker({
		        format : "yyyy-mm-dd",
		        language : "ko",
		        autoclose : true
		      })
		     .datepicker("setDate", moment(new Date()).startOf("month").toDate())
		     .on("changeDate", function(){
		         if($('#beginDt_S').val() > $('#deDt_S').val()){
		             alert("시작일과 종료일를 확인해주세요");
		             $('#beginDt_S').datepicker("setDate", new Date($('#deDt_S').val()));
		         }
		         gridView.setData(0);
		      });
		     
	     $('#deDt_S').datepicker({
	        format : "yyyy-mm-dd",
	        language : "ko",
	        autoclose : true
	      })
	     .datepicker("setDate",  moment(new Date()).endOf("month").toDate())
	     .on("changeDate", function(){
                 if($('#beginDt_S').val() > $('#deDt_S').val()){
                     alert("시작일과 종료일를 확인해주세요");
                     $('#beginDt_S').datepicker("setDate", new Date($('#deDt_S').val()));
                 }
                 gridView.setData(0);
              });
		     
		     
		 gridView.initView().setData(0);
		 
		 excelView.initView()
		 
		 
		 //권한체크
		 authChk();

		});
	// 초기화 버튼용
    function initSearch() {
        $('[data-search]').off("change");   //바인딩기능 오프
        $('.contents.search select, .contents.search input').val("");
        $("#beginDt_S").val(dateToStr(moment(new Date()).startOf("month").toDate()));
        $("#deDt_S").val(dateToStr(moment(new Date()).endOf("month").toDate()));
        $("#coCd_S").val(jwt.coCd);

        gridView.initView().setData(0);
    }
	
    function excelDown() {
    	var paramObj = {
    			"coCd": $('#coCd_S').val(),
                "ordrsClntNm" : $('#ordrsClntNm_S').val(),
                "salesCd": $('#salesCd_S').val(),
                "clntPjt": $('#clntPjt_S').val(),
                "beginDt": $('#beginDt_S').val(),
                "deDt": $('#deDt_S').val(),
                "closeYn": $('#closeYn_S').val(),
                //"pageNo" : _pageNo + 1,
                "recordCnt": 99999999
        };
        postAjax("/user/wb/wb25/selectWbsTaskEvlList", paramObj, null, function(data){
            var list = data.fileList;
            excelView.target.setData({
               list : list,
               page : {
                         totalElements : list.length,
               }
            });
            var todayDate = new Date().format('yyyyMMddHHmmss');
            excelView.target.exportExcel("WBS_과제 평가 리스트"+todayDate+".xls");
         });   
    }       
    
	function wbsSalesCodeSearch() {
        var paramObj = {
           "coCd" : $('#coCd_S').val(),
           "salesCd": $('#salesCd_S').val()
        };
        openSecondModal("/static/html/cmn/modal/wbsSalesCodeSearch.html", 1068, 650, "SALES CODE 검색", paramObj, function (grid){
            var row = grid.target.getList("selected")[0];
            $('#salesCd_S').val(row.salesCd);
            gridView.setData(0);
        });
    }
    
	// 거래처 검색 함수
	function opendClntSearch(inputValue) {
		var paramObj = {
	            "searchValue" : inputValue,
	            "clntDivCd"   : "CLNTDIV12"
	        };
		openModal("/static/html/cmn/modal/clntSearch.html", 600, 420, "거래처 검색", paramObj, function(grid) {
			var row = grid.target.getList("selected")[0];
			$('#ordrsClntCd_S').val(row.clntCd);
			$('#ordrsClntNm_S').val(row.clntNm);
			gridView.setData(0);
		});
	}
	
	
	function wbsTaskEvlInsert() {
        var row = gridView.target.getList("selected")[0];
        if (row != undefined) {
        	if (row.wbsCloseYn == "N") {
                alert("WBS 일정이 진행 중입니다. 완료검수 후 평가 가능합니다.");
                return; 
            }
        	
        	if (row.evlDt != undefined) {
        		//alert("평가 내용이 존재합니다.");
        		var paramObj = {"actionType":"U",
                            "coCd": row.coCd,
                            "salesCd": row.salesCd  
                    };
	            openSecondModal("/static/html/user/wb/wb25/WB2501P01.html", 1500, 700, "WBS 과제 평가 수정", paramObj, function (){                    
	            });
                return;    
        	}
        	
        	if (row.planCloseYn == "Y") {
                alert("평가완료된 상태입니다.");
                return; 
            }
        	
        	var paramObj = {
        			"actionType":"C",
        			"coCd": row.coCd,
                    "salesCd": row.salesCd                    
                   };
            openSecondModal("/static/html/user/wb/wb25/WB2501P01.html", 1500, 700, "WBS 과제 평가 등록", paramObj, function (){            	
            });
        }
        else {
            alert("SALES CODE을 선택하세요");
        }
    }
	
	function wbsTaskEvlUpdate() {		
        var row = gridView.target.getList("selected")[0];
        console.log(row);
        if (row != undefined) {
        	// 평가완료 N일때 평가 등록
//         	if (row.planCloseYn == "N") {
//         		var paramObj = {
//                         "actionType":"C",
//                         "coCd": row.coCd,
//                         "salesCd": row.salesCd                    
//                        };
//                 openSecondModal("/static/html/user/wb/wb25/WB2501P01.html", 1500, 700, "WBS 과제 평가 등록", paramObj, function (){               
//                 });
//             }
//         	else {
        		var paramObj = {"actionType":"U",
                        "coCd": row.coCd,
                        "salesCd": row.salesCd  
                };
		        openSecondModal("/static/html/user/wb/wb25/WB2501P01.html", 1500, 700, "WBS 과제 평가 수정", paramObj, function (){                    
		        });
//         	}        	           
        }
    }
	
	
	function closeYn() { //평가완료
        var row = gridView.target.getList("selected")[0];
        if (row != undefined){
        	// 평가완료 대상 체크
        	if (row.planCloseYn == "Y") {
        		alert("평가 완료된 내역을 선택하였습니다.");
                return;
        	}
        	// 평가대상 체크
        	else if (row.wbsCloseYn == "N") {
        		alert("평가완료 대상이 아닙니다.");
                return;
        	}
        	// 평가대상 체크 "Y" and 평가자료 없는경우
        	else if (row.wbsCloseYn == "Y" && row.evlDt == undefined) {
        		alert("평가 내역이 존재하지 않습니다.");
                return;
        	}
        	
        	var rowListArr = [];
        	if(confirm("평가완료 처리하시겠습니까?")){
                var formData = new FormData();
                $.each(row, function(idx, elem){
                	const obj = {
                            coCd: row.coCd, 
                            salesCd:row.salesCd, 
                            fileTrgtKey:row.fileTrgtKey, 
                            state:"Y",
                            userId:jwt.userId,
                            pgmId:"WB2501M01"
                        };
                    rowListArr.push(obj);             
                });
                formData.append("rowListArr", JSON.stringify(rowListArr));
                filePutAjax("/user/wb/wb25/wbsTaskEvlCloseYnConfirm", formData, function(data){
                    if(data.resultCode == 200){
                        alert("평가완료 처리되었습니다.");       
                        gridView.setData(0);
                    }
                 }); 
            }         	
        }
        
        
        
	      /* var rowListArr = [];
	      if(list.length > 0) {
	          if(confirm("평가완료 처리하시겠습니까?")){
	              var formData = new FormData();
	              $.each(list, function(idx, elem){
	                  var row = gridView.target.getList()[elem.__index];
	                  if (row != undefined && row.fileTrgtKey != undefined) {
	                      const obj = {
	                   		            coCd: row.coCd, 
	                   		            salesCd:row.salesCd, 
	                   		            fileTrgtKey:row.fileTrgtKey, 
	                   		            state:"Y",
	                   		            userId:jwt.userId,
	                   		            pgmId:"WB2501M01"
	                   		        };
	                      rowListArr.push(obj);
	                  }               
	              });
	              formData.append("rowListArr", JSON.stringify(rowListArr));
	              filePutAjax("/user/wb/wb25/wbsTaskEvlCloseYnConfirm", formData, function(data){
	                  if(data.resultCode == 200){
	                      alert("평가완료 처리되었습니다.");       
	                      gridView.setData(0);
	                  }
	               }); 
	          } 
	      } 	     */   
	}   
	     
	//회사 변경시 등록, 평가 버튼 기능 잠금
	function changeCocd() {
	    if($("#coCd_S").val() == jwt.coCd){
	        $("#cretTaskEvl").show();
	        $("#closeTaskEvl").show();
	    }else{
	    	$("#cretTaskEvl").hide();
            $("#closeTaskEvl").hide();
	    }
	} 
	   
	   
</script>
