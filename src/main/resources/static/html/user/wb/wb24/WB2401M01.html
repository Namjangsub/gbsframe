<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="/static/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/static/fontawesome/css/all.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5grid.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5mask.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5modal.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5toast.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5menu.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5calendar.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5picker.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5select.css">
    <link rel="stylesheet" href="/static/css/jstree/style.min.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5combobox.css">
    <link rel="stylesheet" href="/static/css/gnb.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/sub.css">
    <link rel="stylesheet" href="/static/css/common.css">

    <script type="text/javascript" src="/static/js/jquery-latest.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.serializeObject.js"></script>
    <script type="text/javascript" src="/static/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
    <script type="text/javascript" src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
    <script type="text/javascript" src="/static/js/moment/moment-with-locales.js"></script>
    <script type="text/javascript" src="/static/js/jstree/jstree.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5core.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5grid.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5mask.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5modal.min.js"></script>
    <script type="text/javascript" src="/static/js/ax5/ax5toast.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.5.0/jszip.min.js"></script>
    <script type="text/javascript" src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js" ></script>
    <script type="text/javascript" src="/static/js/workingDayCalc.js"></script>
	<script type="text/javascript" src="/static/js/korean-lunar-calendar.min.js"></script>
    <script type="text/javascript" src="/static/js/global.js"></script>
    <script type="text/javascript" src="/static/js/fileTree.js"></script>

    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-calendar/master/dist/ax5calendar.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-picker/master/dist/ax5picker.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-menu/master/dist/ax5menu.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-formatter/master/dist/ax5formatter.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-combobox/master/dist/ax5combobox.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-select/master/dist/ax5select.min.js"></script>
    <!-- 도움말 팝업 -->
    <script src="/static/js/manualPopup.js"></script>

</head>

<body>
	<div id="head_area"></div>
	<div id="top_area"></div>
	
	<div id="main_area">
		<!-- 페이지 상단 -->
		<div class="contents no_bg">
			<ul class="btn_ul">
				<li class="btn_r">
				     <a onclick="manualPopup();"> <button type="button" class="bg_gray" onclick="manualPopup();">도움말</button> </a>
					 <a onclick="initSearch();"><button class="bg_gray">초기화</button></a>
					 <a onclick="salesGridView.setData(0);"><button class="bg_gray">검 색</button></a>
	            </li>
            </ul>
        </div>
    
		<!-- 검색 콘텐츠 -->
		<div class="contents search">
			<div class="">
				<!-- 테이블 인풋 3분할 -->
				<table class="table_input type04">
				
					<!-- 검색조건 1행 -->
					 <tr>
                        <th class="hit" style="width:80px;">회사</th>
                        <td style="width:200px;">
                           <select id="coCd_S" name="coCd_S" data-kind="CO" data-search="coCd" required msg="회사" onChange="gridView.setData(0);">
                           </select>
                        </td>
                        <th class="">고객사</th>
						<td>
							<input type="hidden" id="ordrsClntCd_S" name="ordrsClntCd_S" data-search="ordrsClntCd">
							<div class="search_form">
								<input type="text" id="ordrsClntNm_S" name="ordrsClntNm_S" data-search="ordrsClntNm" onkeyup="event.keyCode == 8 ? ordrsClntCd_S.value = '' : event.keyCode == 13 ? DataSearch() : ''">
								<a onclick="opendClntSearch($('#ordrsClntNm_S').val());"><i class="i_search_w"></i></a>
							</div>
						</td>
						<th>고객사PJT</th>
						<td>
                            <select id="clntPjt_S" name="clntPjt_S" data-kind="PRJCTCD" data-search="clntPjt" onchange="salesGridView.setData(0);">
								<option value="">전체</option>
							</select>
						</td>
                        <th class= "hit" style="width:90px;">Sales Code</th>
                        <td style="width:200px;">
                            <div class="search_form">
                                <input type="text" id="salesCd_S" name="salesCd_S" data-search="salesCd" onkeyup="event.keyCode == 13 ? salesGridView.setData(0) : ''">
                                <a onclick="wbsSalesCodeSearch('S');"><i class="i_search_w"></i></a>
                            </div>
                            <input type="hidden" id="salesNm_S" name="salesNm_S" >
                        </td>
                    </tr>
                    <!-- 검색조건 2행 -->
					<tr>
						<th style="width:100px;">실적 시작일</th>
                        <td >
                        <div style="width:400px;">
                          <input type="text" class="input_calendar" id="wbsRsltssDt_S" name="wbsRsltssDt_S" data-search="wbsRsltssDt_S" autocomplete="off" date data-search="wbsRsltssDt" >
                          <span>~</span>
                          <input type="text" class="input_calendar" id="wbsRsltseDt_S" name="wbsRsltseDt_S" data-search="wbsRsltseDt_S"  autocomplete="off" date data-search="wbsRsltseDt" >
                        </div>
                        </td>
                        
                        <td></td><td></td>
                        
                        <th style="width:100px;">진행상태</th>
                        <td>
                        <select id="issSts_S" name="issSts_S" data-search="issSts_S" data-kind="ISSSTS" onChange="salesGridView.setData(0);">
                            <option value="">선택</option>                            
                        </select>
                        </td>
					</tr>
		            <!-- 검색조건 END -->
	            </table>
	            <input type="hidden" id="userId"    name="userId">
                <input type="hidden" id="pgmId"     name="pgmId" value="WB2401M01">
            </div>
        </div>

    <div class="contents no_bg">
              <div class="contents_tit">
                <div class="add_btn_small pdl10">
                  <a onclick="wbsIssueInsertModal();" style="height: 30px; line-height: 28px; width: 80px;">계획이슈등록</a>
                  <a onclick="wbsRsltsInsertModal();" style="height: 30px; line-height: 28px; width: 80px;">실적이슈등록</a>
                  <a onclick="excelDown();" style="height: 30px; line-height: 28px; width: 90px;"><i class="fas fa-file-excel"></i> 엑셀다운로드</a>
                  
                </div>
                <select id="recordCnt" class="prae_select" onchange="salesGridView.setData(0);">
                  <option value="25" >25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                  <option value="9999999" selected>전체</option>
                </select> 
    </div>
        
     <div class="contents" style="margin: 0px; padding: 0px; height: 100%; width: 100%; min-width: 660px;">
         <div class="ax5_grid" data-ax5grid="sales-grid" data-ax5grid-config="{}" style="width: 100%; height: 660px;"></div>
         <div data-ax5grid="excel-grid" data-ax5grid-config="{}" style="display: none;"></div>            
     </div>
    </div>	
    </div>         
</body>
</html>

<script type="text/javascript">
 var isFirst = true;
 var coCd = null;
 var salesCd = null;

 ax5.ui.grid.formatter["chkYn"] = function () {
	    var color = this.value == "Y" ? "color-circle_02.png" : "color-circle_01.png";
	    if (this.value == "E"){
	        return ' ';
	    } else {
	        return '<img src="/static/img/'+color+'" style="width: 10px;height: 10px;"></img>';
	    }
	};
	var salesGridView = {
		    initView : function() {
		        this.target = new ax5.ui.grid();
		        this.target.setConfig({
		        	showRowSelector: true,
		            multipleSelect: true,
	                sortable          : false,
		            target: $('[data-ax5grid="sales-grid"]'),
		            header : {
		                align : "center",
		                selector : false
		            },
		            body: {
		            	mergeCells : ["clntNm","sjNo","sjNm","salesCd","clntPjtNm", "wbsPlanCodeNm"],
		            	columnHeight: 26,
		                onClick: function () {	
		                	this.self.clearSelect();
		                    this.self.select(this.dindex);
		                	coCd = this.item.coCd;
		                	salesCd = this.item.salesCd; 
		                },
		                onDBLClick: function () {
		                	this.self.clearSelect();
                            this.self.select(this.dindex);
                            
                            coCd = this.item.coCd;
                            salesCd = this.item.salesCd;
                            if (this.item.gbnNm == "계획") {
                            	wbsIssueUpdateModal();
                            }
                            else {
                            	wbsRsltsUpdateModal();
                            }
		                },
		                onDataChanged: function () {
                        }
		           },
		           columns: [
		        	   {key: "clntNm",           label: "고객명",           width: 100,  align: "center"},                       
			       	   {key: "upperCd",          label: "상위코드",          hidden:true},
                       {key: "lowerCd",          label: "하위코드",          hidden:true},
                       {key: "coCd",             label: "회사코드",          hidden:true},
                       {key: "ordrsNo",          label: "수주번호",          hidden:true},
                       {key: "title",               label: "수주번호",          hidden:true},
                       {key: "clntCd",              label: "고객코드",          hidden:true},
                       {key: "clntPjt",             label: "고객사프로젝트",      hidden:true},
                       {key: "clntPjtNm",           label: "프로젝트명",     width: 110,   align: "center"},
                       {key: "sjNo",                label: "과제번호",          hidden:true},
                       {key: "verNo",               label: "Ver.",          hidden:true},
                       {key: "sjCloseYn",           label: "과제확정",       hidden:true},
                       {key: "sjNm",                label: "과제명",           width: 200,   align: "left"},
			       	   {key: "salesCd",           label: "SALES CODE",     width: 110,   align: "center"},
		               {key: "wbsPlanCodeKind",          label: "상위코드",   hidden:true},
		               {key: "wbsPlanCodeId",          label: "실적명",   hidden:true},
		               {key: "wbsRsltsId",          label: "담당자",       hidden:true},
		               {key: "wbsRsltsNo",          label: "실적번호",       hidden:true},
		               {label: "구분", columns: [ 
		            	   {key: "wbsPlanCodeNm",          label: "TASK명",   width: 150,   align: "left"},                           
		            	   {key: "gbnNm",          label: "구분",   width: 60,   align: "center"},
		            	   {key: "wbsDatesDt",          label: "시작일",       width: 100,   align: "center"},
                           {key: "wbsDateeDt",          label: "종료일",       width: 100,   align: "center"},
                           {key: "wbsMngNm",          label: "담당자",       width: 80,   align: "center"},
                           {key: "rsltsCloseYn",          label: "실적확정",       width: 60,   align: "center", formatter: "chkYn"},
                       ]},
                       {key: "issFileTrgtKey",          label: "FileTrgtKey",   hidden:true},
                       {key: "issDiv",          label: "이슈유형",       hidden:true},
                       {key: "actId",          label: "담당자",       hidden:true},
                       {key: "issSts",          label: "진행상태",       hidden:true},
                       {key: "issNo",          label: "이슈번호",   hidden:true},                               
                       
                       {label: "이슈", columns: [ 
                    	   {label: "이슈정보", columns: [
                    		   {key: "issStsNm",          label: "진행상태",       width: 60,   align: "center"},                               
                    		   {key: "issSj",           label: "제목",      width: 200,   align: "left"},
                    		   {key: "issDivNm",          label: "유형",       width: 80,   align: "center"},
	                           {key: "issCnts",          label: "내용",       width: 230,   align: "left"},	                           
                           ]},
                           {label: "조치내역", columns: [
                        	   {key: "actNm",          label: "담당자",       width: 70,   align: "center"},                                                              
                               {key: "actsDt",          label: "시작일",   width: 80,   align: "center"},
                               {key: "acteDt",          label: "종료일",       width: 80,   align: "center"},
                               {key: "actMh",          label: "투입공수",       width: 70,   align: "right", formatter: "money"},
                               {key: "actAmt",          label: "투입비용",       width: 70,   align: "right", formatter: "money"},
                               {key: "actCnts",          label: "조치내용",       width: 150,   align: "left"},
                               
                           ]},
                       ]},
                       
		           ],
		           page : {
		        	   navigationItemCount: 10,
	                    height: 30,
	                    display: true,
	                    firstIcon: '<i class="fa fa-step-backward" aria-hidden="true"></i>',
	                    prevIcon: '<i class="fa fa-caret-left" aria-hidden="true"></i>',
	                    nextIcon: '<i class="fa fa-caret-right" aria-hidden="true"></i>',
	                    lastIcon: '<i class="fa fa-step-forward" aria-hidden="true"></i>',
	                    onChange: function () {
	                    	salesGridView.setData(this.page.selectPage);
	                    }
	                },
		        });
		        return this;
		    },
		    setData : function(_pageNo) {
		    	if (isFirst) return;
	            var targetObj = this.target;
    			var paramObj = {
    					"coCd": $('#coCd_S').val(),
    					"ordrsClntNm" : $('#ordrsClntNm_S').val(),
    					"salesCd": $('#salesCd_S').val(),
    					"clntPjt": $('#clntPjt_S').val(),
    					"wbsRsltssDt": $('#wbsRsltssDt_S').val(),
    					"wbsRsltseDt": $('#wbsRsltseDt_S').val(),
    					"issSts": $('#issSts_S').val(),
    					"pageNo" : _pageNo + 1,
                        "recordCnt": $('#recordCnt').val()
    			};
	            postAjax("/user/wb/wb24/selectWbsIssueList", paramObj, null, function(data){
	            	 var list = data.fileList;
	                    targetObj.setData({
	                        list : list,
	                        page : {
	                        	currentPage   : _pageNo,
	                            pageSize      : data.paginationInfo.pageSize,
	                            totalElements : data.paginationInfo.totalRecordCount,
	                            totalPages    : data.paginationInfo.totalPageCount
	                        }
	                    });
	            });
	        } 
		    
		}
	
	var excelView = {
            initView: function(){
            this.target = new ax5.ui.grid();
            this.target.setConfig({
            target: $('[data-ax5grid="excel-grid"]'),
            columns: [
                {key: "clntNm",           label: "고객명",           width: 100,  align: "center"},                       
                {key: "upperCd",          label: "상위코드",          hidden:true},
                {key: "lowerCd",          label: "하위코드",          hidden:true},
                {key: "coCd",             label: "회사코드",          hidden:true},
                {key: "ordrsNo",          label: "수주번호",          hidden:true},
                {key: "title",               label: "수주번호",          hidden:true},
                {key: "clntCd",              label: "고객코드",          hidden:true},
                {key: "clntPjt",             label: "고객사프로젝트",      hidden:true},
                {key: "clntPjtNm",           label: "고객사 프로젝트명",     hidden:true},
                {key: "sjNo",                label: "과제번호",          hidden:true},
                {key: "verNo",               label: "Ver.",          hidden:true},
                {key: "sjCloseYn",           label: "과제확정",       hidden:true},
                {key: "sjNm",                label: "과제명",           width: 200,   align: "left"},
                {key: "salesCd",           label: "SALES CODE",     width: 110,   align: "center"},
                {key: "wbsPlanCodeKind",          label: "상위코드",   hidden:true},
                {key: "wbsPlanCodeId",          label: "실적명",   hidden:true},
                {key: "wbsRsltsId",          label: "담당자",       hidden:true},
                {key: "wbsRsltsNo",          label: "실적번호",       hidden:true},
                {label: "실적", columns: [ 
                    {key: "wbsPlanCodeNm",          label: "실적명",   width: 150,   align: "left"},
                    {key: "wbsRsltssDt",          label: "시작일",       width: 100,   align: "center"},
                    {key: "wbsRsltseDt",          label: "종료일",       width: 100,   align: "center"},
                    {key: "wbsRsltsNm",          label: "담당자",       width: 80,   align: "center"},
                    {key: "rsltsCloseYn",          label: "실적확정",       width: 60,   align: "center"},
                ]},
                {key: "issFileTrgtKey",          label: "FileTrgtKey",   hidden:true},
                {key: "issDiv",          label: "이슈유형",       hidden:true},
                {key: "actId",          label: "담당자",       hidden:true},
                {key: "issSts",          label: "진행상태",       hidden:true},
                {key: "issNo",          label: "이슈번호",   hidden:true},                               
                
                {label: "이슈", columns: [ 
                    {label: "이슈정보", columns: [
                        {key: "issStsNm",          label: "진행상태",       width: 60,   align: "center"},                               
                        {key: "issSj",           label: "제목",      width: 200,   align: "left"},
                        {key: "issDivNm",          label: "유형",       width: 80,   align: "center"},
                        {key: "issCnts",          label: "내용",       width: 230,   align: "left"},                              
                    ]},
                    {label: "조치내역", columns: [
                        {key: "actNm",          label: "담당자",       width: 70,   align: "center"},                                                              
                        {key: "actsDt",          label: "시작일",   width: 80,   align: "center"},
                        {key: "acteDt",          label: "종료일",       width: 80,   align: "center"},
                        {key: "actMh",          label: "투입공수",       width: 70,   align: "right", formatter: "money"},
                        {key: "actAmt",          label: "투입비용",       width: 70,   align: "right", formatter: "money"},
                        {key: "actCnts",          label: "조치내용",       width: 150,   align: "left"},
                        
                    ]},
                ]},
                
            ],
            });
            return this;
        }
    }        
	
	$(document).ready(function() {

		 mainDefaultLoad("WBS", "이슈관리");          // 페이지 타이틀 설정
		 setCommonSelect($("#main_area select[data-kind]"));     // 공통코드 set

		 isFirst = false;    
		 
		 $("#coCd_S").val(jwt.coCd);
		 
		 $('#wbsRsltssDt_S').datepicker({
		        format : "yyyy-mm-dd",
		        language : "ko",
		        autoclose : true
		      })
		     .datepicker("setDate", moment(new Date()).startOf("month").toDate())
		     .on("changeDate", function(){
		         if($('#wbsRsltssDt_S').val() > $('#wbsRsltseDt_S').val()){
		             alert("시작일과 종료일를 확인해주세요");
		             $('#wbsRsltssDt_S').datepicker("setDate", new Date($('#wbsRsltseDt_S').val()));
		         }
		         salesGridView.setData(0);
		      });
		     
	     $('#wbsRsltseDt_S').datepicker({
	        format : "yyyy-mm-dd",
	        language : "ko",
	        autoclose : true
	      })
	     .datepicker("setDate",  moment(new Date()).endOf("month").toDate())
	     .on("changeDate", function(){
                 if($('#wbsRsltssDt_S').val() > $('#wbsRsltseDt_S').val()){
                     alert("시작일과 종료일를 확인해주세요");
                     $('#wbsRsltssDt_S').datepicker("setDate", new Date($('#wbsRsltseDt_S').val()));
                 }
                 salesGridView.setData(0);
              });
		     
		     
		 salesGridView.initView().setData(0);
		 
		 excelView.initView()
		 
		 
		 //권한체크
		 authChk();

		});
	// 초기화 버튼용
    function initSearch() {
        $('[data-search]').off("change");   //바인딩기능 오프
        $('.contents.search select, .contents.search input').val("");
        $("#wbsRsltssDt_S").val(dateToStr(moment(new Date()).startOf("month").toDate()));
        $("#wbsRsltseDt_S").val(dateToStr(moment(new Date()).endOf("month").toDate()));
        $("#coCd_S").val(jwt.coCd);

        salesGridView.initView().setData(0);
    }
	
    function excelDown() {
    	var paramObj = {
    			"coCd": $('#coCd_S').val(),
                "salesCd": $('#salesCd_S').val(),
                "wbsRsltssDt": $('#wbsRsltssDt_S').val(),
                "wbsRsltseDt": $('#wbsRsltseDt_S').val(),
                "actCloseYn": $('#actCloseYn_S').val(),
                //"pageNo" : _pageNo + 1,
                "recordCnt": 99999999
        };
        postAjax("/user/wb/wb24/selectWbsIssueList", paramObj, null, function(data){
            var list = data.fileList;
            excelView.target.setData({
               list : list,
               page : {
                         totalElements : list.length,
               }
            });
            var todayDate = new Date().format('yyyyMMddHHmmss');
            excelView.target.exportExcel("WBS_이슈관리 리스트"+todayDate+".xls");
         });   
    }       
    
/* 	function wbsIssueInsertModal() {
		var row = salesGridView.target.getList("selected")[0];
		if (row != undefined) {
		    if (row.gbnNm == "계획") {
		    	if (row.issNo == undefined) {
                    var paramObj = {"actionType": "C3"};         
                    openSecondModal("/static/html/user/wb/wb24/WB2401P01.html", 800, 800, "WBS 이슈등록", paramObj, function (){                    
                    }); 
                }
		    	else {
		    		var paramObj = {"actionType": "U3"};         
                    openSecondModal("/static/html/user/wb/wb24/WB2401P01.html", 800, 800, "WBS 이슈수정", paramObj, function (){                    
                    }); 
		    	}
		    }
		    else {
		    	alert("선택한 행은 실적이슈 이므로 계획이슈등록을 클릭하세요");
	            return;
		    }			
		}
		else {
            alert("SALES CODE을 선택하세요");
            return;
        }
	}
	
	function wbsRsltsInsertModal() {
        var row = salesGridView.target.getList("selected")[0];
        if (row != undefined) {
            if (row.gbnNm == "실적") {
                if (row.rsltsCloseYn == "N") {
                    if (row.issNo == undefined) {
                        var paramObj = {"actionType": "C4"};         
                        openSecondModal("/static/html/user/wb/wb24/WB2401P11.html", 800, 800, "WBS 이슈등록", paramObj, function (){                    
                        }); 
                    }
                    else {
                        var paramObj = {"actionType": "U4"};         
                        openSecondModal("/static/html/user/wb/wb24/WB2401P11.html", 800, 800, "WBS 이슈수정", paramObj, function (){                    
                        }); 
                    }
                }
                else {
                    alert("실적 미확정만 이슈 등록 가능합니다.");
                    return;
                }   
            }
            else {
                alert("선택한 행은 계획이슈 이므로 실적이슈등록을 클릭하세요");
                return;
            }           
        }
        else {
            alert("SALES CODE을 선택하세요");
            return;
        }
    } */
	
	function wbsIssueInsertModal() {
        var row = salesGridView.target.getList("selected")[0];
        if (row != undefined) {
            if (row.gbnNm == "계획") {
            	var paramObj = {"actionType": "C3"};         
                openSecondModal("/static/html/user/wb/wb24/WB2401P01.html", 800, 800, "WBS 이슈등록", paramObj, function (){                    
                });
            }
            else {
                alert("선택한 행은 실적이슈 이므로 실적이슈등록을 클릭하세요");
                return;
            }           
        }
        else {
            alert("SALES CODE을 선택하세요");
            return;
        }
    }
	
    function wbsIssueUpdateModal() {
        var row = salesGridView.target.getList("selected")[0];
        if (row != undefined) {
            if (row.gbnNm == "계획" && row.issNo != undefined) {
            	var paramObj = {"actionType": "U3"};         
                openSecondModal("/static/html/user/wb/wb24/WB2401P01.html", 800, 800, "WBS 이슈수정", paramObj, function (){                    
                }); 
            }         
        }
    }
    
	function wbsRsltsInsertModal() {
        var row = salesGridView.target.getList("selected")[0];
        if (row != undefined) {
            if (row.gbnNm == "실적") {
            	if (row.rsltsCloseYn == "N") {
            		var paramObj = {"actionType": "C4"};         
                    openSecondModal("/static/html/user/wb/wb24/WB2401P11.html", 800, 800, "WBS 이슈등록", paramObj, function (){                    
                    });            		 
                }
                else {
                    alert("실적 미확정만 이슈 등록 가능합니다.");
                    return;
                }   
            }
            else {
            	alert("선택한 행은 계획이슈 이므로 계획이슈등록을 클릭하세요");
                return;
            }           
        }
        else {
            alert("SALES CODE을 선택하세요");
            return;
        }
    }
	
	function wbsRsltsUpdateModal() {
        var row = salesGridView.target.getList("selected")[0];
        if (row != undefined) {
            if (row.gbnNm == "실적" && row.rsltsCloseYn == "N" && row.issNo != undefined) {
            	var paramObj = {"actionType": "U4"};         
                openSecondModal("/static/html/user/wb/wb24/WB2401P11.html", 800, 800, "WBS 이슈수정", paramObj, function (){                    
                });
            }        
        }
    }
	
	
		
    function wbsSalesCodeSearch() {
        var paramObj = {
           "coCd" : $('#coCd_S').val(),
           "salesCd": $('#salesCd_S').val()
        };
        openSecondModal("/static/html/cmn/modal/wbsSalesCodeSearch.html", 1000, 430, "SALES CODE 검색", paramObj, function (grid){
            var row = grid.target.getList("selected")[0];
            $('#salesCd_S').val(row.salesCd);
            salesGridView.setData(0);
        });
    }
    
	// 거래처 검색 함수
	function opendClntSearch(inputValue) {
		openModal("/static/html/cmn/modal/clntSearch.html", 600, 420, "거래처 검색", {searchValue : inputValue}, function(grid) {
			var row = grid.target.getList("selected")[0];
			$('#ordrsClntCd_S').val(row.clntCd);
			$('#ordrsClntNm_S').val(row.clntNm);
			salesGridView.setData(0);
		});
	}
	
</script>
