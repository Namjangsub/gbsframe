<div id="wbsPopup" class="popup_area of_a" style="width: 100%; height: 100%;">
	<div class="tit_contents">
	    <h4 class="tit">일정계획등록</h4>
	</div>
	
	<div class="popup_table">
		<div class="form-group">
			<form id="clntForm">
		        <table class="popup_table">
					<colgroup>
					     <col width="8%">
					     <col width="12%">
					     <col width="8%">
					     <col width="12%">
					     <col width="8%">
					     <col width="12%">
					     <col width="8%">
					     <col width="12%">
					</colgroup>
					
					<thead>
						<tr>
						   <td colspan="8" style="height:30px;text-align: left;">기본정보 </td>	                                     
						</tr>
					</thead>
					
					<tbody>
					
						<!-- 1행 -->
						<tr>
							<th colspan="1" class="hit" style="height:30px;text-align: left;">Lv.1</th>
							<td colspan="3" style="height:30px;text-align: left;">
								<select id="lvl" name="lvl" data-kind="LEVEL" msg="Level1" onchange="sublvlIdComboChange(this.value);" required>
	                            </select>
                            </td>
							<td colspan="4" style="height:30px;text-align: left;">
							      <div class="add_btn_small pdl10">
                                   <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
                                   <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
                                </div>
							</td>
						</tr>
						<tr>
                           <td colspan="8">
                                <div class="contents">
                                    <div data-ax5grid="second-grid1" data-ax5grid-config="{}" style="height: 170px; width: 100%"></div>
                                </div>
                             </td>                                      
                        </tr>
                        
                        <!-- 2행 -->
                        <tr>
                            <th colspan="1" class="hit" style="height:30px;text-align: left;">Lv.2</th>
                            <td colspan="3" style="height:30px;text-align: left;">
                                <select id="sublvl" name="sublvl" data-kind="LEVEL" msg="Level2" onchange="" required>
                                </select>
                            </td>
                            <td colspan="4" style="height:30px;text-align: left;">
                                  <div class="add_btn_small pdl10">
                                   <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
                                   <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
                                </div>
                            </td>
                        </tr>

                        <tr>
                           <td colspan="8">
                                <div class="contents">
                                    <div data-ax5grid="second-grid2" data-ax5grid-config="{}" style="height: 170px; width: 100%"></div>
                                </div>
                             </td>                                      
                        </tr>
                        
                        <!-- 3행 -->
                        <tr>
                            <th colspan="1" class="hit" style="height:30px;text-align: left;">Lv.3</th>
                            <td colspan="3" style="height:30px;text-align: left;">
                                <select id="sublvl" name="sublvl" data-kind="LEVEL" msg="Level2" onchange="" required>
                                </select>
                            </td>
                            <td colspan="4" style="height:30px;text-align: left;">
                                  <div class="add_btn_small pdl10">
                                   <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
                                   <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
                                </div>
                            </td>
                        </tr>

                        <tr>
                           <td colspan="8">
                                <div class="contents">
                                    <div data-ax5grid="second-grid3" data-ax5grid-config="{}" style="height: 170px; width: 100%"></div>
                                </div>
                             </td>                                      
                        </tr>
				    </tbody>
				    
				    
		        </table>	
			</form>
		</div>
	</div>

	         
	<button type="button" class="btn btn-default btn-sm" id="actionBtn" authchk>등록</button>
	<button type="button" class="btn btn-default btn-sm" onclick="modalStack.close();">닫기</button>
</div>
    
<script type="text/javascript">
var wbsGridView = {
        initView: function(){
            this.target = new ax5.ui.grid();
            this.target.setConfig({
                showRowSelector: true,
                multipleSelect: false,
                sortable: false,
                target: $('[data-ax5grid="second-grid1"]'),
                header: {
                  align: "center",
                  selector: true
                },
                body: {
                    onClick: function () {
                        this.self.select(this.dindex); 
                    },
                    onDBLClick: function () {
                        this.self.clearSelect();
                        this.self.select(this.dindex);
                    },
               },
                page: {
            	   display: false,
               }, 
               columns: [
            	   {key: "rn",      label: "No.",      align: "center",   width: 35},
            	   {key: "coCd",      label: "회사",          hidden: true},
                   {key: "salesCd",      label: "SALES CODE",      align: "center",  hidden: true},
                   {key: "lvl1",      label: "LEVEL 1",      align: "left",   width: 130},
                   {key: "wbsPlanCnts",      label: "주요내용",      align: "left",   width: 200},
                   {key: "wbsPlanEmpNo",      label: "작성자",      align: "left",   width: 100},
                   {key: "wbsPlanMngEmpNo",      label: "담당자",      align: "left",   width: 100},
                   {key: "wbsPlansDt",      label: "시작일자",      align: "center",   width: 110},
                   {key: "wbsPlaneDt",      label: "종료일자",      align: "center",   width: 110},
                   {key: "wbsPlanRmk",      label: "비고",      align: "left",   width: 200}
                     ]
            });
            return this;
          },
          setData: function() {
                var targetObj = this.target;
                var formData = {}
                postAjax("/user/wb/wb01/selectWbsPlanLvl1List", formData, null, function(data){
                     var list = data.resultList;
                     targetObj.setData({
                    	list : list,
                    	page : {} 
                     });
                 });
           } 
     }


var wbsDetailGridView = {
        initView: function(){
            this.target = new ax5.ui.grid();
            this.target.setConfig({
                showRowSelector: true,
                multipleSelect: false,
                sortable: false,
                target: $('[data-ax5grid="second-grid2"]'),
                header: {
                  align: "center",
                  selector: true
                },
                body: {
                    onClick: function () {
                        this.self.select(this.dindex); 
                    },
                    onDBLClick: function () {
                        this.self.clearSelect();
                        this.self.select(this.dindex);
                    },
               },
                page: {
                   display: false,
               }, 
               columns: [
            	   {key: "rn",      label: "No.",      align: "center",   width: 35},
                   {key: "coCd",      label: "회사",          hidden: true},
                   {key: "salesCd",      label: "SALES CODE",      align: "center",  hidden: true},
                   {key: "lvl2",      label: "LEVEL 2",      align: "left",   width: 130},
                   {key: "wbsPlanCnts",      label: "주요내용",      align: "left",   width: 200},
                   {key: "wbsPlanEmpNo",      label: "작성자",      align: "left",   width: 100},
                   {key: "wbsPlanMngEmpNo",      label: "담당자",      align: "left",   width: 100},
                   {key: "wbsPlansDt",      label: "시작일자",      align: "center",   width: 110},
                   {key: "wbsPlaneDt",      label: "종료일자",      align: "center",   width: 110},
                   {key: "wbsPlanRmk",      label: "비고",      align: "left",   width: 200}
                     ]
            });
            return this;
          },
          setData: function() {
                var targetObj = this.target;
                var formData = {}
                postAjax("/user/wb/wb01/selectWbsPlanLvl1List", formData, null, function(data){
                     var list = data.resultList;
                     targetObj.setData({
                        list : list,
                        page : {} 
                     });
                 });
           } 
     }
     
var wbsDetailGridView = {
        initView: function(){
            this.target = new ax5.ui.grid();
            this.target.setConfig({
                showRowSelector: true,
                multipleSelect: false,
                sortable: false,
                target: $('[data-ax5grid="second-grid2"]'),
                header: {
                  align: "center",
                  selector: true
                },
                body: {
                    onClick: function () {
                        this.self.select(this.dindex); 
                    },
                    onDBLClick: function () {
                        this.self.clearSelect();
                        this.self.select(this.dindex);
                    },
               },
                page: {
                   display: false,
               }, 
               columns: [
                   {key: "rn",      label: "No.",      align: "center",   width: 35},
                   {key: "coCd",      label: "회사",          hidden: true},
                   {key: "salesCd",      label: "SALES CODE",      align: "center",  hidden: true},
                   {key: "lvl3",      label: "LEVEL 2",      align: "left",   width: 130},
                   {key: "wbsPlanCnts",      label: "주요내용",      align: "left",   width: 200},
                   {key: "wbsPlanEmpNo",      label: "작성자",      align: "left",   width: 100},
                   {key: "wbsPlanMngEmpNo",      label: "담당자",      align: "left",   width: 100},
                   {key: "wbsPlansDt",      label: "시작일자",      align: "center",   width: 110},
                   {key: "wbsPlaneDt",      label: "종료일자",      align: "center",   width: 110},
                   {key: "wbsPlanRmk",      label: "비고",      align: "left",   width: 200}
                     ]
            });
            return this;
          },
          setData: function() {
                var targetObj = this.target;
                var formData = {}
                postAjax("/user/wb/wb01/selectWbsPlanLvl1List", formData, null, function(data){
                     var list = data.resultList;
                     targetObj.setData({
                        list : list,
                        page : {} 
                     });
                 });
           } 
     }
     
  var lvlIdCombo ={
	initCombo: function(){
	    var formData = { "codeKind": '     >' + $("#lvl").val() + '>' };
	    
	    postAjax("/user/wb/wb01/selectWbsPlanLvlCboList", formData, null, function (data){
	        var codeList = data.codeInfoList; 
	        var optionHtml = '<option value="">lvl1 선택</option>';
	        for (var i = 0; i < codeList.length; i++) {
	                optionHtml += '<option value=\"' +  codeList[i].wbsPlanCnts + '\">'
	                + codeList[i].wbsPlanCnts + '</option>';
	            }
	        document.getElementById("lvl").innerHTML = optionHtml;
	    })
	}
}
        
function sublvlIdComboChange(param){
	var formData = { "codeKind":  param };
	   
	   postAjax("/user/wb/wb01/selectWbsPlanSubLvlCboList", formData, null, function (data){
	       var codeList = data.codeInfoList; 
	       var optionHtml = '<option value="">lvl2 선택</option>';
	       for (var i = 0; i < codeList.length; i++) {
	               optionHtml += '<option value=\"' +  codeList[i].wbsPlanCnts + '\">'
	               + codeList[i].wbsPlanCnts + '</option>';
	           }
	       document.getElementById("sublvl").innerHTML = optionHtml;
	   })
	}
	
$(document).ready(function() {
	wbsGridView.initView().setData();  
	wbsDetailGridView.initView().setData();
	lvlIdCombo.initCombo();
 })
</script>
