<div id="wbsPopup" class="popup_area of_a" style="width: 100%; height: 100%;">
	<div class="tit_contents">
	    <h4 class="tit">일정계획등록</h4>
	</div>
	
	<div class="popup_table">
		<div class="form-group">
			<form id="clntForm">
		        <table class="popup_table">
					<colgroup>
					     <col width="8%">
					     <col width="11%">
					     <col width="8%">
					     <col width="11%">
					     <col width="8%">
					     <col width="11%">
					     <col width="8%">
					     <col width="11%">
					     <col width="6%">
					</colgroup>
					
					<thead>
						<tr>
						   <td colspan="9" style="height:30px;text-align: left;">기본정보</td>	                                              
						</tr>
					</thead>
					
					<tbody>
						<!-- 1행 -->
						<tr>
							<th class="hit">회사</th>
							<td>
								<select  id="coCd" data-kind="CO" required="required">
                                   <option value="">전체</option>
                                </select>
							</td>
							<th>관리번호</th>
							<td>
								<input type="hidden" id="mngNo" name="mngNo">
	                            <div class="search_form"  style="width: 100%;">
	                                <input type="text" class="form-control input-sm" id="mngNoNm" name="mngNoNm"  required="required">
	                                <a onclick="openUserTree2();"><i class="i_search_w"></i></a>
	                            </div>
							</td>
							<th class="hit">작성일자</th>
							<td>
	                            <div class="date_input">
	                                <input type="text" class="input_calendar" style="width: 100% !important; display: inline-block !important;" id="wbsWriteDt" name="wbsWriteDt" autocomplete="off" msg="작성일자" date required>
	                            </div>
							</td>
							<th class="hit">작성자</th>
							<td>
								<div class="search_form">
                                <input type="hidden" id="salesMng" name="salesMng">
                                <input type="text" id="salesMngNm" name="salesMngNm" msg="작성자" readonly required>
                                <a onclick="openSecondUserSearch();">
                                    <i class="i_search_w"></i>
                                </a>
                            </div>
							</td>
							<th rowspan="5" style="vertical-align:top;">
							    <button type="button" class="btn btn-primary btn-sm" style="height: 25px; line-height: 15px;" onclick="file.click();" authchk>이슈등록</button>
							    </th>
						</tr>
						             
						<!-- 2행 -->
						 <tr>
						    <th>Sales Code</th>
						    <td>
							    <div class="search_form" style="width: 100%;">
	                                <input type="text" class="form-control input-sm" id="salesCd_S">
	                                <a onclick="openClntSearch();"><i class="i_search_w"></i></a>
	                            </div>
						    </td>
						    <th  class="hit">고객사</th>
						    <td>
								<div class="search_form">
	                                <input type="hidden" id="clntCd" name="clntCd" msg="고객사">
	                                <input type="text" class="form-control input-sm" id="clntNm" readonly  msg="고객사" required>
	                                <a onclick="openSecondClntSearch();">
	                                    <i class="i_search_w"></i>
	                                </a>
		                        </div>
						    </td>
						    <th>고객사PJT</th>
						    <td>
						        <input type="text" class="form-control input-sm" id="wbsClntPjt" data-search="wbsClntPjt">
						    </td>
						    <th class="hit">신작구분</th>
						    <td>
						      
						    </td>
						</tr>
						
						 <!-- 3행 -->
						 <tr>
						    <th class="hit">Lv.1</th>
						    <td>
						
						    </td>
						    <th>담당자</th>
						    <td>
						        <div class="search_form">
                                <input type="hidden" id="salesMng" name="salesMng">
                                <input type="text" class="form-control input-sm" id="salesMngNm" name="salesMngNm" msg="작성자" readonly required>
                                <a onclick="openSecondUserSearch();">
                                    <i class="i_search_w"></i>
                                </a>
						    </td>
						    <th class="hit">시작일자</th>
						    <td>
						    <div class="date_input">
                                <input type="text" class="input_calendar" style="width: 100% !important; display: inline-block !important;" id="wbsPlansDt" data-search="wbsPlansDt"  "autocomplete="off" date>
                            </div>
						    </td>
						    <th class="hit">종료일자</th>
						    <td>
						    <div class="date_input">
                                <input type="text" class="input_calendar" style="width: 100% !important; display: inline-block !important;" id="wbsPlaneDt" data-search="wbsPlaneDt"  autocomplete="off" date>
                            </div>
						    </td>
						</tr>
						
						<!-- 4행 -->
						 <tr>
						    <th class="hit">주요내용</th>
						    <td colspan=3>
						            <input type="text" id="prdtSpec" data-search="prdtSpec">
						    </td>
						    <th>비고</th>
						    <td colspan=3>
						            <input type="text" id="prdtSpec" data-search="prdtSpec">
						    </td>
						</tr>
						
						<!-- 5행 -->
						 <tr>
					        <th>설계난이도</th>
					        <td>
					
					        </td>
					        <th>설계계획공수</th>
					        <td>
					            <input type="text" id="prdtSpec" data-search="prdtSpec">
					        </td>
					        <th>생산난이도</th>
					        <td>
					       
					        </td>
					        <th>생산계획공수</th>
					        <td>
					           <input type="text" id="prdtSpec" data-search="prdtSpec">  
					        </td>
						 </tr>

                        <!-- 6행 -->
                         <tr>
                            <th>외주여부</th>
                            <td>
								<INPUT type=radio id="rptName" name="rptName" value="YES">Y 
								<INPUT type=radio id="rptName" name="rptName" value="NO" checked>N<br>
                            </td>
                            <th>계획상태</th>
                            <td>
                                <input type="text" id="prdtSpec" data-search="prdtSpec">
                            </td>
                            
                         </tr>

						    
				    </tbody>
		        </table>	
			</form>
		</div>
	</div>
	<div class="popup_table">               
		<table style="border:0px;">
            <tr>
                <td style="text-align: LEFT; border-right: 0px;">※공유 대상자</td>
                <td >
                    <div class="add_btn_small pdl10">
                        <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
                        <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
                    </div>
                </td>
            </tr>
        </table>
	</div>	    
	<div class="contents">
	     <!-- 공유대상자 리스트 -->
	    <div data-ax5grid="second-grid" data-ax5grid-config="{}" style="height: 100px; width: 100%"></div>
	</div>	
	<div class="contents">
		<table class="popup_table" style="height:80px;">
	           <colgroup>
	                <col width="30%">
	                <col width="70%">
	           </colgroup>
	           <tr style="height:100px;vertical-align:top;">
	               <td style="border:0px;vertical-align:top;">
	                    <table>
	                    <tr>
	                    <td style="text-align: LEFT;height:20px;border:0px;">*파일폴더</td>
	                    </tr>
	                    <tr>
	                    <td style="height:100px;vertical-align:top;border:0px;"><!-- 파일 리스트 트리 추가 --></td>
	                    </tr>
	                    </table>
	               </td>
	               <td style="border:0px;vertical-align:top;">
	                    <table>
	                    <tr>
	                    <td style="text-align: LEFT;height:20px;border:0px;">*첨부파일</td>
	                    </tr>
	                    <tr>
	                    <td style="height:100px;vertical-align:top;border:0px;"><!-- 첨부파일 리스트 그리드 추가 --></td>
	                    </tr>
	                    </table>
	               </td>
	               
	           </tr>  
	      </table>
	      
          <table class="popup_table">
           <colgroup>
                <col width="8%">
                <col width="12%">
                <col width="8%">
                <col width="12%">
                <col width="8%">
                <col width="12%">
                <col width="8%">
                <col width="12%">
           </colgroup>
           <tbody>
               <!-- Level 2행 -->
               <tr>
                   <th colspan="1" class="hit" style="height:30px;text-align: left;">Lv.2</th>
                   <td colspan="3" style="height:30px;text-align: left;">
                       <select id="sublvl" name="sublvl" data-kind="LEVEL" msg="Level2" onchange="" required>
                       </select>
                   </td>
                   <td colspan="4" style="height:30px;text-align: left;">
                         <div class="add_btn_small pdl10">
                          <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
                          <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
                       </div>
                   </td>
               </tr>

               <tr>
                  <td colspan="8">
                       <div class="contents">
                           <div data-ax5grid="second-grid2" data-ax5grid-config="{}" style="height: 170px; width: 100%"></div>
                       </div>
                    </td>                                      
               </tr>
               
               <!-- Level 3행 -->
               <tr>
                   <th colspan="1" class="hit" style="height:30px;text-align: left;">Lv.3</th>
                   <td colspan="3" style="height:30px;text-align: left;">
                       <select id="sublvl" name="sublvl" data-kind="LEVEL" msg="Level2" onchange="" required>
                       </select>
                   </td>
                   <td colspan="4" style="height:30px;text-align: left;">
                         <div class="add_btn_small pdl10">
                          <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
                          <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
                       </div>
                   </td>
               </tr>

               <tr>
                  <td colspan="8">
                       <div class="contents">
                           <div data-ax5grid="second-grid3" data-ax5grid-config="{}" style="height: 170px; width: 100%"></div>
                       </div>
                    </td>                                      
               </tr>
           </tbody>
           
           
       </table>        	      
	</div>	 
	

	<button type="button" class="btn btn-default btn-sm" id="actionBtn" authchk>등록</button>
	<button type="button" class="btn btn-default btn-sm" onclick="modalStack.close();">닫기</button>
</div>
    
<script type="text/javascript">
var wbsGridView = {
   initView: function(){
       this.target = new ax5.ui.grid();
       this.target.setConfig({
           showRowSelector: true,
           multipleSelect: false,
           sortable: true,
           target: $('[data-ax5grid="adjust-grid"]'),
           header: {
             align: "center",
             selector: false
           },
           body: {
               onClick: function () {
                   this.self.select(this.dindex); 
               },
               onDBLClick: function () {
                   this.self.clearSelect();
                   this.self.select(this.dindex);
               },
          },
          columns: [
                {key: "rn",      label: "No.",      align: "center",   width: 130},
                {key: "empNo",      label: "사원번호",      align: "left",   width: 130},
                {key: "name",      label: "성명",      align: "left",   width: 130},
                {key: "telNo",      label: "H.P",      align: "left",   width: 130},
                {key: "email",      label: "E-Mail",      align: "left",   width: 200},
                ]
       });
       return this;
     },
     setData: function() {
          /*  var targetObj = this.target;
           var formData = {
               "coCd" : $("#coCd").val(),
               "pageNo" : _pageNo + 1, 
               "recordCnt" : $("#recordCnt").val()
           }
           postAjax("/user/wb/wb01/selectWbsList", formData, null, function(data){
               var list = data.resultList;
               targetObj.setData({
                   list : list,

               });
           }); */
      } 
}


$(document).ready(function() {
	setCommonSelect($('#wbsPopup select[data-kind]'));
	$('#wbsPopup #coCd').val(jwt.coCd);
	
	$('#wbsPopup #wbsWriteDt').datepicker({
        format : "yyyy-mm-dd",
        language : "ko",
        autoclose : true
	})
	.datepicker("setDate", moment().format('YYYY-MM-DD'))
	
	$('#wbsPopup #wbsPlansDt').datepicker({
        format : "yyyy-mm-dd",
        language : "ko",
        autoclose : true
    })
    
    $('#wbsPopup #wbsPlaneDt').datepicker({
        format : "yyyy-mm-dd",
        language : "ko",
        autoclose : true
    })
    
    
});   

//사용자 검색
function openSecondUserSearch() {
    var paramObj = {
        "coCd" : "GUN", // $('#coCd').val(),
        "userId": $('#wbsPopup #salesMng').val(),
        "useYn": "Y"
    };
    
    openSecondModal("/static/html/cmn/modal/userSearch.html", 300, 500, "사용자 검색", paramObj, function (tree){
        var checkedId = tree.get_checked()[0];
        var checkedNode = tree.get_node(checkedId);
        $('#wbsPopup #salesMng').val(checkedNode.id);
        $('#wbsPopup #salesMngNm').val(checkedNode.text);
    });
}

// 고객사 검색
function openSecondClntSearch(type) {
    openSecondModal("/static/html/cmn/modal/clntSearch.html", 600, 420, "고객사 검색", {}, function (grid) {
        var row = grid.target.getList("selected")[0];
        $('#wbsPopup #clntCd').val(row.clntCd);
        $('#wbsPopup #clntNm').val(row.clntNm);
        $('#wbsPopup #sellVatCd').val(row.sellVatCd);
        
        var paramObj = {
            "coCd": $('#wbsPopup #coCd').val(),
            "clntCd": row.clntCd
        }

    });
}


</script>
