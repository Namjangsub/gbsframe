<div id="wbsPopup" class="popup_area of_a" style="width: 100%; height: 100%;">
	<div class="tit_contents">
	    <h4 class="tit">이슈등록</h4>
	</div>
	
	<div class="popup_table">
		<div class="form-group">
			<form id="clntForm">
		        <table class="popup_table">
					<colgroup>
					     <col width="8%">
					     <col width="12%">
					     <col width="8%">
					     <col width="12%">
					     <col width="8%">
					     <col width="12%">
					     <col width="8%">
					     <col width="12%">
					</colgroup>
					
					<thead>
						<tr>
						   <td colspan="8" style="height:30px;text-align: left;">기본정보 (2단계 확인없음)</td>	                                              
						</tr>
					</thead>
					
					<tbody>
						<!-- 1행 -->
						<tr>
							<th class="hit">회사</th>
							<td>
								<select class="form-control input-sm" id="coCd" data-kind="CO" required="required" onchange="setByCoCd(this.value);">
                                   <option value="">전체</option>
                                </select>
							</td>
							<th>이슈번호</th>
							<td>
								<input type="hidden" id="mngNo" name="mngNo">
	                            <div class="search_form"  style="width: 100%;">
	                                <input type="text" class="form-control input-sm" id="mngNoNm" name="mngNoNm"  required="required">
	                                <a onclick="openUserTree2();"><i class="i_search_w"></i></a>
	                            </div>
							</td>
							<th class="hit">작성일자</th>
							<td>
	                            <div class="date_input">
	                                <input type="text" class="input_calendar" style="width: 100% !important; display: inline-block !important;" id="wbsWriteDt" name="wbsWriteDt" autocomplete="off" msg="작성일자" date required>
	                            </div>
							</td>
							<th class="hit">작성자</th>
							<td>
								<div class="search_form">
                                <input type="hidden" id="salesMng" name="salesMng">
                                <input type="text" id="salesMngNm" name="salesMngNm" msg="작성자" readonly required>
                                <a onclick="openSecondUserSearch();">
                                    <i class="i_search_w"></i>
                                </a>
                            </div>
							</td>
						</tr>
						             
						<!-- 2행 -->
						 <tr>
						    <th>Sales Code</th>
						    <td>
							    <div class="search_form" style="width: 100%;">
	                                <input type="text" class="form-control input-sm" id="salesCd_S">
	                                <a onclick="openClntSearch();"><i class="i_search_w"></i></a>
	                            </div>
						    </td>
						    <th  class="hit">고객사</th>
						    <td>
								<div class="search_form">
	                                <input type="hidden" id="clntCd" name="clntCd" msg="고객사">
	                                <input type="text" class="form-control input-sm" id="clntNm" readonly  msg="고객사" required>
	                                <a onclick="openSecondClntSearch();">
	                                    <i class="i_search_w"></i>
	                                </a>
		                        </div>
						    </td>
						    <th>고객사PJT</th>
						    <td>
						        <input type="text" class="form-control input-sm" id="wbsClntPjt" data-search="wbsClntPjt">
						    </td>
						    <th class="hit">진행상태</th>
						    <td>
						      
						    </td>
						</tr>

                        <!-- 3행 -->
                         <tr>
                            <th class="hit">Lv.2</th>
                            <td>
                        
                            </td>
                            <th class="hit">주요내용</th>
                            <td >
                                    <input type="text" id="prdtSpec" data-search="prdtSpec">
                            </td>
                            <th class="hit">시작일자</th>
                            <td>
                            <div class="date_input">
                                <input type="text" class="input_calendar" style="width: 100% !important; display: inline-block !important;" id="wbsPlansDt" data-search="wbsPlansDt"  "autocomplete="off" date>
                            </div>
                            </td>
                            <th class="hit">종료일자</th>
                            <td>
                            <div class="date_input">
                                <input type="text" class="input_calendar" style="width: 100% !important; display: inline-block !important;" id="wbsPlaneDt" data-search="wbsPlaneDt"  autocomplete="off" date>
                            </div>
                            </td>
                        </tr>
                        
										    
				    </tbody>
				    <thead>
                        <tr>
                           <td colspan="8" style="height:30px;text-align: left;">이슈정보</td>                                                
                        </tr>
                    </thead>
				    <tbody>

                        <tr  style="height:30px;">
                            <th class="hit">조치필요여부</th>
                            <td  colspan="3">
                                 <input type="text" id="prdtSpec" data-search="prdtSpec">
                            </td>
                            <th rowspan="5">이슈내용</th>
                            <td colspan="3" rowspan="5">
                                 <textarea class="form-control" id="dlvrRmk" name="dlvrRmk" style="width:100%;height: 190px;" maxlength="500"></textarea>
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">조치자</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>  
                        <tr  style="height:30px;">
                            <th class="hit">시작일자</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">종료일자</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">투입시간</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">투입비용</th>
                            <td  colspan="3">
                                 
                            </td>
                            <th class="hit" rowspan="3">원인</th>
                            <td colspan="3" rowspan="3">
                                 <textarea class="form-control" id="dlvrRmk" name="dlvrRmk" style="width:100%;height: 110px;" maxlength="500"></textarea>
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">유형</th>
                            <td  colspan="3">
                                 
                            </td>
                            
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">세부유형</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">등급</th>
                            <td  colspan="3">
                                 
                            </td>
                            <th class="hit" rowspan="3">조치내용</th>
                            <td colspan="3" rowspan="3">
                                 <textarea class="form-control" id="dlvrRmk" name="dlvrRmk" style="width:100%;height: 110px;" maxlength="500"></textarea>
                            </td>
                            
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">확인필요여부</th>
                            <td  colspan="3">
                                 
                            </td>
                            
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">확인자</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">확인유형</th>
                            <td  colspan="3">
                                 
                            </td>
                            <th class="hit" rowspan="3">확인내용</th>
                            <td colspan="3" rowspan="3">
                                 <textarea class="form-control" id="dlvrRmk" name="dlvrRmk" style="width:100%;height: 110px;" maxlength="500"></textarea>
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">확인세부유형</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>   
                        <tr  style="height:30px;">
                            <th class="hit">확인등급</th>
                            <td  colspan="3">
                                 
                            </td>
                        </tr>   
                        
                        
                    </tbody>    
		        </table>	
			</form>
		</div>
	</div>
	<div class="popup_table">               
        <table style="border:0px;">
            <tr>
                <td style="text-align: LEFT; border-right: 0px;">※공유 대상자</td>
                <td >
                    <div class="add_btn_small pdl10">
                        <a onclick="insertWBSModal(1);" style="height: 30px; line-height: 28px;" authchk>+</a>
                        <a onclick="deleteShip();" style="height: 30px; line-height: 28px;" authchk>-</a>
                    </div>
                </td>
            </tr>
        </table>
    </div>     
    <div class="contents">
        <div data-ax5grid="adjust-grid" data-ax5grid-config="{}" style="height: 200px; width: 100%"></div>
    </div>   
	<div class="contents">
	   <table class="popup_table" style="height:120px;">
           <colgroup>
                <col width="30%">
                <col width="70%">
           </colgroup>
           <tr style="height:140px;vertical-align:top;">
               <td style="border:0px;vertical-align:top;">
                    <table>
                    <tr>
                    <td style="text-align: LEFT;height:20px;border:0px;">*파일리스트</td>
                    </tr>
                    <tr>
                    <td style="height:140px;vertical-align:top;border:0px;"><!-- 파일 리스트 트리 추가 --></td>
                    </tr>
                    </table>
               </td>
               <td style="border:0px;vertical-align:top;">
                    <table>
                    <tr>
                    <td style="text-align: LEFT;height:20px;border:0px;">*첨부파일</td>
                    </tr>
                    <tr>
                    <td style="height:140px;vertical-align:top;border:0px;"><!-- 첨부파일 리스트 그리드 추가 --></td>
                    </tr>
                    </table>
               </td>
               
           </tr>  
      </table>
	</div>
	         
	<button type="button" class="btn btn-default btn-sm" id="actionBtn" authchk>등록</button>
	<button type="button" class="btn btn-default btn-sm" onclick="modalStack.close();">닫기</button>
</div>
    
<script type="text/javascript">
var wbsGridView = {
   initView: function(){
       this.target = new ax5.ui.grid();
       this.target.setConfig({
           showRowSelector: true,
           multipleSelect: false,
           sortable: true,
           target: $('[data-ax5grid="adjust-grid"]'),
           header: {
             align: "center",
             selector: false
           },
           body: {
               onClick: function () {
                   this.self.select(this.dindex); 
               },
               onDBLClick: function () {
                   this.self.clearSelect();
                   this.self.select(this.dindex);
               },
          },
          columns: [
                {key: "rn",      label: "No.",      align: "center",   width: 130},
                {key: "empNo",      label: "사원번호",      align: "left",   width: 130},
                {key: "name",      label: "성명",      align: "left",   width: 130},
                {key: "telNo",      label: "H.P",      align: "left",   width: 130},
                {key: "email",      label: "E-Mail",      align: "left",   width: 200},
                ]
       });
       return this;
     },
     setData: function() {
          /*  var targetObj = this.target;
           var formData = {
               "coCd" : $("#coCd").val(),
               "pageNo" : _pageNo + 1, 
               "recordCnt" : $("#recordCnt").val()
           }
           postAjax("/user/wb/wb01/selectWbsList", formData, null, function(data){
               var list = data.resultList;
               targetObj.setData({
                   list : list,

               });
           }); */
      } 
}


$(document).ready(function() {
	setCommonSelect($('#wbsPopup select[data-kind]'));
	$('#wbsPopup #coCd').val(jwt.coCd);
	
	$('#wbsPopup #wbsWriteDt').datepicker({
        format : "yyyy-mm-dd",
        language : "ko",
        autoclose : true
	})
	.datepicker("setDate", moment().format('YYYY-MM-DD'))
	
	$('#wbsPopup #wbsPlansDt').datepicker({
        format : "yyyy-mm-dd",
        language : "ko",
        autoclose : true
    })
    
    $('#wbsPopup #wbsPlaneDt').datepicker({
        format : "yyyy-mm-dd",
        language : "ko",
        autoclose : true
    })
    
    
});   

//사용자 검색
function openSecondUserSearch() {
    var paramObj = {
        "coCd" : "GUN", // $('#coCd').val(),
        "userId": $('#wbsPopup #salesMng').val(),
        "useYn": "Y"
    };
    
    openSecondModal("/static/html/cmn/modal/userSearch.html", 300, 500, "사용자 검색", paramObj, function (tree){
        var checkedId = tree.get_checked()[0];
        var checkedNode = tree.get_node(checkedId);
        $('#wbsPopup #salesMng').val(checkedNode.id);
        $('#wbsPopup #salesMngNm').val(checkedNode.text);
    });
}

// 고객사 검색
function openSecondClntSearch(type) {
    openSecondModal("/static/html/cmn/modal/clntSearch.html", 600, 420, "고객사 검색", {}, function (grid) {
        var row = grid.target.getList("selected")[0];
        $('#wbsPopup #clntCd').val(row.clntCd);
        $('#wbsPopup #clntNm').val(row.clntNm);
        $('#wbsPopup #sellVatCd').val(row.sellVatCd);
        
        var paramObj = {
            "coCd": $('#wbsPopup #coCd').val(),
            "clntCd": row.clntCd
        }

    });
}


</script>
