<style>
.status_red {
	background-color: red;
	width: 14px;
	height: 14px;
	border-radius: 7px;
}

.status_orange {
	background-color: orange;
	width: 14px;
	height: 14px;
	border-radius: 7px;
}

.status_green {
	background-color: green;
	width: 14px;
	height: 14px;
	border-radius: 7px;
}
</style>
<!-- 페이지 타이틀 -->
<h3 class="location">
	<span id="topMenu"></span> > <span id="topSubMenu" class="page_tit"></span>
</h3>


<!-- 로그아웃버튼 -->
<div class="btn_area"  style="display: flex;">

	<!-- 
	<ul class="nav navbar-nav">
	<li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">현황판
        <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="http://192.168.1.2:8081/GY/status/launch.html?screenid=GY_status&gv_factory=G1" target="_blank>">1공장</a></li>
        </ul>
      </li>
	</ul>
	-->
	<div id="personalStatus" style="display: flex; justify-content: center; align-items: center; border: 1px solid gray; border-radius: 25px;">
		<div>　</div>
		<a onclick="allEmployee();" style="height: 26px; line-height: 28px; width: 90px;"><i class="fas fa-users"></i> 직원현황</a> 
        <div>일정</div>
        <div id="scdLoad" class="status_red"></div>　
	    <div>품질</div>
	    <div id="qcLoad" class="status_red"></div>　
	    <div>역량.부하</div>
	    <div id="jobLoad" class="status_red"></div>　
	    <div>소통.협력</div>
	    <div id="commLoad" class="status_blue"></div>　
	</div> &nbsp
    <div>
		<button class="logout_btn" onclick="updatePwModal();">PW변경</button>
		<button class="logout_btn" onclick="logoutClick();">Logout</button>
		<a href="/static/html/admin/admin.html" target="_blank" id="btnAdmin">
			<button class="bg_b">Admin</button>
		</a>
	</div>
</div>
<div class="name">
  <p id="topUserNm"></p>
</div>
<script type="text/javascript">
	$(document).ready(function() {
		//authChk();
		if(jwt.authInfo.indexOf("AUTH001") < 0){
			$("#btnAdmin").hide();
		} else {
			$("#btnAdmin").show();
		}
		//개인별 상태현황 정보 처리
		userStatusRtv();
		
		$("#topUserNm").click(function() {callPersonalStatus();});
		$("#personalStatus").click(function() {callPersonalStatus();});
	});

	
	function userStatusRtv() {
		var formData = {
				"userId": jwt.userId
		};
		postAjax("/admin/cm/cm06/selectUserStatusList", formData, null, function(data){
			var list = data.result[0];
			if (list == undefined ) {
				list = {
					"scdLoad"	: "comm1",
					"qcLoad" 	: "comm1",
					"jobLoad"	: "comm1",
					"commLoad"	: "comm1"
				}
			}
			for (var key in list) {
				if (list.hasOwnProperty(key)) {
					changeStatus(key, list[key]);
				}
			}
		});
	}	

	function updatePwModal() {
		openModal("/static/html/cmn/modal/updatePw.html", 500, 200, "비밀번호 변경");
	}

	function callPersonalStatus() {
		openModal("/static/html/cmn/modal/changeUserStatus.html", 500, 200, "개인별 부하 정도 체크", null, function (data) {
	debugger;
			if (data != undefined ) {
				for (var key in data) {
					if (key !="userId" && data.hasOwnProperty(key)) {
						changeStatus(key, data[key]);
					}
				}
			}
		});
	}

	function changeStatus(obj, set) {
		const setClass = (set == "comm3") ? "status_red" : (set == "comm2") ? "status_orange" : "status_green";
		  $("#" + obj).removeClass();
		  $("#" + obj).addClass(setClass);
	}
	
	function allEmployee() {
		openModal("/static/html/cmn/modal/displayUserStatus.html", 1000, 600, "전직원 상태 현황 ", null, function (data) {
			
		});
	}	
</script> 

