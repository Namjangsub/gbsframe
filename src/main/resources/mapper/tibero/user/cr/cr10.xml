<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dksys.biz.user.cr.cr10.mapper.CR10Mapper">

	<sql id="selectLgistReqSql">
		WITH APP_STATUS_LIST AS (
			SELECT A.CO_CD, B.TODO_DIV1_CODE_ID, B.TODO_DIV2_CODE_ID
			     , CASE WHEN SUM(CASE WHEN B.TODO_CF_DT IS NOT NULL THEN 1 ELSE 0 END) = SUM(CASE WHEN A.USE_YN = 'Y' THEN 1 ELSE 0 END) THEN 'APP9'
					    WHEN SUM(CASE WHEN B.TODO_CF_DT IS NOT NULL THEN 1 ELSE 0 END) > 0 THEN 'APP1'
		            	ELSE 'APP0'
		        END AS APP_STATUS
			   FROM TB_BM13M01 A
			   JOIN TB_WB20M01 B ON A.CO_CD = B.CO_CD AND A.APP_DIV = B.TODO_DIV1_CODE_ID AND A.APP_ID = B.TODO_ID
			  WHERE A.APP_DIV = 'APPDIV03'
			  GROUP BY A.CO_CD, B.TODO_DIV1_CODE_ID, B.TODO_DIV2_CODE_ID
		)
		, APP_TODO_LIST AS (
			SELECT A.CO_CD, B.TODO_DIV1_CODE_ID, B.TODO_DIV2_CODE_ID, A.APP_SEQ,  B.TODO_ID,  FN_CM06M01_ID_TO_NM(B.TODO_ID) AS TODO_ID_NM , DECODE(B.TODO_CF_DT,NULL,'N','Y') AS TODO_CF_YN
				   FROM TB_BM13M01 A
				   JOIN TB_WB20M01 B ON A.CO_CD = B.CO_CD AND A.APP_DIV = B.TODO_DIV1_CODE_ID AND A.APP_ID = B.TODO_ID
				  WHERE A.APP_DIV = 'APPDIV03'
		)
		SELECT LEVEL AS LEV
		    	 , FN_CM05M01_CD_TO_NM(T.CO_CD) CO_NM
		    	 ,T.*
		    	 ,FN_CM06M01_ID_TO_NM(T.REQ_ID) AS REQ_ID_NM
		    	 ,FN_CM06M01_ID_TO_NM(T.STA_CHRG_ID) AS STA_CHRG_ID_NM
		    	 ,(SELECT LISTAGG(SALES_CD, ' , ') WITHIN GROUP (ORDER BY SALES_CD ASC) FROM TB_CR11D01 WHERE FILE_TRGT_KEY = T.FILE_TRGT_KEY) AS SALES_CD_LIST
		    	 ,CASE WHEN FILE_TRGT_KEY IS NULL THEN '' ELSE (SELECT COUNT(*) FROM TB_CR11D01 WHERE FILE_TRGT_KEY = T.FILE_TRGT_KEY) END AS SALES_CD_CNT
		    	 ,REGEXP_REPLACE(SYS_CONNECT_BY_PATH(T.LOWER_CD, ' -> '), '^\s+\-\>\s+', '') AS PATH
				 ,CASE WHEN T.FILE_TRGT_KEY IS NOT NULL THEN NVL(AP.APP_STATUS, 'APP0') END AS APP_STATUS
				 ,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 1) AS APP_USER1_ID
				 ,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 2) AS APP_USER2_ID
				 ,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 3) AS APP_USER3_ID
				 ,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 4) AS APP_USER4_ID
				 ,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 1) AS APP_USER1_ID_NM
				 ,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 2) AS APP_USER2_ID_NM
				 ,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 3) AS APP_USER3_ID_NM
				 ,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 4) AS APP_USER4_ID_NM
				 ,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 1) AS APP_USER1_CF_YN
				 ,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 2) AS APP_USER2_CF_YN
				 ,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 3) AS APP_USER3_CF_YN
				 ,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 4) AS APP_USER4_CF_YN
		FROM (
			 	/* top -> 회사*/
		            SELECT 'top' AS UPPER_CD
				, #{coCd} AS LOWER_CD
				, #{coCd} AS CO_CD
				, '' AS ORDRS_NO
				, '전체 현황' AS TITLE
				, '' ORDRS_CLNT_CD
				, '전체' AS ORDRS_CLNT_NM
				, '' AS CLNT_PJT
				, '' AS FILE_TRGT_KEY
				, '' AS G_NO
				, '' AS PBLICTE_DT
				, '' AS REQ_ID
				, '' AS PART_NO
				, '' AS REQ_FX_DT
				, '' AS CLAS_DIV_NM
				, '' AS TRNS_DIV_NM
				, '' AS DMS_TRNS_AREA_DIV_NM
				, '' AS DMS_SEND_CND_DIV_NM
				, '' AS DMS_SEND_CND_DIV_ETC
				, '' AS DMS_PACK_KIND_DIV_NM
				, '' AS OVS_TRNS_AREA_DIV_NM
				, '' AS OVS_SEND_CND_DIV_NM
				, '' AS OVS_SEND_CND_DIV_ETC
				, '' AS OVS_PACK_KIND_DIV_NM
				, '' AS TRNS_AREA_DIV_NM
				, '' AS SEND_CND_DIV_NM
				, '' AS PACK_KIND_DIV_NM
				, '' AS STA_PLACE
				, '' AS STA_ADDR
				, '' AS STA_CHRG_ID
				, '' AS ARVL_PLACE
				, '' AS ARVL_ADDR
				, '' AS ARVL_CHRG_CONT
				, '' AS PRDLST_CONT
				, '' AS PRD_AMT
				, '' AS WIDTH_SIZE
				, '' AS VRTICL_SIZE
				, '' AS HEIGHT_SIZE
				, '' AS FRMLC_BEFORE_WT
				, '' AS FRMLC_AFTER_WT
				, '' AS SHIPMNT_DT
				, '' AS HOPE_ARVL_DT
				, '' AS LGIST_RMK
				, '' AS TODO_DIV1_CODE_ID
				, '' AS TODO_DIV2_CODE_ID
		              FROM DUAL
		       UNION ALL
		     		/* top -> 회사 -> 고객사 */
		            SELECT DISTINCT
				X.CO_CD UPPER_CD
				, TO_CHAR(Y.ORDRS_CLNT_CD) LOWER_CD
				, X.CO_CD
				, '' AS ORDRS_NO
				, A.CLNT_NM AS TITLE
				, Y.ORDRS_CLNT_CD
				, A.CLNT_NM  AS ORDRS_CLNT_NM
				, '' AS CLNT_PJT
				, '' AS FILE_TRGT_KEY
				, '' AS G_NO
				, '' AS PBLICTE_DT
				, '' AS REQ_ID
				, '' AS PART_NO
				, '' AS REQ_FX_DT
				, '' AS CLAS_DIV_NM
				, '' AS TRNS_DIV_NM
				, '' AS DMS_TRNS_AREA_DIV_NM
				, '' AS DMS_SEND_CND_DIV_NM
				, '' AS DMS_SEND_CND_DIV_ETC
				, '' AS DMS_PACK_KIND_DIV_NM
				, '' AS OVS_TRNS_AREA_DIV_NM
				, '' AS OVS_SEND_CND_DIV_NM
				, '' AS OVS_SEND_CND_DIV_ETC
				, '' AS OVS_PACK_KIND_DIV_NM
				, '' AS TRNS_AREA_DIV_NM
				, '' AS SEND_CND_DIV_NM
				, '' AS PACK_KIND_DIV_NM
				, '' AS STA_PLACE
				, '' AS STA_ADDR
				, '' AS STA_CHRG_ID
				, '' AS ARVL_PLACE
				, '' AS ARVL_ADDR
				, '' AS ARVL_CHRG_CONT
				, '' AS PRDLST_CONT
				, '' AS PRD_AMT
				, '' AS WIDTH_SIZE
				, '' AS VRTICL_SIZE
				, '' AS HEIGHT_SIZE
				, '' AS FRMLC_BEFORE_WT
				, '' AS FRMLC_AFTER_WT
				, '' AS SHIPMNT_DT
				, '' AS HOPE_ARVL_DT
				, '' AS LGIST_RMK
				, '' AS TODO_DIV1_CODE_ID
				, '' AS TODO_DIV2_CODE_ID
		              FROM TB_CR02D02 X
		                    INNER JOIN TB_CR02M01 Y  ON X.CO_CD = Y.CO_CD
		                                            AND X.ORDRS_NO = Y.ORDRS_NO
		                    LEFT OUTER JOIN TB_BM02M01 A ON Y.ORDRS_CLNT_CD = A.CLNT_CD
		 WHERE X.CO_CD = #{coCd}
		   AND NVL(A.CLNT_NM, '.') LIKE '%'||#{clntNm}||'%'
		       UNION ALL
		            /* top -> 고객사 -> 수주번호 */
		            SELECT DISTINCT
				TO_CHAR(Y.ORDRS_CLNT_CD) UPPER_CD
				, X.ORDRS_NO LOWER_CD
				, X.CO_CD
				, X.ORDRS_NO
				, X.ORDRS_NO AS TITLE
				, Y.ORDRS_CLNT_CD
				, A.CLNT_NM AS ORDRS_CLNT_NM
				, Y.CLNT_PJT
				, '' AS FILE_TRGT_KEY
				, '' AS G_NO
				, '' AS PBLICTE_DT
				, '' AS REQ_ID
				, '' AS PART_NO
				, '' AS REQ_FX_DT
				, '' AS CLAS_DIV_NM
				, '' AS TRNS_DIV_NM
				, '' AS DMS_TRNS_AREA_DIV_NM
				, '' AS DMS_SEND_CND_DIV_NM
				, '' AS DMS_SEND_CND_DIV_ETC
				, '' AS DMS_PACK_KIND_DIV_NM
				, '' AS OVS_TRNS_AREA_DIV_NM
				, '' AS OVS_SEND_CND_DIV_NM
				, '' AS OVS_SEND_CND_DIV_ETC
				, '' AS OVS_PACK_KIND_DIV_NM
				, '' AS TRNS_AREA_DIV_NM
				, '' AS SEND_CND_DIV_NM
				, '' AS PACK_KIND_DIV_NM
				, '' AS STA_PLACE
				, '' AS STA_ADDR
				, '' AS STA_CHRG_ID
				, '' AS ARVL_PLACE
				, '' AS ARVL_ADDR
				, '' AS ARVL_CHRG_CONT
				, '' AS PRDLST_CONT
				, '' AS PRD_AMT
				, '' AS WIDTH_SIZE
				, '' AS VRTICL_SIZE
				, '' AS HEIGHT_SIZE
				, '' AS FRMLC_BEFORE_WT
				, '' AS FRMLC_AFTER_WT
				, '' AS SHIPMNT_DT
				, '' AS HOPE_ARVL_DT
				, '' AS LGIST_RMK
				, '' AS TODO_DIV1_CODE_ID
				, '' AS TODO_DIV2_CODE_ID
		              FROM TB_CR02D02 X
		                    INNER JOIN TB_CR02M01 Y  ON X.CO_CD = Y.CO_CD
		                                            AND X.ORDRS_NO = Y.ORDRS_NO
		                    LEFT OUTER JOIN TB_BM02M01 A ON Y.ORDRS_CLNT_CD = A.CLNT_CD
		 WHERE X.CO_CD = #{coCd}
		   AND NVL(A.CLNT_NM, '.') LIKE '%'||#{clntNm}||'%'
		   AND NVL(Y.CLNT_PJT, '.') LIKE '%'||#{clntPjt}||'%'
		       UNION ALL
		            /* top -> 고객사 -> 수주번호 -> 물류번호 */
		 SELECT   T.ORDRS_NO AS UPPER_CD
				, T.ORDRS_NO||'-'||TRIM(TO_CHAR(ROW_NUMBER() OVER(PARTITION BY T.ORDRS_NO ORDER BY T.ORDRS_NO, T.FILE_TRGT_KEY),'0000')) AS LOWER_CD
				, T.CO_CD
				, T.ORDRS_NO
				, T.ORDRS_NO||'-'||TRIM(TO_CHAR(ROW_NUMBER() OVER(PARTITION BY T.ORDRS_NO ORDER BY T.ORDRS_NO, T.FILE_TRGT_KEY),'0000')) AS TITLE
				, A.ORDRS_CLNT_CD
				, B.CLNT_NM AS ORDRS_CLNT_NM
				, T.CLNT_PJT
				, T.FILE_TRGT_KEY
				, ROW_NUMBER() OVER(PARTITION BY T.ORDRS_NO ORDER BY T.ORDRS_NO, T.FILE_TRGT_KEY) AS G_NO
				, T.PBLICTE_DT
				, T.REQ_ID
				, T.PART_NO
				, T.REQ_FX_DT
				, FN_CM05M01_CD_TO_NM(T.CLAS_DIV) AS CLAS_DIV_NM
				, FN_CM05M01_CD_TO_NM(T.TRNS_DIV) AS TRNS_DIV_NM
				, FN_CM05M01_CD_TO_NM(T.DMS_TRNS_AREA_DIV) AS DMS_TRNS_AREA_DIV_NM
				, FN_CM05M01_CD_TO_NM(T.DMS_SEND_CND_DIV) AS DMS_SEND_CND_DIV_NM
				, T.DMS_SEND_CND_DIV_ETC
				, FN_CM05M01_CD_TO_NM(T.DMS_PACK_KIND_DIV) AS DMS_PACK_KIND_DIV_NM
				, FN_CM05M01_CD_TO_NM(T.OVS_TRNS_AREA_DIV) AS OVS_TRNS_AREA_DIV_NM
				, FN_CM05M01_CD_TO_NM(T.OVS_SEND_CND_DIV) AS OVS_SEND_CND_DIV_NM
				, T.OVS_SEND_CND_DIV_ETC
				, FN_CM05M01_CD_TO_NM(T.OVS_PACK_KIND_DIV) AS OVS_PACK_KIND_DIV_NM
				, FN_CM05M01_CD_TO_NM(CASE WHEN TRNS_DIV = 'LGISTDIV0301' THEN DMS_TRNS_AREA_DIV ELSE OVS_TRNS_AREA_DIV END) AS TRNS_AREA_DIV_NM
				, CASE WHEN INSTR(DMS_SEND_CND_DIV,'99') = 13 THEN DMS_SEND_CND_DIV_ETC
				       WHEN INSTR(OVS_SEND_CND_DIV,'99') = 13 THEN OVS_SEND_CND_DIV_ETC
				       ELSE FN_CM05M01_CD_TO_NM(CASE WHEN TRNS_DIV = 'LGISTDIV0301' THEN DMS_SEND_CND_DIV ELSE OVS_SEND_CND_DIV END) END AS SEND_CND_DIV_NM
				, FN_CM05M01_CD_TO_NM(CASE WHEN TRNS_DIV = 'LGISTDIV0301' THEN DMS_PACK_KIND_DIV ELSE OVS_PACK_KIND_DIV END) AS PACK_KIND_DIV_NM
				, T.STA_PLACE
				, T.STA_ADDR
				, T.STA_CHRG_ID
				, T.ARVL_PLACE
				, T.ARVL_ADDR
				, T.ARVL_CHRG_CONT
				, T.PRDLST_CONT
				, T.PRD_AMT
				, T.WIDTH_SIZE
				, T.VRTICL_SIZE
				, T.HEIGHT_SIZE
				, T.FRMLC_BEFORE_WT
				, T.FRMLC_AFTER_WT
				, T.SHIPMNT_DT
				, T.HOPE_ARVL_DT
				, T.LGIST_RMK
				, T.TODO_DIV1_CODE_ID
				, T.TODO_DIV2_CODE_ID
		             FROM TB_CR11M01 T
		             LEFT OUTER JOIN TB_CR02M01 A ON T.CO_CD = A.CO_CD AND T.ORDRS_NO = A.ORDRS_NO
		             LEFT OUTER JOIN TB_BM02M01 B ON A.ORDRS_CLNT_CD = B.CLNT_CD
		 WHERE T.CO_CD = #{coCd}
		     	   AND T.PBLICTE_DT <![CDATA[>=]]> #{pblicteDtFr}
		     	   AND T.PBLICTE_DT <![CDATA[<=]]> #{pblicteDtTo}
		     	   AND NVL(FN_CM06M01_ID_TO_NM(T.REQ_ID), '.') LIKE '%'||#{reqIdNm}||'%'
		     	   AND NVL(B.CLNT_NM, '.') LIKE '%'||#{clntNm}||'%'
		     	   AND NVL(T.CLNT_PJT, '.') LIKE '%'||#{clntPjt}||'%'
		     	   AND NVL2(#{trnsDiv},T.TRNS_DIV,'.') = NVL(#{trnsDiv},'.')
		     	   AND NVL(T.PART_NO, '.') LIKE '%'||#{partNo}||'%'
		       ) T
		       LEFT OUTER JOIN APP_STATUS_LIST AP ON T.CO_CD = AP.CO_CD AND T.TODO_DIV1_CODE_ID = AP.TODO_DIV1_CODE_ID AND T.TODO_DIV2_CODE_ID = AP.TODO_DIV2_CODE_ID
		       START WITH UPPER_CD = 'top' CONNECT BY PRIOR LOWER_CD = UPPER_CD
		       ORDER BY PATH
	</sql>

	<select id="selectLgistReqPageCount" parameterType="Map" resultType="int">
        SELECT
        COUNT(*)
        FROM (
        	<include refid="selectLgistReqSql"></include>
        )
	</select>

	<select id="selectLgistReqPageList" parameterType="Map" resultType="CamelMap">
        SELECT
        *
        FROM(
        SELECT
        ROWNUM AS RNUM, A.*
        FROM
        (
        <include refid="selectLgistReqSql"></include>
        ) AS a
        ) A
        WHERE RNUM BETWEEN #{firstIndex} AND #{lastIndex}
	</select>

	<select id="selectLgistReqList" parameterType="Map" resultType="CamelMap">
        <include refid="selectLgistReqSql"></include>
	</select>

	<select id="selectSelesCdList" parameterType="Map" resultType="camelMap">
       SELECT '' AS DTA_CHK,
       		  X.CO_CD,
              X.ORDRS_NO,
              X.SALES_CD,
              #{fileTrgtKey} AS FILE_TRGT_KEY,
              T.SALES_SEQ,
              CASE WHEN T.SALES_SEQ IS NOT NULL THEN 'Y'
              ELSE 'N' END AS CHK_YN,
              Y.ORDRS_CLNT_CD, -- 고객사
              A.CLNT_NM  AS ORDRS_CLNT_NM,
              Y.CLNT_PJT, -- 고객사 PJT
              FN_CM05M01_CD_TO_NM(X.ORDRS_DTL_DIV20) AS ORDRS_DTL_DIV20_NM, -- 신작구분
              X.PRDT_CD, -- 제품구분
              P.PRDT_NM  PRDT_CD_NM,
              X.ITEM_DIV, -- 아이템구분
              FN_CM05M01_CD_TO_NM(X.ITEM_DIV) ITEM_DIV_NM,
              X.EQP_NM -- 설비명
         FROM TB_CR02D02 X
               INNER JOIN TB_CR02M01 Y  ON X.CO_CD = Y.CO_CD
                                       AND X.ORDRS_NO = Y.ORDRS_NO
               LEFT OUTER JOIN TB_BM01M01 P ON X.PRDT_CD = P.PRDT_CD  --제품마스터
               LEFT OUTER JOIN TB_BM02M01 A ON Y.ORDRS_CLNT_CD = A.CLNT_CD --거래처마스터
               LEFT OUTER JOIN TB_CR11D01 T ON X.SALES_CD = T.SALES_CD AND T.FILE_TRGT_KEY = #{fileTrgtKey}
		WHERE X.CO_CD = #{coCd}
		  AND X.ORDRS_NO = #{ordrsNo}
	</select>

	<select id="selectSelesCdViewList" parameterType="Map" resultType="camelMap">
       SELECT   T.CO_CD
       		  , T.ORDRS_NO
       		  , T1.SALES_CD
       		  , T.FILE_TRGT_KEY
       		  , T1.SALES_SEQ
       		  , 'Y' AS CHK_YN
       		  , Y.ORDRS_CLNT_CD
       		  , A.CLNT_NM AS ORDRS_CLNT_NM
       		  , Y.CLNT_PJT
       		  , FN_CM05M01_CD_TO_NM(X.ORDRS_DTL_DIV20) AS ORDRS_DTL_DIV20_NM
       		  , X.PRDT_CD
       		  , P.PRDT_NM AS PRDT_CD_NM
       		  , FN_CM05M01_CD_TO_NM(X.ITEM_DIV) ITEM_DIV_NM
       		  , X.EQP_NM
		FROM TB_CR11M01 T
		LEFT OUTER JOIN TB_CR11D01 T1 ON T.FILE_TRGT_KEY = T1.FILE_TRGT_KEY
		INNER JOIN TB_CR02M01 Y  ON T.CO_CD = Y.CO_CD AND T.ORDRS_NO = Y.ORDRS_NO
		LEFT OUTER JOIN TB_BM02M01 A ON Y.ORDRS_CLNT_CD = A.CLNT_CD
		LEFT OUTER JOIN TB_CR02D02 X ON X.CO_CD = T.CO_CD AND X.ORDRS_NO = T.ORDRS_NO AND X.SALES_CD = T1.SALES_CD
		LEFT OUTER JOIN TB_BM01M01 P ON X.PRDT_CD = P.PRDT_CD
		WHERE T.FILE_TRGT_KEY = #{fileTrgtKey}
		  AND T1.SALES_CD IS NOT NULL
		ORDER BY T1.SALES_SEQ
	</select>

	<select id="selectLgistMastInfo" resultType="camelMap">
		WITH APP_STATUS_LIST AS (
			SELECT A.CO_CD, B.TODO_DIV1_CODE_ID, B.TODO_DIV2_CODE_ID
			     , CASE WHEN SUM(CASE WHEN B.TODO_CF_DT IS NOT NULL THEN 1 ELSE 0 END) = SUM(CASE WHEN A.USE_YN = 'Y' THEN 1 ELSE 0 END) THEN 'APP9'
			     		WHEN SUM(CASE WHEN B.TODO_CF_DT IS NOT NULL THEN 1 ELSE 0 END) > 0 THEN 'APP1'
		            	ELSE 'APP0'
		        END AS APP_STATUS
			   FROM TB_BM13M01 A
			   JOIN TB_WB20M01 B ON A.CO_CD = B.CO_CD AND A.APP_DIV = B.TODO_DIV1_CODE_ID AND A.APP_ID = B.TODO_ID
			  WHERE A.APP_DIV = 'APPDIV03'
			  GROUP BY A.CO_CD, B.TODO_DIV1_CODE_ID, B.TODO_DIV2_CODE_ID
		)
		, APP_TODO_LIST AS (
			SELECT A.CO_CD, B.TODO_DIV1_CODE_ID, B.TODO_DIV2_CODE_ID, A.APP_SEQ,  B.TODO_ID,  FN_CM06M01_ID_TO_NM(B.TODO_ID) AS TODO_ID_NM , DECODE(B.TODO_CF_DT,NULL,'N','Y') AS TODO_CF_YN
				   FROM TB_BM13M01 A
				   JOIN TB_WB20M01 B ON A.CO_CD = B.CO_CD AND A.APP_DIV = B.TODO_DIV1_CODE_ID AND A.APP_ID = B.TODO_ID
				  WHERE A.APP_DIV = 'APPDIV03'
		)
		SELECT FILE_TRGT_KEY
		, T.CO_CD
		, FN_CM05M01_CD_TO_NM(T.CO_CD) CO_NM
		, ORDRS_NO
		, (SELECT A.CLNT_NM FROM TB_CR02M01 Y
	            LEFT OUTER JOIN TB_BM02M01 A ON Y.ORDRS_CLNT_CD = A.CLNT_CD
	            WHERE T.CO_CD = Y.CO_CD AND T.ORDRS_NO = Y.ORDRS_NO
		  ) AS ORDRS_CLNT_NM
		, T.CLNT_PJT
		, T.PBLICTE_DT
		, T.REQ_ID
		, FN_CM06M01_ID_TO_NM(T.REQ_ID) AS REQ_ID_NM
		, T.PART_NO
		, T.REQ_FX_DT
		, T.CLAS_DIV
		, T.TRNS_DIV
		, T.DMS_TRNS_AREA_DIV
		, T.DMS_SEND_CND_DIV
		, T.DMS_SEND_CND_DIV_ETC
		, T.DMS_PACK_KIND_DIV
		, T.OVS_TRNS_AREA_DIV
		, T.OVS_SEND_CND_DIV
		, T.OVS_SEND_CND_DIV_ETC
		, T.OVS_PACK_KIND_DIV
		, T.STA_PLACE
		, T.STA_ADDR
		, T.STA_CHRG_ID
		, FN_CM06M01_ID_TO_NM(T.STA_CHRG_ID) AS STA_CHRG_ID_NM
		, T.ARVL_PLACE
		, T.ARVL_ADDR
		, T.ARVL_CHRG_CONT
		, T.PRDLST_CONT
		, T.PRD_AMT
		, T.WIDTH_SIZE
		, T.VRTICL_SIZE
		, T.HEIGHT_SIZE
		, T.FRMLC_BEFORE_WT
		, T.FRMLC_AFTER_WT
		, T.SHIPMNT_DT
		, T.HOPE_ARVL_DT
		, T.LGIST_RMK
		, T.TODO_DIV1_CODE_ID
		, T.TODO_DIV2_CODE_ID
		, FN_CM05M01_CD_TO_NM(T.CLAS_DIV) AS CLAS_DIV_NM
		, FN_CM05M01_CD_TO_NM(T.TRNS_DIV) AS TRNS_DIV_NM
		, FN_CM05M01_CD_TO_NM(T.DMS_TRNS_AREA_DIV) AS DMS_TRNS_AREA_DIV_NM
		, FN_CM05M01_CD_TO_NM(T.DMS_SEND_CND_DIV) AS DMS_SEND_CND_DIV_NM
		, FN_CM05M01_CD_TO_NM(T.DMS_PACK_KIND_DIV) AS DMS_PACK_KIND_DIV_NM
		, FN_CM05M01_CD_TO_NM(T.OVS_TRNS_AREA_DIV) AS OVS_TRNS_AREA_DIV_NM
		, FN_CM05M01_CD_TO_NM(T.OVS_SEND_CND_DIV) AS OVS_SEND_CND_DIV_NM
		, FN_CM05M01_CD_TO_NM(T.OVS_PACK_KIND_DIV) AS OVS_PACK_KIND_DIV_NM
		, FN_CM05M01_CD_TO_NM(CASE WHEN T.TRNS_DIV = 'LGISTDIV0301' THEN T.DMS_TRNS_AREA_DIV ELSE T.OVS_TRNS_AREA_DIV END) AS TRNS_AREA_DIV_NM
		, CASE WHEN INSTR(T.DMS_SEND_CND_DIV,'99') = 13 THEN DMS_SEND_CND_DIV_ETC
		       WHEN INSTR(T.OVS_SEND_CND_DIV,'99') = 13 THEN OVS_SEND_CND_DIV_ETC
		       ELSE FN_CM05M01_CD_TO_NM(CASE WHEN T.TRNS_DIV = 'LGISTDIV0301' THEN T.DMS_SEND_CND_DIV ELSE T.OVS_SEND_CND_DIV END) END AS SEND_CND_DIV_NM
		, FN_CM05M01_CD_TO_NM(CASE WHEN T.TRNS_DIV = 'LGISTDIV0301' THEN T.DMS_PACK_KIND_DIV ELSE T.OVS_PACK_KIND_DIV END) AS PACK_KIND_DIV_NM
        , T.ETC_FIELD1
        , T.ETC_FIELD2
        , T.ETC_FIELD3
        , T.CREAT_ID
        , TO_CHAR(T.CREAT_DTTM, 'YYYY-MM-DD') CREAT_DTTM
        , T.UDT_ID
        , TO_CHAR(T.UDT_DTTM, 'YYYY-MM-DD') UDT_DTTM
		,CASE WHEN T.FILE_TRGT_KEY IS NOT NULL THEN NVL(AP.APP_STATUS, 'APP0') END AS APP_STATUS
		,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 1) AS APP_USER1_ID
		,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 2) AS APP_USER2_ID
		,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 3) AS APP_USER3_ID
		,(SELECT TODO_ID FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 4) AS APP_USER4_ID
		,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 1) AS APP_USER1_ID_NM
		,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 2) AS APP_USER2_ID_NM
		,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 3) AS APP_USER3_ID_NM
		,(SELECT TODO_ID_NM FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 4) AS APP_USER4_ID_NM
		,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 1) AS APP_USER1_CF_YN
		,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 2) AS APP_USER2_CF_YN
		,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 3) AS APP_USER3_CF_YN
		,(SELECT TODO_CF_YN FROM APP_TODO_LIST WHERE CO_CD = T.CO_CD AND TODO_DIV1_CODE_ID = T.TODO_DIV1_CODE_ID AND TODO_DIV2_CODE_ID = T.TODO_DIV2_CODE_ID AND APP_SEQ = 4) AS APP_USER4_CF_YN
		FROM TB_CR11M01 T
		LEFT OUTER JOIN APP_STATUS_LIST AP ON T.CO_CD = AP.CO_CD AND T.TODO_DIV1_CODE_ID = AP.TODO_DIV1_CODE_ID AND T.TODO_DIV2_CODE_ID = AP.TODO_DIV2_CODE_ID
	  WHERE FILE_TRGT_KEY = #{fileTrgtKey}
	</select>


	<select id="selectFileTrgtKeyNext" parameterType="Map" resultType="String">
		SELECT MAX(TO_NUMBER(NVL(FILE_TRGT_KEY,'0'))) + 1 FROM TB_CR11M01
	</select>

    <insert id="insertLgistMast" parameterType="Map">
        INSERT INTO TB_CR11M01
        ( FILE_TRGT_KEY
		, CO_CD
		, ORDRS_NO
		, CLNT_PJT
		, PBLICTE_DT
		, REQ_ID
		, PART_NO
		, REQ_FX_DT
		, CLAS_DIV
		, TRNS_DIV
		, DMS_TRNS_AREA_DIV
		, DMS_SEND_CND_DIV
		, DMS_SEND_CND_DIV_ETC
		, DMS_PACK_KIND_DIV
		, OVS_TRNS_AREA_DIV
		, OVS_SEND_CND_DIV
		, OVS_SEND_CND_DIV_ETC
		, OVS_PACK_KIND_DIV
		, STA_PLACE
		, STA_ADDR
		, STA_CHRG_ID
		, ARVL_PLACE
		, ARVL_ADDR
		, ARVL_CHRG_CONT
		, PRDLST_CONT
		, PRD_AMT
		, WIDTH_SIZE
		, VRTICL_SIZE
		, HEIGHT_SIZE
		, FRMLC_BEFORE_WT
		, FRMLC_AFTER_WT
		, SHIPMNT_DT
		, HOPE_ARVL_DT
		, LGIST_RMK
        , ETC_FIELD1
        , ETC_FIELD2
        , ETC_FIELD3
        , CREAT_ID
        , CREAT_PGM
        , CREAT_DTTM
        )
        VALUES
        ( #{fileTrgtKey, jdbcType=VARCHAR}
		, #{coCd, jdbcType=VARCHAR}
		, #{ordrsNo, jdbcType=VARCHAR}
		, #{clntPjt, jdbcType=VARCHAR}
		, #{pblicteDt, jdbcType=VARCHAR}
		, #{reqId, jdbcType=VARCHAR}
		, #{partNo, jdbcType=VARCHAR}
		, #{reqFxDt, jdbcType=VARCHAR}
		, #{clasDiv, jdbcType=VARCHAR}
		, #{trnsDiv, jdbcType=VARCHAR}
		, #{dmsTrnsAreaDiv, jdbcType=VARCHAR}
		, #{dmsSendCndDiv, jdbcType=VARCHAR}
		, #{dmsSendCndDivEtc, jdbcType=VARCHAR}
		, #{dmsPackKindDiv, jdbcType=VARCHAR}
		, #{ovsTrnsAreaDiv, jdbcType=VARCHAR}
		, #{ovsSendCndDiv, jdbcType=VARCHAR}
		, #{ovsSendCndDivEtc, jdbcType=VARCHAR}
		, #{ovsPackKindDiv, jdbcType=VARCHAR}
		, #{staPlace, jdbcType=VARCHAR}
		, #{staAddr, jdbcType=VARCHAR}
		, #{staChrgId, jdbcType=VARCHAR}
		, #{arvlPlace, jdbcType=VARCHAR}
		, #{arvlAddr, jdbcType=VARCHAR}
		, #{arvlChrgCont, jdbcType=VARCHAR}
		, #{prdlstCont, jdbcType=VARCHAR}
		, #{prdAmt, jdbcType=VARCHAR}
		, #{widthSize, jdbcType=VARCHAR}
		, #{vrticlSize, jdbcType=VARCHAR}
		, #{heightSize, jdbcType=VARCHAR}
		, #{frmlcBeforeWt, jdbcType=VARCHAR}
		, #{frmlcAfterWt, jdbcType=VARCHAR}
		, #{shipmntDt, jdbcType=VARCHAR}
		, #{hopeArvlDt, jdbcType=VARCHAR}
		, #{lgistRmk, jdbcType=VARCHAR}
        , #{etcField1, jdbcType=VARCHAR}
        , #{etcField2, jdbcType=VARCHAR}
        , #{etcField3, jdbcType=VARCHAR}
        , #{userId, jdbcType=VARCHAR}
        , #{pgmId, jdbcType=VARCHAR}
        , SYSDATE
        )
    </insert>

    <update id="updateLgistMast" parameterType="Map">
        UPDATE TB_CR11M01
        SET   CO_CD = #{coCd, jdbcType=VARCHAR}
			, ORDRS_NO = #{ordrsNo, jdbcType=VARCHAR}
			, CLNT_PJT = #{clntPjt, jdbcType=VARCHAR}
			, PBLICTE_DT = #{pblicteDt, jdbcType=VARCHAR}
			, REQ_ID = #{reqId, jdbcType=VARCHAR}
			, PART_NO = #{partNo, jdbcType=VARCHAR}
			, REQ_FX_DT = #{reqFxDt, jdbcType=VARCHAR}
			, CLAS_DIV = #{clasDiv, jdbcType=VARCHAR}
			, TRNS_DIV = #{trnsDiv, jdbcType=VARCHAR}
			, DMS_TRNS_AREA_DIV = #{dmsTrnsAreaDiv, jdbcType=VARCHAR}
			, DMS_SEND_CND_DIV = #{dmsSendCndDiv, jdbcType=VARCHAR}
			, DMS_SEND_CND_DIV_ETC = #{dmsSendCndDivEtc, jdbcType=VARCHAR}
			, DMS_PACK_KIND_DIV = #{dmsPackKindDiv, jdbcType=VARCHAR}
			, OVS_TRNS_AREA_DIV = #{ovsTrnsAreaDiv, jdbcType=VARCHAR}
			, OVS_SEND_CND_DIV = #{ovsSendCndDiv, jdbcType=VARCHAR}
			, OVS_SEND_CND_DIV_ETC = #{ovsSendCndDivEtc, jdbcType=VARCHAR}
			, OVS_PACK_KIND_DIV = #{ovsPackKindDiv, jdbcType=VARCHAR}
			, STA_PLACE = #{staPlace, jdbcType=VARCHAR}
			, STA_ADDR = #{staAddr, jdbcType=VARCHAR}
			, STA_CHRG_ID = #{staChrgId, jdbcType=VARCHAR}
			, ARVL_PLACE = #{arvlPlace, jdbcType=VARCHAR}
			, ARVL_ADDR = #{arvlAddr, jdbcType=VARCHAR}
			, ARVL_CHRG_CONT = #{arvlChrgCont, jdbcType=VARCHAR}
			, PRDLST_CONT = #{prdlstCont, jdbcType=VARCHAR}
			, PRD_AMT = #{prdAmt, jdbcType=VARCHAR}
			, WIDTH_SIZE = #{widthSize, jdbcType=VARCHAR}
			, VRTICL_SIZE = #{vrticlSize, jdbcType=VARCHAR}
			, HEIGHT_SIZE = #{heightSize, jdbcType=VARCHAR}
			, FRMLC_BEFORE_WT = #{frmlcBeforeWt, jdbcType=VARCHAR}
			, FRMLC_AFTER_WT = #{frmlcAfterWt, jdbcType=VARCHAR}
			, SHIPMNT_DT = #{shipmntDt, jdbcType=VARCHAR}
			, HOPE_ARVL_DT = #{hopeArvlDt, jdbcType=VARCHAR}
			, LGIST_RMK = #{lgistRmk, jdbcType=VARCHAR}
            , ETC_FIELD1    = #{etcField1, jdbcType=VARCHAR}
            , ETC_FIELD2    = #{etcField2, jdbcType=VARCHAR}
            , ETC_FIELD3    = #{etcField3, jdbcType=VARCHAR}
            , UDT_ID        = #{userId, jdbcType=VARCHAR}
            , UDT_PGM       = #{pgmId, jdbcType=VARCHAR}
            , UDT_DTTM      = SYSDATE
        WHERE FILE_TRGT_KEY = #{fileTrgtKey, jdbcType=VARCHAR}
    </update>

	<delete id="deleteLgistMast" parameterType="Map">
	  DELETE TB_CR11M01
	   WHERE FILE_TRGT_KEY = #{fileTrgtKey}
	</delete>

    <insert id="insertLgistSalesCd" parameterType="Map">
        <selectKey keyProperty="salesSeq" resultType="int" order="BEFORE">
			SELECT NVL(MAX(SALES_SEQ), 0) + 1 FROM TB_CR11D01
			 WHERE FILE_TRGT_KEY = #{fileTrgtKey}
        </selectKey>
        INSERT INTO TB_CR11D01
        ( FILE_TRGT_KEY
		, SALES_SEQ
		, SALES_CD
        , ETC_FIELD1
        , ETC_FIELD2
        , ETC_FIELD3
        , CREAT_ID
        , CREAT_PGM
        , CREAT_DTTM
        )
        VALUES
        ( #{fileTrgtKey, jdbcType=VARCHAR}
		, #{salesSeq}
		, #{salesCd, jdbcType=VARCHAR}
        , #{etcField1, jdbcType=VARCHAR}
        , #{etcField2, jdbcType=VARCHAR}
        , #{etcField3, jdbcType=VARCHAR}
        , #{userId}
        , #{pgmId}
        , SYSDATE
        )
    </insert>

    <update id="updateLgistSalesCd" parameterType="Map">
        UPDATE TB_CR11D01
        SET   SALES_CD 			= #{salesCd, jdbcType=VARCHAR}
            , ETC_FIELD1        = #{etcField1, jdbcType=VARCHAR}
            , ETC_FIELD2        = #{etcField2, jdbcType=VARCHAR}
            , ETC_FIELD3        = #{etcField3, jdbcType=VARCHAR}
            , UDT_ID        = #{userId}
            , UDT_PGM       = #{pgmId}
            , UDT_DTTM      = SYSDATE
	  WHERE FILE_TRGT_KEY = #{fileTrgtKey}
	    AND SALES_SEQ = #{salesSeq, jdbcType=VARCHAR}
    </update>

	<delete id="deleteLgistSalesCd" parameterType="Map">
	  DELETE TB_CR11D01
	  WHERE FILE_TRGT_KEY = #{fileTrgtKey}
	    AND SALES_SEQ = #{salesSeq, jdbcType=VARCHAR}
	</delete>

	<delete id="deleteLgistSalesCdAll" parameterType="Map">
	  DELETE TB_CR11D01
	  WHERE FILE_TRGT_KEY = #{fileTrgtKey}
	</delete>

	<!-- 결재요청 목록 조회 -->
	<select id="selectTodoAppReqList" resultType="CamelMap">
		SELECT CO_CD
			, A.APP_DIV AS TODO_DIV1_CODE_ID
			, A.APP_DIV||TRIM(TO_CHAR(#{fileTrgtKey},'00000')) AS TODO_DIV2_CODE_ID
			, APP_ID AS TODO_ID
			, '' AS PG_PATH
			, '' AS PG_PARAM
			, '' AS SALES_CD
			, '' AS WBS_PLANCO_CD
			, '' AS WBS_PLAN_NO
			, '' AS WBS_PLAN_CODE_KIND
			, '' AS WBS_PLAN_CODE_ID
			, '' AS WBS_RSLTS_FILE_TRGT_KEY
			, '' AS WBS_RSLTS_CO_CD
			, '' AS WBS_RSLTS_PLAN_NO
			, '' AS WBS_RSLTS_PLAN_CODE_KIND
			, '' AS WBS_RSLTS_PLAN_CODE_ID
			FROM TB_BM13M01 A
		WHERE CO_CD = #{coCd}
		AND APP_DIV = #{appDiv}
		ORDER BY APP_SEQ
	</select>

	<!-- ToDoList 등록  -->
    <insert id="insertTodoAppList" parameterType="Map">
        <selectKey keyProperty="todoKey" resultType="int" order="BEFORE">
			SELECT NVL(MAX(TODO_KEY), 0) + 1 FROM TB_WB20M01
        </selectKey>
        INSERT INTO TB_WB20M01
        ( TODO_KEY
		, CO_CD
		, TODO_DIV1_CODE_ID
		, TODO_DIV2_CODE_ID
		, TODO_ID
		, PG_PATH
		, PG_PARAM
		, SALES_CD
		, WBS_PLANCO_CD
		, WBS_PLAN_NO
		, WBS_PLAN_CODE_KIND
		, WBS_PLAN_CODE_ID
		, WBS_RSLTS_FILE_TRGT_KEY
		, WBS_RSLTS_CO_CD
		, WBS_RSLTS_PLAN_NO
		, WBS_RSLTS_PLAN_CODE_KIND
		, WBS_RSLTS_PLAN_CODE_ID
		, ETC_FIELD1
		, ETC_FIELD2
		, ETC_FIELD3
		, CREAT_ID
		, CREAT_PGM
		, CREAT_DTTM
        )
        VALUES
        ( #{todoKey}
        , #{coCd}
        , #{todoDiv1CodeId}
        , #{todoDiv2CodeId}
        , #{todoId}
        , #{pgPath, jdbcType=VARCHAR}
        , #{pgParam, jdbcType=VARCHAR}
        , #{salesCd, jdbcType=VARCHAR}
        , #{wbsPlancoCd, jdbcType=VARCHAR}
        , #{wbsPlanNo, jdbcType=VARCHAR}
        , #{wbsPlanCodeKind, jdbcType=VARCHAR}
        , #{wbsPlanCodeId, jdbcType=VARCHAR}
        , #{wbsRsltsFileTrgtKey, jdbcType=VARCHAR}
        , #{wbsRsltsCoCd, jdbcType=VARCHAR}
        , #{wbsRsltsPlanNo, jdbcType=VARCHAR}
        , #{wbsRsltsPlanCodeKind, jdbcType=VARCHAR}
        , #{wbsRsltsPlanCodeId, jdbcType=VARCHAR}
        , #{etcField1, jdbcType=VARCHAR}
        , #{etcField2, jdbcType=VARCHAR}
        , #{etcField3, jdbcType=VARCHAR}
        , #{userId}
        , #{pgmId}
        , SYSDATE
        )
    </insert>

    <update id="updateLgistMastTodoApp" parameterType="Map">
        UPDATE TB_CR11M01
        SET   TODO_DIV1_CODE_ID = #{todoDiv1CodeId, jdbcType=VARCHAR}
            , TODO_DIV2_CODE_ID = #{todoDiv2CodeId, jdbcType=VARCHAR}
            , UDT_ID        = #{userId, jdbcType=VARCHAR}
            , UDT_PGM       = #{pgmId, jdbcType=VARCHAR}
            , UDT_DTTM      = SYSDATE
        WHERE FILE_TRGT_KEY = #{fileTrgtKey, jdbcType=VARCHAR}
    </update>

    <update id="updateTodoAppConfirm" parameterType="Map">
        UPDATE TB_WB20M01
        SET   TODO_CF_DT	= SYSDATE
            , UDT_ID        = #{userId, jdbcType=VARCHAR}
            , UDT_PGM       = #{pgmId, jdbcType=VARCHAR}
            , UDT_DTTM      = SYSDATE
        WHERE CO_CD = #{coCd}
          AND TODO_DIV1_CODE_ID = #{todoDiv1CodeId}
          AND TODO_DIV2_CODE_ID = #{todoDiv2CodeId}
          AND TODO_ID = #{todoId}
    </update>






	<!-- BOM 자재정보 조회 -->
	<select id="selectLgistSalesCdList" resultType="CamelMap">
		SELECT CO_CD
			, SALES_CD
			, UPPER_CD
			, LOWER_CD
			, UPPER_CD AS OLD_UPPER_CD
			, LOWER_CD AS OLD_LOWER_CD
			, LOWER_CD AS DSGN_NO
			, MATR_SEQ
			, ORDRG_DIV_10
			, ORDRG_DIV_20
			, NEXT_PRCSN_NM
			, DLVPLC_NM
			, BOM_QTY
			, MATR_CD
			, MATR_NM
			, GOODS_DIV
			, MATR_CLNT_DIV
			, MATR_DIV
			, MATR_GRP
			, MATR_MAT
			, MATR_SIZE
			, MATR_SPEC
			, MATR_MAKR_NM
			, MATR_MNO
			, MATR_WT
			, MATR_UNIT
			, ORIGIN_NM
			, MATR_DRW_NO
			, MATR_TEST_DIV
			, DLVR_RQM_DAY
			, MATR_PURC_DIV
			, MIN_ORDRG_QTY
			, MATR_SAFT_QTY
			, MATR_STOCK_CD
			, DSGN_2D_MD
			, AVRG_2D_MD
			, DSGN_3D_MD
			, AVRG_3D_MD
			, PRDCTN_RQM_MD
			, PRDCTN_AVRG_MD
			, USE_YN
			, MATR_PART_NO
			, PCHS_CLNT_CD1
			, PCHS_CLNT_PCT1
			, PCHS_CLNT_CD2
			, PCHS_CLNT_PCT2
			, PCHS_CLNT_CD3
			, PCHS_CLNT_PCT3
			, MATR_UPR
			, MATR_AVRG_UPR
			, MATR_RMK
			, TO_CHAR(T.MATR_LAST_TRST_DT, 'YYYY-MM-DD') AS MATR_LAST_TRST_DT
			, MATR_ATNT_CD
		FROM TB_CR11D01 T
		WHERE CO_CD = #{coCd}
		  AND SALES_CD = #{salesCd}
		ORDER BY T.CO_CD, T.LOWER_CD, T.UPPER_CD, T.MATR_SEQ
	</select>







</mapper>
