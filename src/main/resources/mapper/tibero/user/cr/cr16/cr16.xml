<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dksys.biz.user.cr.cr16.mapper.CR16Mapper"> 
     <select id="selectSalesYearPlanListCount" parameterType="Map" resultType="int"> 
          SELECT COUNT(*)
             FROM  (
                 SELECT CO_CD,
                        (SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = S.CO_CD) AS CO_CD_NM,
                        SALES_PLAN_CLNT_CD,
                        (SELECT T.CLNT_NM FROM TB_BM02M01 T WHERE T.CLNT_CD = S.SALES_PLAN_CLNT_CD) AS SALES_PLAN_CLNT_NM,
                        SALES_PLAN_DIV,
                        (SELECT Y.CODE_NM FROM TB_CM05M01 Y WHERE Y.CODE_ID = S.SALES_PLAN_DIV) AS SALES_PLAN_DIV_NM,
                        SALES_PLAN_ID,
                        (SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = S.SALES_PLAN_ID) AS SALES_PLAN_NM,
                        SALES_PLAN_YY,
                        SALES_PLAN_AMT01,
                        SALES_PLAN_AMT02,
                        SALES_PLAN_AMT03,
                        SALES_PLAN_AMT04,
                        SALES_PLAN_AMT05,
                        SALES_PLAN_AMT06,
                        SALES_PLAN_AMT07,
                        SALES_PLAN_AMT08,
                        SALES_PLAN_AMT09,
                        SALES_PLAN_AMT10,
                        SALES_PLAN_AMT11,
                        SALES_PLAN_AMT12,
                        SALES_PLAN_TOT_AMT,
                        CREAT_ID,
                        (SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = S.CREAT_ID) AS CREAT_NM,
                        CREAT_DTTM,
                        UDT_ID,
                        (SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = S.UDT_ID) AS UDT_NM,
                        UDT_DTTM
                        FROM (
                                SELECT 
                                     S.CO_CD,
                                     S.SALES_PLAN_CLNT_CD,
                                     S.SALES_PLAN_DIV,
                                     S.SALES_PLAN_ID,
                                     S.SALES_PLAN_YY,
                                     NVL(MAX(S.SALES_PLAN_AMT01),0) AS SALES_PLAN_AMT01,
                                     NVL(MAX(S.SALES_PLAN_AMT02),0) AS SALES_PLAN_AMT02,
                                     NVL(MAX(S.SALES_PLAN_AMT03),0) AS SALES_PLAN_AMT03,
                                     NVL(MAX(S.SALES_PLAN_AMT04),0) AS SALES_PLAN_AMT04,
                                     NVL(MAX(S.SALES_PLAN_AMT05),0) AS SALES_PLAN_AMT05,
                                     NVL(MAX(S.SALES_PLAN_AMT06),0) AS SALES_PLAN_AMT06,
                                     NVL(MAX(S.SALES_PLAN_AMT07),0) AS SALES_PLAN_AMT07,
                                     NVL(MAX(S.SALES_PLAN_AMT08),0) AS SALES_PLAN_AMT08,
                                     NVL(MAX(S.SALES_PLAN_AMT09),0) AS SALES_PLAN_AMT09,
                                     NVL(MAX(S.SALES_PLAN_AMT10),0) AS SALES_PLAN_AMT10,
                                     NVL(MAX(S.SALES_PLAN_AMT11),0) AS SALES_PLAN_AMT11,
                                     NVL(MAX(S.SALES_PLAN_AMT12),0) AS SALES_PLAN_AMT12,
                                     NVL(MAX(TOT_S.SALES_PLAN_TOT_AMT),0) AS SALES_PLAN_TOT_AMT,
                                     NVL(MAX(S.CREAT_ID),'') AS CREAT_ID,
                                     MAX(TO_CHAR(S.CREAT_DTTM, 'YYYY-MM-DD HH24:MI:SS')) AS CREAT_DTTM,
                                     NVL(MAX(S.UDT_ID),'') AS UDT_ID,
                                     MAX(TO_CHAR(S.UDT_DTTM, 'YYYY-MM-DD HH24:MI:SS')) AS UDT_DTTM
                                     FROM (
                                             SELECT 
                                             CO_CD,
                                             SALES_PLAN_CLNT_CD,
                                             SALES_PLAN_DIV,
                                             SALES_PLAN_ID,
                                             SUBSTR(SALES_PLAN_YM,0,4) AS SALES_PLAN_YY,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '01' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT01,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '02' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT02,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '03' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT03,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '04' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT04,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '05' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT05,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '06' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT06,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '07' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT07,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '08' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT08,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '09' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT09,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '10' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT10,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '11' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT11,
                                             CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '12' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT12,                                 
                                             CREAT_ID,
                                             CREAT_DTTM,
                                             UDT_ID,
                                             UDT_DTTM
                                             FROM TB_CR10M01 ) S
                                             LEFT OUTER JOIN 
                                             ( SELECT CO_CD,
                                             SALES_PLAN_CLNT_CD,
                                             SALES_PLAN_DIV,
                                             SALES_PLAN_ID,
                                             SUBSTR(SALES_PLAN_YM,0,4) AS SALES_PLAN_YY,
                                             SUM(SALES_PLAN_AMT) AS SALES_PLAN_TOT_AMT 
                                             FROM TB_CR10M01
                                             GROUP BY CO_CD,
                                             SALES_PLAN_CLNT_CD,
                                             SALES_PLAN_DIV,
                                             SALES_PLAN_ID,
                                             SUBSTR(SALES_PLAN_YM,0,4)) TOT_S
                                             ON S.CO_CD = TOT_S.CO_CD
                                             AND S.SALES_PLAN_CLNT_CD  = TOT_S.SALES_PLAN_CLNT_CD
                                             AND S.SALES_PLAN_DIV  = TOT_S.SALES_PLAN_DIV
                                             AND S.SALES_PLAN_ID  = TOT_S.SALES_PLAN_ID
                                             AND S.SALES_PLAN_YY = TOT_S.SALES_PLAN_YY
                                             GROUP BY S.CO_CD, S.SALES_PLAN_CLNT_CD, S.SALES_PLAN_DIV, 
                                             S.SALES_PLAN_YY, S.SALES_PLAN_ID 
                                             <!--  WHERE CO_CD LIKE '%${coCd}%'
                                               AND SALES_PLAN_YM LIKE '%${salesPlanYy}' -->         
                                             ) S ) S     
                     
         </select>
                 
         <select id="selectSalesYearPlanList" parameterType="Map" resultType="camelMap"> 
          SELECT ROWNUM AS RN, S.* 
             FROM  (
	             SELECT CO_CD,
	                    (SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = S.CO_CD) AS CO_CD_NM,
	                    SALES_PLAN_CLNT_CD,
	                    (SELECT T.CLNT_NM FROM TB_BM02M01 T WHERE T.CLNT_CD = S.SALES_PLAN_CLNT_CD) AS SALES_PLAN_CLNT_NM,
	                    SALES_PLAN_DIV,
	                    (SELECT Y.CODE_NM FROM TB_CM05M01 Y WHERE Y.CODE_ID = S.SALES_PLAN_DIV) AS SALES_PLAN_DIV_NM,
	                    SALES_PLAN_ID,
	                    (SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = S.SALES_PLAN_ID) AS SALES_PLAN_NM,
	                    SALES_PLAN_YY,
	                    SALES_PLAN_AMT01,
	                    SALES_PLAN_AMT02,
	                    SALES_PLAN_AMT03,
	                    SALES_PLAN_AMT04,
	                    SALES_PLAN_AMT05,
	                    SALES_PLAN_AMT06,
	                    SALES_PLAN_AMT07,
	                    SALES_PLAN_AMT08,
	                    SALES_PLAN_AMT09,
	                    SALES_PLAN_AMT10,
	                    SALES_PLAN_AMT11,
	                    SALES_PLAN_AMT12,
	                    SALES_PLAN_TOT_AMT,
	                    CREAT_ID,
	                    (SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = S.CREAT_ID) AS CREAT_NM,
	                    CREAT_DTTM,
	                    UDT_ID,
	                    (SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = S.UDT_ID) AS UDT_NM,
	                    UDT_DTTM
	                    FROM (
			                    SELECT 
			                         S.CO_CD,
			                         S.SALES_PLAN_CLNT_CD,
			                         S.SALES_PLAN_DIV,
			                         S.SALES_PLAN_ID,
			                         S.SALES_PLAN_YY,
			                         NVL(MAX(S.SALES_PLAN_AMT01),0) AS SALES_PLAN_AMT01,
			                         NVL(MAX(S.SALES_PLAN_AMT02),0) AS SALES_PLAN_AMT02,
			                         NVL(MAX(S.SALES_PLAN_AMT03),0) AS SALES_PLAN_AMT03,
			                         NVL(MAX(S.SALES_PLAN_AMT04),0) AS SALES_PLAN_AMT04,
			                         NVL(MAX(S.SALES_PLAN_AMT05),0) AS SALES_PLAN_AMT05,
			                         NVL(MAX(S.SALES_PLAN_AMT06),0) AS SALES_PLAN_AMT06,
			                         NVL(MAX(S.SALES_PLAN_AMT07),0) AS SALES_PLAN_AMT07,
			                         NVL(MAX(S.SALES_PLAN_AMT08),0) AS SALES_PLAN_AMT08,
			                         NVL(MAX(S.SALES_PLAN_AMT09),0) AS SALES_PLAN_AMT09,
			                         NVL(MAX(S.SALES_PLAN_AMT10),0) AS SALES_PLAN_AMT10,
			                         NVL(MAX(S.SALES_PLAN_AMT11),0) AS SALES_PLAN_AMT11,
			                         NVL(MAX(S.SALES_PLAN_AMT12),0) AS SALES_PLAN_AMT12,
			                         NVL(MAX(TOT_S.SALES_PLAN_TOT_AMT),0) AS SALES_PLAN_TOT_AMT,
			                         NVL(MAX(S.CREAT_ID),'') AS CREAT_ID,
			                         MAX(TO_CHAR(S.CREAT_DTTM, 'YYYY-MM-DD HH24:MI:SS')) AS CREAT_DTTM,
			                         NVL(MAX(S.UDT_ID),'') AS UDT_ID,
			                         MAX(TO_CHAR(S.UDT_DTTM, 'YYYY-MM-DD HH24:MI:SS')) AS UDT_DTTM
			                         FROM (
			                                 SELECT 
			                                 CO_CD,
			                                 SALES_PLAN_CLNT_CD,
			                                 SALES_PLAN_DIV,
			                                 SALES_PLAN_ID,
			                                 SUBSTR(SALES_PLAN_YM,0,4) AS SALES_PLAN_YY,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '01' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT01,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '02' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT02,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '03' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT03,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '04' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT04,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '05' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT05,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '06' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT06,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '07' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT07,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '08' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT08,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '09' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT09,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '10' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT10,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '11' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT11,
			                                 CASE WHEN SUBSTR(SALES_PLAN_YM,5,2) = '12' THEN SALES_PLAN_AMT END AS SALES_PLAN_AMT12,                                 
			                                 CREAT_ID,
			                                 CREAT_DTTM,
			                                 UDT_ID,
			                                 UDT_DTTM
			                                 FROM TB_CR10M01 ) S
			                                 LEFT OUTER JOIN 
			                                 ( SELECT CO_CD,
			                                 SALES_PLAN_CLNT_CD,
			                                 SALES_PLAN_DIV,
			                                 SALES_PLAN_ID,
			                                 SUBSTR(SALES_PLAN_YM,0,4) AS SALES_PLAN_YY,
			                                 SUM(SALES_PLAN_AMT) AS SALES_PLAN_TOT_AMT 
			                                 FROM TB_CR10M01
			                                 GROUP BY CO_CD,
			                                 SALES_PLAN_CLNT_CD,
			                                 SALES_PLAN_DIV,
			                                 SALES_PLAN_ID,
			                                 SUBSTR(SALES_PLAN_YM,0,4)) TOT_S
			                                 ON S.CO_CD = TOT_S.CO_CD
			                                 AND S.SALES_PLAN_CLNT_CD  = TOT_S.SALES_PLAN_CLNT_CD
			                                 AND S.SALES_PLAN_DIV  = TOT_S.SALES_PLAN_DIV
			                                 AND S.SALES_PLAN_ID  = TOT_S.SALES_PLAN_ID
			                                 AND S.SALES_PLAN_YY = TOT_S.SALES_PLAN_YY
			                                 GROUP BY S.CO_CD, S.SALES_PLAN_CLNT_CD, S.SALES_PLAN_DIV, 
			                                 S.SALES_PLAN_YY, S.SALES_PLAN_ID 
			                                 <!--  WHERE CO_CD LIKE '%${coCd}%'
	                                           AND SALES_PLAN_YM LIKE '%${salesPlanYy}' -->         
			                                 ) S ) S
                        WHERE ROWNUM BETWEEN ${firstIndex} AND ${lastIndex}        
                     
         </select>
         
         <delete id="deleteSalesYearPlanM" parameterType="Map">
               DELETE FROM TB_CR10M01
                   WHERE CO_CD = #{coCd}
                   AND SUBSTR(SALES_PLAN_YM,0,4) = #{salesPlanYy}
                   AND SALES_PLAN_CLNT_CD = #{salesPlanClntCd} 
                   AND SALES_PLAN_DIV = #{salesPlanDiv}
        </delete>
        
        <delete id="deleteSalesYearPlanD" parameterType="Map">
               DELETE FROM TB_CR10D01
                   WHERE CO_CD = #{coCd}
                   AND SUBSTR(SALES_PLAN_YM,0,4) = #{salesPlanYy}
                   AND SALES_PLAN_CLNT_CD = #{salesPlanClntCd} 
                   AND SALES_PLAN_DIV = #{salesPlanDiv}
        </delete>
        
        <select id="selectSalesYearPlanMC" parameterType="Map" resultType="camelMap"> 
			SELECT S.FILE_TRGT_KEY, S.CLNT_CD, S.SALES_PLAN_YM, 
			          S.SALES_PLAN_AMT, NVL(P1.EPCT_TOT_AMT,0) AS EPCT_TOT_AMT, 
			          NVL(P2.ORDRS_TOT_AMT,0) AS ORDRS_TOT_AMT, 
			          NVL(P3.ORDRS_PLAN_TOT_AMT,0) AS ORDRS_PLAN_TOT_AMT, 
			          S.SALES_PLAN_RMK
			FROM (
			               SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'01' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'02' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'03' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'04' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'05' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'06' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'07' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'08' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'09' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'10' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'11' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL
			               UNION ALL SELECT '' AS FILE_TRGT_KEY, #{salesPlanClntCd} AS CLNT_CD, #{salesPlanYy, jdbcType=VARCHAR}||'12' AS SALES_PLAN_YM, 0 AS SALES_PLAN_AMT, '' AS SALES_PLAN_RMK FROM DUAL ) S
			               LEFT OUTER JOIN (
			                 SELECT CLNT_CD, TO_CHAR(DUDT_PLAN_DT, 'YYYYMM') AS DUDT_PLAN_YM, SUM(EPCT_AMT) AS EPCT_TOT_AMT 
			                           FROM  TB_BM06M01 
			                           WHERE TO_CHAR(DUDT_PLAN_DT, 'YYYYMM') IS NOT NULL
			                           GROUP BY CLNT_CD,  TO_CHAR(DUDT_PLAN_DT, 'YYYYMM')) P1
			               ON  S.CLNT_CD = P1.CLNT_CD
			               AND S.SALES_PLAN_YM = P1.DUDT_PLAN_YM  
			               
			               LEFT OUTER JOIN (
			                 SELECT CLNT_CD, TO_CHAR(ORDRS_DT, 'YYYYMM') AS ORDRS_YM, SUM(ORDRS_AMT) AS ORDRS_TOT_AMT 
			                           FROM  TB_BM06M01 
			                           WHERE TO_CHAR(ORDRS_DT, 'YYYYMM') IS NOT NULL
			                           GROUP BY CLNT_CD,  TO_CHAR(ORDRS_DT, 'YYYYMM')) P2
			               ON  S.CLNT_CD = P2.CLNT_CD
			               AND S.SALES_PLAN_YM = P2.ORDRS_YM 
			               
			               LEFT OUTER JOIN (
			                 SELECT CLNT_CD, TO_CHAR(ORDRS_PLAN_DT, 'YYYYMM') AS ORDRS_PLAN_YM, SUM(ORDRS_PLAN_AMT) AS ORDRS_PLAN_TOT_AMT 
			                           FROM  TB_BM06M01 
			                           WHERE TO_CHAR(ORDRS_PLAN_DT, 'YYYYMM') IS NOT NULL
			                           GROUP BY CLNT_CD,  TO_CHAR(ORDRS_PLAN_DT, 'YYYYMM')) P3
			               ON  S.CLNT_CD = P3.CLNT_CD
			               AND S.SALES_PLAN_YM = P3.ORDRS_PLAN_YM 
			               ORDER BY  S.SALES_PLAN_YM ASC
        </select>
        
        <select id="selectSalesYearPlanMU" parameterType="Map" resultType="camelMap"> 
               SELECT FILE_TRGT_KEY, SALES_PLAN_YM, SALES_PLAN_AMT, SALES_PLAN_RMK
                   FROM TB_CR10M01
                   WHERE CO_CD = #{coCd}
                   AND SUBSTR(SALES_PLAN_YM,0,4) = #{salesPlanYy}
                   AND SALES_PLAN_CLNT_CD = #{salesPlanClntCd} 
                   AND SALES_PLAN_DIV = #{salesPlanDiv}
                   ORDER BY SALES_PLAN_YM ASC
        </select>          
        <select id="selectSalesYearPlanD" parameterType="Map" resultType="camelMap"> 
               SELECT SALES_PLAN_YM, CLNT_PJT, CTRT_NM, EQ_NM, SALES_PLAN_DTL_RMK
                   FROM TB_CR10D01
                   WHERE CO_CD = #{coCd}
                   AND SALES_PLAN_YM = #{salesPlanYm}
                   AND SALES_PLAN_CLNT_CD = #{salesPlanClntCd} 
                   AND SALES_PLAN_DIV = #{salesPlanDiv}
                   ORDER BY SALES_PLAN_SEQ ASC
        </select>
        
        
                        
</mapper>


