<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dksys.biz.user.wb.wb02.mapper.WB02Mapper">

          <!-- WBS 일정계획 등록 메인 화면 조회 리스트  -->
          <select id="selectToDoList" parameterType="Map" resultType="camelMap">   
               SELECT 
			        TODO_KEY,
					CO_CD,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.CO_CD) AS CO_CD_NM,
					TODO_DIV1_CODE_ID,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.TODO_DIV1_CODE_ID) AS TODO_DIV1_CODE_NM,
					TODO_DIV2_CODE_ID,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.TODO_DIV2_CODE_ID) AS TODO_DIV2_CODE_NM,
					TODO_ID,
					(SELECT Y.WBS_PLAN_CNTS FROM TB_WB01M01 Y WHERE Y.CO_CD = X.CO_CD 
					          AND Y.WBS_PLAN_CODE_KIND = X.TODO_DIV1_CODE_ID
					          AND Y.WBS_PLAN_CODE_ID = X.TODO_DIV2_CODE_ID
					          AND Y.WBS_PLAN_NO = X.WBS_PLAN_NO
					          AND Y.SALES_CD = Y.SALES_CD) AS WBS_PLAN_CNTS, -- TO-DO LIST 주요내용
					(SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = X.TODO_ID) AS TODO_NM,
					NULL AS TODO_CHK,
<!--  					CASE WHEN TODO_CF_DT IS NULL THEN 'N' ELSE 'Y' END AS TODO_CHK, -->
					TO_CHAR(X.TODO_CF_DT, 'YYYY-MM-DD') AS TODO_CF_DT,
					TODO_CF_OPN,
					SALES_CD,
					PG_PATH,
					WBS_PLANCO_CD,
					WBS_PLAN_NO,
					WBS_PLAN_CODE_KIND,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.WBS_PLAN_CODE_KIND) AS WBS_PLAN_CODE_KIND_NM,
					WBS_PLAN_CODE_ID,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.WBS_PLAN_CODE_ID) AS WBS_PLAN_CODE_NM,
					WBS_RSLTS_CO_CD,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.CO_CD) AS WBS_RSLTS_CO_CD_NM,
					WBS_RSLTS_PLAN_NO,
					WBS_RSLTS_PLAN_CODE_KIND,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.WBS_RSLTS_PLAN_CODE_KIND) AS WBS_RSLTS_PLAN_CODE_KIND_NM,
					WBS_RSLTS_PLAN_CODE_ID,
					(SELECT T.CODE_NM FROM TB_CM05M01 T WHERE T.CODE_ID = X.WBS_RSLTS_PLAN_CODE_ID) AS WBS_RSLTS_PLAN_CODE_ID_NM,
					CREAT_ID,
					(SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = X.CREAT_ID) AS CREAT_NM,
					CREAT_PGM,
					TO_CHAR(CREAT_DTTM, 'YYYY-MM-DD HH24:MI:SS') AS CREAT_DTTM,
					UDT_ID,
					(SELECT T.NAME FROM TB_CM06M01 T WHERE T.ID = X.UDT_ID) AS UDT_NM,
					UDT_PGM,
					TO_CHAR(UDT_DTTM, 'YYYY-MM-DD HH24:MI:SS') AS UDT_DTTM
                    FROM TB_WB20M01 X
                    ORDER BY TODO_KEY ASC
          </select>


 </mapper>