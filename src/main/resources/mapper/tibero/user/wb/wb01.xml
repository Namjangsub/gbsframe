<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dksys.biz.user.wb.wb01.mapper.WB01Mapper">


          <select id="selectWbsCount" parameterType="Map" resultType="int">
                    SELECT 
                      COUNT(*) 
                    FROM TB_WB01M01 WB01
          </select>
          
          <select id="selectWbsList" parameterType="Map" resultType="camelMap">
          
          SELECT * FROM (
		SELECT 
		    ROWNUM AS RN,
		    CO_CD,
		    SALES_CD,
		    CASE WHEN LEVEL = '1' THEN WBS_PLAN_CNTS ELSE '' END LVL1,
		    CASE WHEN LEVEL = '2' THEN WBS_PLAN_CNTS ELSE '' END LVL2,
		    CASE WHEN LEVEL = '3' THEN WBS_PLAN_CNTS ELSE '' END LVL3,
		    WBS_PLAN_CNTS,
		    WBS_PLAN_EMP_NO, 
		    WBS_PLAN_MNG_EMP_NO,
		    WBS_PLANS_DT, 
                        WBS_PLANE_DT,
		    WBS_PLAN_RMK 
		FROM TB_WB01M01
		START WITH WBS_PLAN_CNTS IN ('영업','생산')
		CONNECT BY PRIOR WBS_PLAN_CODE_ID  =  WBS_PLAN_CODE_KIND
		ORDER SIBLINGS BY WBS_PLAN_CODE_ID ASC )
		WHERE RN BETWEEN ${firstIndex} AND ${lastIndex}
          </select>
          
          <select id="selectWbsList01" parameterType="Map" resultType="camelMap">
          
         SELECT 
            CO_CD,
            SALES_CD,
            CASE WHEN LEVEL = '1' THEN WBS_PLAN_CNTS ELSE '' END LVL1,
            CASE WHEN LEVEL = '2' THEN WBS_PLAN_CNTS ELSE '' END LVL2,
            CASE WHEN LEVEL = '3' THEN WBS_PLAN_CNTS ELSE '' END LVL3,
            WBS_PLAN_CNTS,
            WBS_PLAN_EMP_NO, 
            WBS_PLAN_MNG_EMP_NO,
            WBS_PLANS_DT, 
            WBS_PLANE_DT,
            WBS_PLAN_RMK 
        FROM TB_WB01M01
        START WITH WBS_PLAN_CNTS IN ('영업','생산')
        CONNECT BY PRIOR WBS_PLAN_CODE_ID  =  WBS_PLAN_CODE_KIND
        ORDER SIBLINGS BY WBS_PLAN_CODE_ID ASC 
          </select>
          
          
 </mapper>